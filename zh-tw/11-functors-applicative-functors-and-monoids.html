
<!DOCTYPE HTML>
<html lang="zh-tw" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Functors, Applicative Functors 與 Monoids · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="12-a-fistful-of-monads.html" />
    
    
    <link rel="prev" href="10-functionally-solving-problems.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="輸入並搜尋" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    HASKELL 趣學指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="1-introduction.html">
            
                <a href="1-introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="2-ready-go.html">
            
                <a href="2-ready-go.html">
            
                    
                    Ready Go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="3-type-and-typeclass.html">
            
                <a href="3-type-and-typeclass.html">
            
                    
                    Type And Typeclass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="4-syntax-in-function.html">
            
                <a href="4-syntax-in-function.html">
            
                    
                    Syntax in Function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="5-recursion.html">
            
                <a href="5-recursion.html">
            
                    
                    Recursion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="6-high-order-function.html">
            
                <a href="6-high-order-function.html">
            
                    
                    High Order Function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="7-module.html">
            
                <a href="7-module.html">
            
                    
                    Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="8-build-our-own-type-and-typeclass.html">
            
                <a href="8-build-our-own-type-and-typeclass.html">
            
                    
                    Build Our Own Type and Typeclass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="9-input-and-output.html">
            
                <a href="9-input-and-output.html">
            
                    
                    Input and Output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="10-functionally-solving-problems.html">
            
                <a href="10-functionally-solving-problems.html">
            
                    
                    Functionally Solving Problems
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="11-functors-applicative-functors-and-monoids.html">
            
                <a href="11-functors-applicative-functors-and-monoids.html">
            
                    
                    Functors, Applicative Functors 與 Monoids
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12-a-fistful-of-monads.html">
            
                <a href="12-a-fistful-of-monads.html">
            
                    
                    A Fistful of Monad
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="13-for-a-few-monads-more.html">
            
                <a href="13-for-a-few-monads-more.html">
            
                    
                    For a Few Monad More
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="14-zippers.html">
            
                <a href="14-zippers.html">
            
                    
                    Zippers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="faq.html">
            
                <a href="faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="resource.html">
            
                <a href="resource.html">
            
                    
                    Resource
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本書使用 GitBook 釋出
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Functors, Applicative Functors 與 Monoids</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="functors-applicative-functors-&#x8207;-monoids">Functors, Applicative Functors &#x8207; Monoids</h1>
<p>Haskell &#x7684;&#x4E00;&#x4E9B;&#x7279;&#x8272;&#xFF0C;&#x50CF;&#x662F;&#x7D14;&#x7CB9;&#x6027;&#xFF0C;&#x9AD8;&#x968E;&#x51FD;&#x6578;&#xFF0C;algebraic data types&#xFF0C;typeclasses&#xFF0C;&#x9019;&#x4E9B;&#x8B93;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5F9E;&#x66F4;&#x9AD8;&#x7684;&#x89D2;&#x5EA6;&#x4F86;&#x770B;&#x5230; polymorphism &#x9019;&#x4EF6;&#x4E8B;&#x3002;&#x4E0D;&#x50CF; OOP &#x7576;&#x4E2D;&#x9700;&#x8981;&#x5F9E;&#x9F90;&#x5927;&#x7684;&#x578B;&#x614B;&#x968E;&#x5C64;&#x4F86;&#x601D;&#x8003;&#x3002;&#x6211;&#x5011;&#x53EA;&#x9700;&#x8981;&#x770B;&#x770B;&#x624B;&#x908A;&#x7684;&#x578B;&#x614B;&#x7684;&#x884C;&#x70BA;&#xFF0C;&#x5C07;&#x4ED6;&#x5011;&#x8DDF;&#x9069;&#x7576;&#x5730; typeclass &#x5C0D;&#x61C9;&#x8D77;&#x4F86;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;&#x50CF; <code>Int</code> &#x7684;&#x884C;&#x70BA;&#x8DDF;&#x5F88;&#x591A;&#x6771;&#x897F;&#x5F88;&#x50CF;&#x3002;&#x597D;&#x6BD4;&#x8AAA;&#x4ED6;&#x53EF;&#x4EE5;&#x6BD4;&#x8F03;&#x76F8;&#x4E0D;&#x76F8;&#x7B49;&#xFF0C;&#x53EF;&#x4EE5;&#x5F9E;&#x5927;&#x5230;&#x5C0F;&#x6392;&#x5217;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5C07;&#x4ED6;&#x5011;&#x4E00;&#x4E00;&#x7AAE;&#x8209;&#x51FA;&#x4F86;&#x3002;</p>
<p>Typeclass &#x7684;&#x904B;&#x7528;&#x662F;&#x5F88;&#x96A8;&#x610F;&#x7684;&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5B9A;&#x7FA9;&#x81EA;&#x5DF1;&#x7684;&#x8CC7;&#x6599;&#x578B;&#x614B;&#xFF0C;&#x7136;&#x5F8C;&#x63CF;&#x8FF0;&#x4ED6;&#x53EF;&#x4EE5;&#x600E;&#x6A23;&#x88AB;&#x64CD;&#x4F5C;&#xFF0C;&#x8DDF; typeclass &#x95DC;&#x806F;&#x8D77;&#x4F86;&#x4FBF;&#x5B9A;&#x7FA9;&#x4E86;&#x4ED6;&#x7684;&#x884C;&#x70BA;&#x3002;&#x7531;&#x65BC; Haskell &#x5F37;&#x5927;&#x7684;&#x578B;&#x614B;&#x7CFB;&#x7D71;&#xFF0C;&#x9019;&#x8B93;&#x6211;&#x5011;&#x53EA;&#x8981;&#x8B80;&#x51FD;&#x6578;&#x7684;&#x578B;&#x614B;&#x5BA3;&#x544A;&#x5C31;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x5F88;&#x591A;&#x8CC7;&#x8A0A;&#x3002;typeclass &#x53EF;&#x4EE5;&#x5B9A;&#x7FA9;&#x5F97;&#x5F88;&#x62BD;&#x8C61;&#x5F88; general&#x3002;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x6709;&#x770B;&#x904E; typeclass &#x5B9A;&#x7FA9;&#x4E86;&#x53EF;&#x4EE5;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x6771;&#x897F;&#x662F;&#x5426;&#x76F8;&#x7B49;&#xFF0C;&#x6216;&#x662F;&#x5B9A;&#x7FA9;&#x4E86;&#x53EF;&#x4EE5;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x6771;&#x897F;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x9019;&#x4E9B;&#x662F;&#x65E2;&#x62BD;&#x8C61;&#x4F46;&#x53C8;&#x63CF;&#x8FF0;&#x7C21;&#x6F54;&#x7684;&#x884C;&#x70BA;&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x4E0D;&#x6703;&#x8A8D;&#x70BA;&#x4ED6;&#x5011;&#x6709;&#x4EC0;&#x9EBC;&#x7279;&#x5225;&#x4E4B;&#x8655;&#xFF0C;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x6642;&#x5E38;&#x78B0;&#x5230;&#x4ED6;&#x5011;&#x3002;&#x6700;&#x8FD1;&#x6211;&#x5011;&#x770B;&#x904E;&#x4E86; functor&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x4ED6;&#x5011;&#x662F;&#x4E00;&#x7FA4;&#x53EF;&#x4EE5;&#x88AB; map over &#x7684;&#x7269;&#x4EF6;&#x3002;&#x9019;&#x662F;&#x5176;&#x4E2D;&#x4E00;&#x500B;&#x4F8B;&#x5B50;&#x80FD;&#x5920;&#x62BD;&#x8C61;&#x4F46;&#x53C8;&#x6F02;&#x4EAE;&#x5730;&#x63CF;&#x8FF0;&#x884C;&#x70BA;&#x3002;&#x5728;&#x9019;&#x4E00;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x8A73;&#x52A0;&#x95E1;&#x8FF0; functors&#xFF0C;&#x4E26;&#x6703;&#x63D0;&#x5230;&#x6BD4;&#x8F03;&#x5F37;&#x4E00;&#x4E9B;&#x7684;&#x7248;&#x672C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F; applicative functors&#x3002;&#x6211;&#x5011;&#x4E5F;&#x6703;&#x63D0;&#x5230; monoids&#x3002;</p>
<h2 id="&#x6EAB;&#x7FD2;-functors">&#x6EAB;&#x7FD2; Functors</h2>
<p><img src="img/frogtor.png" alt=""></p>
<p>&#x6211;&#x5011;&#x5DF2;&#x7D93;&#x5728;&#x4E4B;&#x524D;&#x7684;&#x7AE0;&#x7BC0;&#x63D0;&#x5230; functors&#x3002;&#x5982;&#x679C;&#x4F60;&#x9084;&#x6C92;&#x8B80;&#x90A3;&#x500B;&#x7AE0;&#x7BC0;&#xFF0C;&#x4E5F;&#x8A31;&#x4F60;&#x61C9;&#x8A72;&#x5148;&#x53BB;&#x770B;&#x770B;&#x3002;&#x6216;&#x662F;&#x4F60;&#x76F4;&#x63A5;&#x5047;&#x88DD;&#x4F60;&#x5DF2;&#x7D93;&#x8B80;&#x904E;&#x4E86;&#x3002;</p>
<p>&#x4F86;&#x5FEB;&#x901F;&#x8907;&#x7FD2;&#x4E00;&#x4E0B;&#xFF1A;Functors &#x662F;&#x53EF;&#x4EE5;&#x88AB; map over &#x7684;&#x7269;&#x4EF6;&#xFF0C;&#x50CF;&#x662F; lists&#xFF0C;<code>Maybe</code>&#xFF0C;trees &#x7B49;&#x7B49;&#x3002;&#x5728; Haskell &#x4E2D;&#x6211;&#x5011;&#x662F;&#x7528; <code>Functor</code> &#x9019;&#x500B; typeclass &#x4F86;&#x63CF;&#x8FF0;&#x4ED6;&#x3002;&#x9019;&#x500B; typeclass &#x53EA;&#x6709;&#x4E00;&#x500B; method&#xFF0C;&#x53EB;&#x505A; <code>fmap</code>&#xFF0C;&#x4ED6;&#x7684;&#x578B;&#x614B;&#x662F; <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>&#x3002;&#x9019;&#x578B;&#x614B;&#x8AAA;&#x660E;&#x4E86;&#x5982;&#x679C;&#x7D66;&#x6211;&#x4E00;&#x500B;&#x5F9E; <code>a</code> &#x6620;&#x5230; <code>b</code> &#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x500B;&#x88DD;&#x4E86; <code>a</code> &#x7684;&#x76D2;&#x5B50;&#xFF0C;&#x6211;&#x6703;&#x56DE;&#x7D66;&#x4F60;&#x4E00;&#x500B;&#x88DD;&#x4E86; <code>b</code> &#x7684;&#x76D2;&#x5B50;&#x3002;&#x5C31;&#x597D;&#x50CF;&#x7528;&#x9019;&#x500B;&#x51FD;&#x6578;&#x5C07;&#x6BCF;&#x500B;&#x5143;&#x7D20;&#x90FD;&#x8F49;&#x6210; <code>b</code> &#x4E00;&#x6A23;</p>
<pre><code class="lang-text">*&#x7D66;&#x4E00;&#x9EDE;&#x5EFA;&#x8B70;*&#x3002;&#x9019;&#x76D2;&#x5B50;&#x7684;&#x6BD4;&#x55BB;&#x5617;&#x8A66;&#x8B93;&#x4F60;&#x6293;&#x5230;&#x4E9B; functors &#x662F;&#x5982;&#x4F55;&#x904B;&#x4F5C;&#x7684;&#x611F;&#x89BA;&#x3002;&#x5728;&#x4E4B;&#x5F8C;&#x6211;&#x5011;&#x4E5F;&#x6703;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6BD4;&#x55BB;&#x4F86;&#x6BD4;&#x55BB; applicative functors &#x8DDF; monads&#x3002;&#x5728;&#x591A;&#x6578;&#x60C5;&#x6CC1;&#x4E0B;&#x9019;&#x7A2E;&#x6BD4;&#x55BB;&#x662F;&#x6070;&#x7576;&#x7684;&#xFF0C;&#x4F46;&#x4E0D;&#x8981;&#x904E;&#x5EA6;&#x5F15;&#x7533;&#xFF0C;&#x6709;&#x4E9B; functors &#x662F;&#x4E0D;&#x9069;&#x7528;&#x9019;&#x500B;&#x6BD4;&#x55BB;&#x7684;&#x3002;&#x4E00;&#x500B;&#x6BD4;&#x8F03;&#x6B63;&#x78BA;&#x7684;&#x5F62;&#x5BB9;&#x662F; functors &#x662F;&#x4E00;&#x500B;&#x8A08;&#x7B97;&#x8A9E;&#x5883;&#xFF08;computational context&#xFF09;&#x3002;&#x9019;&#x500B;&#x8A9E;&#x5883;&#x53EF;&#x80FD;&#x662F;&#x9019;&#x500B; computation &#x53EF;&#x80FD;&#x5E36;&#x6709;&#x503C;&#xFF0C;&#x6216;&#x662F;&#x6709;&#x53EF;&#x80FD;&#x6703;&#x5931;&#x6557;&#xFF08;&#x50CF; ``Maybe`` &#x8DDF; ``Either a``&#xFF09;&#xFF0C;&#x6216;&#x662F;&#x4ED6;&#x53EF;&#x80FD;&#x6709;&#x591A;&#x500B;&#x503C;&#xFF08;&#x50CF; lists&#xFF09;&#xFF0C;&#x7B49;&#x7B49;&#x3002;
</code></pre>
<p>&#x5982;&#x679C;&#x4E00;&#x500B; type constructor &#x8981;&#x662F; <code>Functor</code> &#x7684; instance&#xFF0C;&#x90A3;&#x4ED6;&#x7684; kind &#x5FC5;&#x9808;&#x662F; <code>* -&gt; *</code>&#xFF0C;&#x9019;&#x4EE3;&#x8868;&#x4ED6;&#x5FC5;&#x9808;&#x525B;&#x597D;&#x63A5;&#x53D7;&#x4E00;&#x500B; type &#x7576;&#x4F5C; type parameter&#x3002;&#x50CF;&#x662F; <code>Maybe</code> &#x53EF;&#x4EE5;&#x662F; Functor &#x7684;&#x4E00;&#x500B; instance&#xFF0C;&#x56E0;&#x70BA;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B; type parameter&#xFF0C;&#x4F86;&#x505A;&#x6210;&#x50CF;&#x662F; <code>Maybe Int</code>&#xFF0C;&#x6216;&#x662F; <code>Maybe String</code>&#x3002;&#x5982;&#x679C;&#x4E00;&#x500B; type constructor &#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;&#xFF0C;&#x50CF;&#x662F; <code>Either</code>&#xFF0C;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x7D66;&#x4ED6;&#x5169;&#x500B; type parameter&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x4E0D;&#x80FD;&#x9019;&#x6A23;&#x5BEB;&#xFF1A;<code>instance Functor Either where</code>&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5BEB; <code>instance Functor (Either a) where</code>&#xFF0C;&#x5982;&#x679C;&#x6211;&#x5011;&#x628A; <code>fmap</code> &#x9650;&#x7E2E;&#x6210;&#x53EA;&#x662F; <code>Either a</code> &#x7684;&#xFF0C;&#x90A3;&#x4ED6;&#x7684;&#x578B;&#x614B;&#x5C31;&#x662F; <code>fmap :: (b -&gt; c) -&gt; Either a b -&gt; Either a c</code>&#x3002;&#x5C31;&#x50CF;&#x4F60;&#x770B;&#x5230;&#x7684;&#xFF0C;<code>Either a</code> &#x7684;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x56E0;&#x70BA; <code>Either a</code> &#x53EA;&#x6070;&#x597D;&#x63A5;&#x53D7;&#x4E00;&#x500B; type parameter&#xFF0C;&#x4F46; <code>Either</code> &#x5247;&#x8981;&#x63A5;&#x53D7;&#x5169;&#x500B; type parameters&#x3002;&#x9019;&#x6A23; fmap &#x7684;&#x578B;&#x614B;&#x8B8A;&#x6210; <code>fmap :: (b -&gt; c) -&gt; Either b -&gt; Either c</code>&#xFF0C;&#x9019;&#x4E0D;&#x592A;&#x5408;&#x7406;&#x3002;</p>
<p>&#x6211;&#x5011;&#x77E5;&#x9053;&#x6709;&#x8A31;&#x591A;&#x578B;&#x614B;&#x90FD;&#x662F; <code>Functor</code> &#x7684; instance&#xFF0C;&#x50CF;&#x662F; <code>[]</code>&#xFF0C;<code>Maybe</code>&#xFF0C;<code>Either a</code> &#x4EE5;&#x53CA;&#x6211;&#x5011;&#x81EA;&#x5DF1;&#x5BEB;&#x7684; <code>Tree</code>&#x3002;&#x6211;&#x5011;&#x4E5F;&#x770B;&#x5230;&#x4E86;&#x5982;&#x4F55;&#x7528;&#x4E00;&#x500B;&#x51FD;&#x6578; map &#x4ED6;&#x5011;&#x3002;&#x5728;&#x9019;&#x4E00;&#x7AE0;&#x7BC0;&#xFF0C;&#x6211;&#x5011;&#x518D;&#x591A;&#x8209;&#x5169;&#x500B;&#x4F8B;&#x5B50;&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <code>IO</code> &#x8DDF; <code>(-&gt;) r</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x500B;&#x503C;&#x7684;&#x578B;&#x614B;&#x662F; <code>IO String</code>&#xFF0C;&#x4ED6;&#x4EE3;&#x8868;&#x7684;&#x662F;&#x4E00;&#x500B;&#x6703;&#x88AB;&#x8A08;&#x7B97;&#x6210; String &#x7D50;&#x679C;&#x7684; I/O action&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; do syntax &#x4F86;&#x628A;&#x7D50;&#x679C;&#x7D81;&#x5B9A;&#x5230;&#x67D0;&#x500B;&#x540D;&#x7A31;&#x3002;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x628A; I/O action &#x6BD4;&#x55BB;&#x505A;&#x9577;&#x4E86;&#x8173;&#x7684;&#x76D2;&#x5B50;&#xFF0C;&#x6703;&#x5230;&#x771F;&#x5BE6;&#x4E16;&#x754C;&#x5E6B;&#x6211;&#x5011;&#x53D6;&#x4E00;&#x4E9B;&#x503C;&#x56DE;&#x4F86;&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x6AA2;&#x8996;&#x4ED6;&#x5011;&#x53D6;&#x4E86;&#x4EC0;&#x9EBC;&#x503C;&#xFF0C;&#x4F46;&#x4E00;&#x65E6;&#x770B;&#x904E;&#xFF0C;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x8981;&#x628A;&#x503C;&#x653E;&#x56DE;&#x76D2;&#x5B50;&#x4E2D;&#x3002;&#x7528;&#x9019;&#x500B;&#x6BD4;&#x55BB;&#xFF0C;<code>IO</code> &#x7684;&#x884C;&#x70BA;&#x5C31;&#x50CF;&#x662F;&#x4E00;&#x500B; functor&#x3002;</p>
<p>&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B; <code>IO</code> &#x662F;&#x600E;&#x9EBC;&#x6A23;&#x7684;&#x4E00;&#x500B; <code>Functor</code> instance&#x3002;&#x7576;&#x6211;&#x5011; <code>fmap</code> &#x7528;&#x4E00;&#x500B; function &#x4F86; map over I/O action &#x6642;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x60F3;&#x8981;&#x62FF;&#x56DE;&#x4E00;&#x500B;&#x88DD;&#x8457;&#x5DF2;&#x7D93;&#x7528; function &#x6620;&#x5C04;&#x904E;&#x503C;&#x7684; I/O action&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> <span class="hljs-type">IO</span> <span class="hljs-keyword">where</span></span>
    fmap f action = <span class="hljs-keyword">do</span>
        result &lt;- action
        return (f result)
</code></pre>
<p>&#x5C0D;&#x4E00;&#x500B; I/O action &#x505A; map over &#x52D5;&#x4F5C;&#x7684;&#x7D50;&#x679C;&#x4ECD;&#x6703;&#x662F;&#x4E00;&#x500B; I/O action&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x624D;&#x7528; do syntax &#x4F86;&#x628A;&#x5169;&#x500B; I/O action &#x9ECF;&#x6210;&#x4E00;&#x500B;&#x3002;&#x5728; <code>fmap</code> &#x7684;&#x5BE6;&#x4F5C;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x5148;&#x57F7;&#x884C;&#x4E86;&#x539F;&#x672C;&#x50B3;&#x9032;&#x7684; I/O action&#xFF0C;&#x4E26;&#x628A;&#x7D50;&#x679C;&#x7D81;&#x5B9A;&#x6210; <code>result</code>&#x3002;&#x7136;&#x5F8C;&#x6211;&#x5011;&#x5BEB;&#x4E86; <code>return (f result)</code>&#x3002;<code>return</code> &#x5C31;&#x5982;&#x4F60;&#x6240;&#x77E5;&#x9053;&#x7684;&#xFF0C;&#x662F;&#x4E00;&#x500B;&#x53EA;&#x6703;&#x56DE;&#x50B3;&#x5305;&#x4E86;&#x4F60;&#x50B3;&#x7D66;&#x4ED6;&#x6771;&#x897F;&#x7684; I/O action&#x3002;&#x9084;&#x6709;&#x4E00;&#x500B; do block &#x7684;&#x56DE;&#x50B3;&#x503C;&#x4E00;&#x5B9A;&#x662F;&#x4ED6;&#x6700;&#x5F8C;&#x4E00;&#x500B; I/O action &#x7684;&#x56DE;&#x50B3;&#x503C;&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC;&#x6211;&#x5011;&#x9700;&#x8981; return&#x3002;&#x5176;&#x5BE6;&#x4ED6;&#x53EA;&#x662F;&#x56DE;&#x50B3;&#x5305;&#x4E86; <code>f result</code> &#x7684; I/O action&#x3002;</p>
<p>&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x518D;&#x591A;&#x5BE6;&#x9A57;&#x4E00;&#x4E0B;&#x4F86;&#x627E;&#x5230;&#x4E9B;&#x611F;&#x89BA;&#x3002;&#x4F86;&#x770B;&#x770B;&#x9019;&#x6BB5; code&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">main</span> = <span class="hljs-keyword">do</span> line &lt;- getLine   
        <span class="hljs-keyword">let</span> line&apos; = reverse line  
        putStrLn $ <span class="hljs-string">&quot;You said &quot;</span> ++ line&apos; ++ <span class="hljs-string">&quot; backwards!&quot;</span>  
        putStrLn $ <span class="hljs-string">&quot;Yes, you really said&quot;</span> ++ line&apos; ++ <span class="hljs-string">&quot; backwards!&quot;</span>
</code></pre>
<p>&#x9019;&#x7A0B;&#x5F0F;&#x8981;&#x6C42;&#x4F7F;&#x7528;&#x8005;&#x8F38;&#x5165;&#x4E00;&#x884C;&#x6587;&#x5B57;&#xFF0C;&#x7136;&#x5F8C;&#x5370;&#x51FA;&#x4E00;&#x884C;&#x53CD;&#x904E;&#x4F86;&#x7684;&#x3002; &#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; <code>fmap</code> &#x4F86;&#x6539;&#x5BEB;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">main</span> = <span class="hljs-keyword">do</span> line &lt;- fmap reverse getLine  
            putStrLn $ <span class="hljs-string">&quot;You said &quot;</span> ++ line ++ <span class="hljs-string">&quot; backwards!&quot;</span>  
            putStrLn $ <span class="hljs-string">&quot;Yes, you really said&quot;</span> ++ line ++ <span class="hljs-string">&quot; backwards!&quot;</span>
</code></pre>
<p><img src="img/alien.png" alt=""></p>
<p>&#x5C31;&#x50CF;&#x6211;&#x5011;&#x7528; <code>fmap</code> <code>reverse</code> &#x4F86; map over <code>Just &quot;blah&quot;</code> &#x6703;&#x5F97;&#x5230; <code>Just &quot;halb&quot;</code>&#xFF0C;&#x6211;&#x5011;&#x4E5F;&#x53EF;&#x4EE5; <code>fmap</code> <code>reverse</code> &#x4F86; map over <code>getLine</code>&#x3002;<code>getLine</code> &#x662F;&#x4E00;&#x500B; I/O action&#xFF0C;&#x4ED6;&#x7684; type &#x662F; <code>IO String</code>&#xFF0C;&#x800C;&#x7528; <code>reverse</code> &#x4F86; map over &#x4ED6;&#x6703;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x53D6;&#x56DE;&#x4E00;&#x500B;&#x5B57;&#x4E32;&#x4E26; <code>reverse</code> &#x4ED6;&#x7684; I/O action&#x3002;&#x5C31;&#x50CF;&#x6211;&#x5011; apply &#x4E00;&#x500B; function &#x5230;&#x4E00;&#x500B; <code>Maybe</code> &#x4E00;&#x6A23;&#xFF0C;&#x6211;&#x5011;&#x4E5F;&#x53EF;&#x4EE5; apply &#x4E00;&#x500B; function &#x5230;&#x4E00;&#x500B; <code>IO</code>&#xFF0C;&#x53EA;&#x662F;&#x9019;&#x500B; <code>IO</code> &#x6703;&#x8DD1;&#x53BB;&#x5916;&#x9762;&#x62FF;&#x56DE;&#x67D0;&#x4E9B;&#x503C;&#x3002;&#x7136;&#x5F8C;&#x6211;&#x5011;&#x628A;&#x7D50;&#x679C;&#x7528; <code>&lt;-</code> &#x7D81;&#x5B9A;&#x5230;&#x67D0;&#x500B;&#x540D;&#x7A31;&#xFF0C;&#x800C;&#x9019;&#x500B;&#x540D;&#x7A31;&#x7D81;&#x5B9A;&#x7684;&#x503C;&#x662F;&#x5DF2;&#x7D93; <code>reverse</code> &#x904E;&#x4E86;&#x3002;</p>
<p>&#x800C; <code>fmap (++&quot;!&quot;) getLine</code> &#x9019;&#x500B; I/O action &#x8868;&#x73FE;&#x5F97;&#x5C31;&#x50CF; <code>getLine</code>&#xFF0C;&#x53EA;&#x662F;&#x4ED6;&#x7684;&#x7D50;&#x679C;&#x591A;&#x4E86;&#x4E00;&#x500B; <code>&quot;!&quot;</code> &#x5728;&#x6700;&#x5F8C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x9650;&#x7E2E; <code>fmap</code> &#x5230; <code>IO</code> &#x578B;&#x614B;&#x4E0A;&#xFF0C;&#x90A3; fmap &#x7684;&#x578B;&#x614B;&#x662F; <code>fmap :: (a -&gt; b) -&gt; IO a -&gt; IO b</code>&#x3002;<code>fmap</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x8DDF;&#x4E00;&#x500B; I/O action&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; I/O action &#x5305;&#x542B;&#x4E86;&#x5DF2;&#x7D93; apply &#x904E; function &#x7684;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x66FE;&#x7D93;&#x6CE8;&#x610F;&#x5230;&#x4F60;&#x60F3;&#x8981;&#x5C07;&#x4E00;&#x500B; I/O action &#x7D81;&#x5B9A;&#x5230;&#x4E00;&#x500B;&#x540D;&#x7A31;&#x4E0A;&#xFF0C;&#x53EA;&#x662F;&#x70BA;&#x4E86;&#x8981; apply &#x4E00;&#x500B; function&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x8003;&#x616E;&#x4F7F;&#x7528; <code>fmap</code>&#xFF0C;&#x90A3;&#x6703;&#x66F4;&#x6F02;&#x4EAE;&#x5730;&#x8868;&#x9054;&#x9019;&#x4EF6;&#x4E8B;&#x3002;&#x6216;&#x8005;&#x4F60;&#x60F3;&#x8981;&#x5C0D; functor &#x4E2D;&#x7684;&#x8CC7;&#x6599;&#x505A; transformation&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5148;&#x5C07;&#x4F60;&#x8981;&#x7528;&#x7684; function &#x5BEB;&#x5728; top level&#xFF0C;&#x6216;&#x662F;&#x628A;&#x4ED6;&#x4F5C;&#x6210;&#x4E00;&#x500B; lambda function&#xFF0C;&#x751A;&#x81F3;&#x7528; function composition&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-keyword">import</span> Data.Char  
<span class="hljs-keyword">import</span> Data.List  

<span class="hljs-title">main</span> = <span class="hljs-keyword">do</span> line &lt;- fmap (intersperse &apos;-&apos; . reverse . map toUpper) getLine  
          putStrLn line
</code></pre>
<pre><code class="lang-haskell">$ runhaskell fmapping_io.hs  
<span class="hljs-title">hello</span> there  
<span class="hljs-type">E</span>-<span class="hljs-type">R</span>-<span class="hljs-type">E</span>-<span class="hljs-type">H</span>-<span class="hljs-type">T</span>- -<span class="hljs-type">O</span>-<span class="hljs-type">L</span>-<span class="hljs-type">L</span>-<span class="hljs-type">E</span>-<span class="hljs-type">H</span>
</code></pre>
<p>&#x6B63;&#x5982;&#x4F60;&#x60F3;&#x7684;&#xFF0C;<code>intersperse &apos;-&apos; . reverse . map toUpper</code> &#x5408;&#x6210;&#x4E86;&#x4E00;&#x500B; function&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5B57;&#x4E32;&#xFF0C;&#x5C07;&#x4ED6;&#x8F49;&#x6210;&#x5927;&#x5BEB;&#xFF0C;&#x7136;&#x5F8C;&#x53CD;&#x904E;&#x4F86;&#xFF0C;&#x518D;&#x7528; <code>intersperse &apos;-&apos;</code> &#x5B89;&#x63D2;&apos;-&apos;&#x3002;&#x4ED6;&#x662F;&#x6BD4;&#x8F03;&#x6F02;&#x4EAE;&#x7248;&#x672C;&#x7684; <code>(\xs -&gt; intersperse &apos;-&apos; (reverse (map toUpper xs)))</code>&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x500B; <code>Functor</code> &#x7684;&#x6848;&#x4F8B;&#x662F; <code>(-&gt;) r</code>&#xFF0C;&#x53EA;&#x662F;&#x6211;&#x5011;&#x5148;&#x524D;&#x6C92;&#x6709;&#x6CE8;&#x610F;&#x5230;&#x3002;&#x4F60;&#x53EF;&#x80FD;&#x6703;&#x56F0;&#x60D1;&#x5230;&#x5E95; <code>(-&gt;) r</code> &#x7A76;&#x7ADF;&#x4EE3;&#x8868;&#x4EC0;&#x9EBC;&#xFF1F;&#x4E00;&#x500B; <code>r -&gt; a</code> &#x7684;&#x578B;&#x614B;&#x53EF;&#x4EE5;&#x5BEB;&#x6210; <code>(-&gt;) r a</code>&#xFF0C;&#x5C31;&#x50CF;&#x662F; <code>2 + 3</code> &#x53EF;&#x4EE5;&#x5BEB;&#x6210; <code>(+) 2 3</code> &#x4E00;&#x6A23;&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5F9E;&#x4E00;&#x500B;&#x4E0D;&#x540C;&#x7684;&#x89D2;&#x5EA6;&#x4F86;&#x770B;&#x5F85; <code>(-&gt;) r a</code>&#xFF0C;&#x4ED6;&#x5176;&#x5BE6;&#x53EA;&#x662F;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;&#x7684; type constructor&#xFF0C;&#x597D;&#x6BD4; <code>Either</code>&#x3002;&#x4F46;&#x8A18;&#x4F4F;&#x6211;&#x5011;&#x8AAA;&#x904E; <code>Functor</code> &#x53EA;&#x80FD;&#x63A5;&#x53D7;&#x4E00;&#x500B; type constructor&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC; <code>(-&gt;)</code> &#x4E0D;&#x662F; <code>Functor</code> &#x7684;&#x4E00;&#x500B; instance&#xFF0C;&#x4F46; <code>(-&gt;) r</code> &#x5247;&#x662F;&#x3002;&#x5982;&#x679C;&#x7A0B;&#x5F0F;&#x7684;&#x8A9E;&#x6CD5;&#x5141;&#x8A31;&#x7684;&#x8A71;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5C07; <code>(-&gt;) r</code> &#x5BEB;&#x6210; <code>(r -&gt;)</code>&#x3002;&#x5C31;&#x5982; <code>(2+)</code> &#x4EE3;&#x8868;&#x7684;&#x5176;&#x5BE6;&#x662F; <code>(+) 2</code>&#x3002;&#x81F3;&#x65BC;&#x7D30;&#x7BC0;&#x662F;&#x5982;&#x4F55;&#x5462;&#xFF1F;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x770B;&#x770B; <code>Control.Monad.Instances</code>&#x3002;</p>
<pre><code class="lang-text">&#x6211;&#x5011;&#x901A;&#x5E38;&#x8AAA;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x6771;&#x897F;&#x4EE5;&#x53CA;&#x56DE;&#x50B3;&#x96A8;&#x4FBF;&#x4E00;&#x500B;&#x6771;&#x897F;&#x7684;&#x51FD;&#x6578;&#x578B;&#x614B;&#x662F; ``a -&gt; b``&#x3002;``r -&gt; a`` &#x662F;&#x540C;&#x6A23;&#x610F;&#x601D;&#xFF0C;&#x53EA;&#x662F;&#x628A;&#x7B26;&#x865F;&#x4EE3;&#x63DB;&#x4E86;&#x4E00;&#x4E0B;&#x3002;
</code></pre>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> ((-&gt;) r) <span class="hljs-keyword">where</span></span>  
    fmap f g = (\x -&gt; f (g x))
</code></pre>
<p>&#x5982;&#x679C;&#x8A9E;&#x6CD5;&#x5141;&#x8A31;&#x7684;&#x8A71;&#xFF0C;&#x4ED6;&#x53EF;&#x4EE5;&#x88AB;&#x5BEB;&#x6210;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> (<span class="hljs-title">r</span> -&gt;) <span class="hljs-keyword">where</span></span>  
    fmap f g = (\x -&gt; f (g x))
</code></pre>
<p>&#x4F46;&#x5176;&#x5BE6;&#x662F;&#x4E0D;&#x5141;&#x8A31;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x5BEB;&#x6210;&#x7B2C;&#x4E00;&#x7A2E;&#x7684;&#x6A23;&#x5B50;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B; <code>fmap</code> &#x7684;&#x578B;&#x614B;&#x3002;&#x4ED6;&#x7684;&#x578B;&#x614B;&#x662F; <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>&#x3002;&#x6211;&#x5011;&#x628A;&#x6240;&#x6709;&#x7684; <code>f</code> &#x5728;&#x5FC3;&#x88E1;&#x4EE3;&#x63DB;&#x6210; <code>(-&gt;) r</code>&#x3002;&#x5247; <code>fmap</code> &#x7684;&#x578B;&#x614B;&#x5C31;&#x8B8A;&#x6210; <code>fmap :: (a -&gt; b) -&gt; ((-&gt;) r a) -&gt; ((-&gt;) r b)</code>&#x3002;&#x63A5;&#x8457;&#x6211;&#x5011;&#x628A; <code>(-&gt;) r a</code> &#x8DDF; <code>(-&gt;) r b</code> &#x63DB;&#x6210; <code>r -&gt; a</code> &#x8DDF; <code>r -&gt; b</code>&#x3002;&#x5247;&#x6211;&#x5011;&#x5F97;&#x5230; <code>fmap :: (a -&gt; b) -&gt; (r -&gt; a) -&gt; (r -&gt; b)</code>&#x3002;</p>
<p>&#x5F9E;&#x4E0A;&#x9762;&#x7684;&#x7D50;&#x679C;&#x770B;&#x5230;&#x5C07;&#x4E00;&#x500B; function map over &#x4E00;&#x500B; function &#x6703;&#x5F97;&#x5230;&#x53E6;&#x4E00;&#x500B; function&#xFF0C;&#x5C31;&#x5982; map over &#x4E00;&#x500B; function &#x5230; <code>Maybe</code> &#x6703;&#x5F97;&#x5230;&#x4E00;&#x500B; <code>Maybe</code>&#xFF0C;&#x800C; map over &#x4E00;&#x500B; function &#x5230;&#x4E00;&#x500B; list &#x6703;&#x5F97;&#x5230;&#x4E00;&#x500B; list&#x3002;&#x800C; <code>fmap :: (a -&gt; b) -&gt; (r -&gt; a) -&gt; (r -&gt; b)</code> &#x544A;&#x8A34;&#x6211;&#x5011;&#x4EC0;&#x9EBC;&#xFF1F;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5F9E; <code>a</code> &#x5230; <code>b</code> &#x7684; function&#xFF0C;&#x8DDF;&#x4E00;&#x500B;&#x5F9E; <code>r</code> &#x5230; <code>a</code> &#x7684; function&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x5F9E; <code>r</code> &#x5230; <code>b</code> &#x7684; function&#x3002;&#x9019;&#x6839;&#x672C;&#x5C31;&#x662F; function composition&#x3002;&#x628A; <code>r -&gt; a</code> &#x7684;&#x8F38;&#x51FA;&#x63A5;&#x5230; <code>a -&gt; b</code> &#x7684;&#x8F38;&#x5165;&#xFF0C;&#x7684;&#x78BA;&#x662F; function composition &#x5728;&#x505A;&#x7684;&#x4E8B;&#x3002;&#x5982;&#x679C;&#x4F60;&#x518D;&#x4ED4;&#x7D30;&#x770B;&#x770B; instance &#x7684;&#x5B9A;&#x7FA9;&#xFF0C;&#x6703;&#x767C;&#x73FE;&#x771F;&#x7684;&#x5C31;&#x662F;&#x4E00;&#x500B; function composition&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> ((-&gt;) r) <span class="hljs-keyword">where</span></span>  
    fmap = (.)
</code></pre>
<p>&#x9019;&#x5F88;&#x660E;&#x986F;&#x5C31;&#x662F;&#x628A; <code>fmap</code> &#x7576; composition &#x5728;&#x7528;&#x3002;&#x53EF;&#x4EE5;&#x7528; <code>:m + Control.Monad.Instances</code> &#x628A;&#x6A21;&#x7D44;&#x88DD;&#x8F09;&#x9032;&#x4F86;&#xFF0C;&#x4E26;&#x505A;&#x4E00;&#x4E9B;&#x5617;&#x8A66;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; :t fmap (*<span class="hljs-number">3</span>) (+<span class="hljs-number">100</span>)  
<span class="hljs-title">fmap</span> (*<span class="hljs-number">3</span>) (+<span class="hljs-number">100</span>) :: (<span class="hljs-type">Num</span> a) =&gt; a -&gt; a  
<span class="hljs-title">ghci</span>&gt; fmap (*<span class="hljs-number">3</span>) (+<span class="hljs-number">100</span>) <span class="hljs-number">1</span>  
<span class="hljs-number">303</span>  
<span class="hljs-title">ghci</span>&gt; (*<span class="hljs-number">3</span>) `fmap` (+<span class="hljs-number">100</span>) $ <span class="hljs-number">1</span>  
<span class="hljs-number">303</span>  
<span class="hljs-title">ghci</span>&gt; (*<span class="hljs-number">3</span>) . (+<span class="hljs-number">100</span>) $ <span class="hljs-number">1</span>  
<span class="hljs-number">303</span>  
<span class="hljs-title">ghci</span>&gt; fmap (show . (*<span class="hljs-number">3</span>)) (*<span class="hljs-number">100</span>) <span class="hljs-number">1</span>  
<span class="hljs-string">&quot;300&quot;</span>
</code></pre>
<p>&#x6211;&#x5011;&#x547C;&#x53EB; <code>fmap</code> &#x7684;&#x65B9;&#x5F0F;&#x662F; infix &#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x9019;&#x8DDF; <code>.</code> &#x5F88;&#x50CF;&#x3002;&#x5728;&#x7B2C;&#x4E8C;&#x884C;&#xFF0C;&#x6211;&#x5011;&#x628A; <code>(*3)</code> map over &#x5230; <code>(+100)</code> &#x4E0A;&#xFF0C;&#x9019;&#x6703;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x5148;&#x628A;&#x8F38;&#x5165;&#x503C; <code>(+100)</code> &#x518D; <code>(*3)</code> &#x7684; function&#xFF0C;&#x6211;&#x5011;&#x518D;&#x7528; <code>1</code> &#x53BB;&#x547C;&#x53EB;&#x4ED6;&#x3002;</p>
<p>&#x5230;&#x9019;&#x908A;&#x70BA;&#x6B62;&#x76D2;&#x5B50;&#x7684;&#x6BD4;&#x55BB;&#x9084;&#x9069;&#x7528;&#x55CE;&#xFF1F;&#x5982;&#x679C;&#x4F60;&#x786C;&#x662F;&#x8981;&#x89E3;&#x91CB;&#x7684;&#x8A71;&#x9084;&#x662F;&#x89E3;&#x91CB;&#x5F97;&#x901A;&#x3002;&#x7576;&#x6211;&#x5011;&#x5C07; <code>fmap (+3)</code> map over <code>Just 3</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x5C0D;&#x65BC; <code>Maybe</code> &#x6211;&#x5011;&#x5F88;&#x5BB9;&#x6613;&#x628A;&#x4ED6;&#x60F3;&#x6210;&#x662F;&#x88DD;&#x4E86;&#x503C;&#x7684;&#x76D2;&#x5B50;&#xFF0C;&#x6211;&#x5011;&#x53EA;&#x662F;&#x5C0D;&#x76D2;&#x5B50;&#x88E1;&#x9762;&#x7684;&#x503C; <code>(+3)</code>&#x3002;&#x4F46;&#x5C0D;&#x65BC; <code>fmap (*3) (+100)</code> &#x5462;&#xFF1F;&#x4F60;&#x53EF;&#x4EE5;&#x628A; <code>(+100)</code> &#x60F3;&#x6210;&#x662F;&#x4E00;&#x500B;&#x88DD;&#x4E86;&#x503C;&#x7684;&#x76D2;&#x5B50;&#x3002;&#x6709;&#x9EDE;&#x50CF;&#x628A; I/O action &#x60F3;&#x6210;&#x9577;&#x4E86;&#x8173;&#x7684;&#x76D2;&#x5B50;&#x4E00;&#x6A23;&#x3002;&#x5C0D; <code>(+100)</code> &#x4F7F;&#x7528; <code>fmap (*3)</code> &#x6703;&#x7522;&#x751F;&#x53E6;&#x4E00;&#x500B;&#x8868;&#x73FE;&#x5F97;&#x50CF; <code>(+100)</code> &#x7684; function&#x3002;&#x53EA;&#x662F;&#x5728;&#x7B97;&#x51FA;&#x503C;&#x4E4B;&#x524D;&#xFF0C;&#x6703;&#x518D;&#x591A;&#x8A08;&#x7B97; <code>(*3)</code>&#x3002;&#x9019;&#x6A23;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x4F86; <code>fmap</code> &#x8868;&#x73FE;&#x5F97;&#x5C31;&#x50CF; <code>.</code> &#x4E00;&#x6A23;&#x3002;</p>
<p><code>fmap</code> &#x7B49;&#x540C;&#x65BC; function composition &#x9019;&#x4EF6;&#x4E8B;&#x5C0D;&#x6211;&#x5011;&#x4F86;&#x8AAA;&#x4E26;&#x4E0D;&#x662F;&#x5F88;&#x5BE6;&#x7528;&#xFF0C;&#x4F46;&#x81F3;&#x5C11;&#x662F;&#x4E00;&#x500B;&#x6709;&#x8DA3;&#x7684;&#x89C0;&#x9EDE;&#x3002;&#x9019;&#x4E5F;&#x8B93;&#x6211;&#x5011;&#x6253;&#x958B;&#x8996;&#x91CE;&#xFF0C;&#x770B;&#x5230;&#x76D2;&#x5B50;&#x7684;&#x6BD4;&#x55BB;&#x4E0D;&#x662F;&#x90A3;&#x9EBC;&#x6070;&#x7576;&#xFF0C;functors &#x5176;&#x5BE6;&#x6BD4;&#x8F03;&#x50CF; computation&#x3002;function &#x88AB; map over &#x5230;&#x4E00;&#x500B; computation &#x6703;&#x7522;&#x751F;&#x7D93;&#x7531;&#x90A3;&#x500B; function &#x6620;&#x5C04;&#x904E;&#x5F8C;&#x7684; computation&#x3002;</p>
<p><img src="img/lifter.png" alt=""></p>
<p>&#x5728;&#x6211;&#x5011;&#x7E7C;&#x7E8C;&#x770B; <code>fmap</code> &#x8A72;&#x9075;&#x5B88;&#x7684;&#x898F;&#x5247;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x5011;&#x518D;&#x770B;&#x4E00;&#x6B21; <code>fmap</code> &#x7684;&#x578B;&#x614B;&#xFF0C;&#x4ED6;&#x662F; <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>&#x3002;&#x5F88;&#x660E;&#x986F;&#x6211;&#x5011;&#x662F;&#x5728;&#x8A0E;&#x8AD6; Functor&#xFF0C;&#x6240;&#x4EE5;&#x70BA;&#x4E86;&#x7C21;&#x6F54;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x4E0D;&#x5BEB; <code>(Functor f) =&gt;</code> &#x7684;&#x90E8;&#x4EFD;&#x3002;&#x7576;&#x6211;&#x5011;&#x5728;&#x5B78; curry &#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x8AAA;&#x904E; Haskell &#x7684; function &#x5BE6;&#x969B;&#x4E0A;&#x53EA;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x3002;&#x4E00;&#x500B;&#x578B;&#x614B;&#x662F; <code>a -&gt; b -&gt; c</code> &#x7684;&#x51FD;&#x6578;&#x5BE6;&#x969B;&#x4E0A;&#x662F;&#x63A5;&#x53D7; <code>a</code> &#x7136;&#x5F8C;&#x56DE;&#x50B3; <code>b -&gt; c</code>&#xFF0C;&#x800C; <code>b -&gt; c</code> &#x5BE6;&#x969B;&#x4E0A;&#x63A5;&#x53D7;&#x4E00;&#x500B; <code>b</code> &#x7136;&#x5F8C;&#x56DE;&#x50B3;&#x4E00;&#x500B; <code>c</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x7528;&#x6BD4;&#x8F03;&#x5C11;&#x7684;&#x53C3;&#x6578;&#x547C;&#x53EB;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x5C31;&#x6703;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x9700;&#x8981;&#x63A5;&#x53D7;&#x5269;&#x4E0B;&#x7684;&#x53C3;&#x6578;&#x3002;&#x6240;&#x4EE5; <code>a -&gt; b -&gt; c</code> &#x53EF;&#x4EE5;&#x5BEB;&#x6210; <code>a -&gt; (b -&gt; c)</code>&#x3002;&#x9019;&#x6A23; curry &#x53EF;&#x4EE5;&#x660E;&#x986F;&#x4E00;&#x4E9B;&#x3002;</p>
<p>&#x540C;&#x6A23;&#x7684;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x4E0D;&#x8981;&#x628A; <code>fmap</code> &#x60F3;&#x6210;&#x662F;&#x4E00;&#x500B;&#x63A5;&#x53D7; function &#x8DDF; functor &#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; function &#x7684; function&#x3002;&#x800C;&#x662F;&#x60F3;&#x6210;&#x4E00;&#x500B;&#x63A5;&#x53D7; function &#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x65B0;&#x7684; function &#x7684; function&#xFF0C;&#x56DE;&#x50B3;&#x7684; function &#x63A5;&#x53D7;&#x4E00;&#x500B; functor &#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; functor&#x3002;&#x4ED6;&#x63A5;&#x53D7; <code>a -&gt; b</code> &#x4E26;&#x56DE;&#x50B3; <code>f a -&gt; f b</code>&#x3002;&#x9019;&#x52D5;&#x4F5C;&#x53EB;&#x505A; lifting&#x3002;&#x6211;&#x5011;&#x7528; GHCI &#x7684; <code>:t</code> &#x4F86;&#x505A;&#x7684;&#x5BE6;&#x9A57;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; :t fmap (*<span class="hljs-number">2</span>)  
<span class="hljs-title">fmap</span> (*<span class="hljs-number">2</span>) :: (<span class="hljs-type">Num</span> a, <span class="hljs-type">Functor</span> f) =&gt; f a -&gt; f a  
<span class="hljs-title">ghci</span>&gt; :t fmap (replicate <span class="hljs-number">3</span>)  
<span class="hljs-title">fmap</span> (replicate <span class="hljs-number">3</span>) :: (<span class="hljs-type">Functor</span> f) =&gt; f a -&gt; f [a]
</code></pre>
<p><code>fmap (*2)</code> &#x63A5;&#x53D7;&#x4E00;&#x500B; functor <code>f</code>&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x57FA;&#x65BC;&#x6578;&#x5B57;&#x7684; functor&#x3002;&#x90A3;&#x500B; functor &#x53EF;&#x4EE5;&#x662F; list&#xFF0C;&#x53EF;&#x4EE5;&#x662F; <code>Maybe</code>&#xFF0C;&#x53EF;&#x4EE5;&#x662F; <code>Either String</code>&#x3002;<code>fmap (replicate 3)</code> &#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x57FA;&#x65BC;&#x4EFB;&#x4F55;&#x578B;&#x614B;&#x7684; functor&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x57FA;&#x65BC; list &#x7684; functor&#x3002;</p>
<pre><code class="lang-text">&#x7576;&#x6211;&#x5011;&#x63D0;&#x5230; functor over numbers &#x7684;&#x6642;&#x5019;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x60F3;&#x50CF;&#x4ED6;&#x662F;&#x4E00;&#x500B; functor &#x5305;&#x542B;&#x6709;&#x8A31;&#x591A;&#x6578;&#x5B57;&#x5728;&#x88E1;&#x9762;&#x3002;&#x524D;&#x9762;&#x4E00;&#x7A2E;&#x8AAA;&#x6CD5;&#x5176;&#x5BE6;&#x6BD4;&#x8F03;&#x6B63;&#x78BA;&#xFF0C;&#x4F46;&#x5F8C;&#x9762;&#x4E00;&#x7A2E;&#x8AAA;&#x6CD5;&#x6BD4;&#x8F03;&#x5BB9;&#x6613;&#x8B93;&#x4EBA;&#x7406;&#x89E3;&#x3002;
</code></pre>
<p>&#x9019;&#x6A23;&#x7684;&#x89C0;&#x5BDF;&#x5728;&#x6211;&#x5011;&#x53EA;&#x6709;&#x7D81;&#x5B9A;&#x4E00;&#x500B;&#x90E8;&#x4EFD;&#x5957;&#x7528;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x50CF;&#x662F; <code>fmap (++&quot;!&quot;)</code>&#xFF0C;&#x7684;&#x6642;&#x5019;&#x6703;&#x986F;&#x5F97;&#x66F4;&#x6E05;&#x695A;&#xFF0C;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x628A; <code>fmap</code> &#x60F3;&#x505A;&#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x53E6;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x8DDF;&#x4E00;&#x500B; functor&#xFF0C;&#x7136;&#x5F8C;&#x628A;&#x51FD;&#x6578;&#x5C0D; functor &#x6BCF;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x505A;&#x6620;&#x5C04;&#xFF0C;&#x6216;&#x4F60;&#x53EF;&#x4EE5;&#x60F3;&#x505A;&#x4ED6;&#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x4E26;&#x628A;&#x4ED6; lift &#x5230;&#x53EF;&#x4EE5;&#x5728; functors &#x4E0A;&#x9762;&#x64CD;&#x4F5C;&#x3002;&#x5169;&#x7A2E;&#x60F3;&#x6CD5;&#x90FD;&#x662F;&#x6B63;&#x78BA;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x5728; Haskell &#x4E2D;&#x662F;&#x7B49;&#x50F9;&#x3002;</p>
<p><code>fmap (replicate 3) :: (Functor f) =&gt; f a -&gt; f [a]</code> &#x9019;&#x6A23;&#x7684;&#x578B;&#x614B;&#x4EE3;&#x8868;&#x9019;&#x500B;&#x51FD;&#x6578;&#x53EF;&#x4EE5;&#x904B;&#x4F5C;&#x5728;&#x4EFB;&#x4F55; functor &#x4E0A;&#x3002;&#x81F3;&#x65BC;&#x78BA;&#x5207;&#x7684;&#x884C;&#x70BA;&#x5247;&#x8981;&#x770B;&#x7A76;&#x7ADF;&#x6211;&#x5011;&#x64CD;&#x4F5C;&#x7684;&#x662F;&#x4EC0;&#x9EBC;&#x6A23;&#x7684; functor&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x662F;&#x7528; <code>fmap (replicate 3)</code> &#x5C0D;&#x4E00;&#x500B; list &#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x6703;&#x9078;&#x64C7; <code>fmap</code> &#x91DD;&#x5C0D; list &#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x53EA;&#x662F;&#x4E00;&#x500B; <code>map</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x662F;&#x78B0;&#x5230; <code>Maybe a</code>&#x3002;&#x90A3;&#x4ED6;&#x5728;&#x78B0;&#x5230; <code>Just</code> &#x578B;&#x614B;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x6703;&#x5C0D;&#x88E1;&#x9762;&#x7684;&#x503C;&#x5957;&#x7528; <code>replicate 3</code>&#x3002;&#x800C;&#x78B0;&#x5230; <code>Nothing</code> &#x7684;&#x6642;&#x5019;&#x5C31;&#x56DE;&#x50B3; <code>Nothing</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; fmap (replicate <span class="hljs-number">3</span>) [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]]  
<span class="hljs-title">ghci</span>&gt; fmap (replicate <span class="hljs-number">3</span>) (<span class="hljs-type">Just</span> <span class="hljs-number">4</span>)  
<span class="hljs-type">Just</span> [<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]  
<span class="hljs-title">ghci</span>&gt; fmap (replicate <span class="hljs-number">3</span>) (<span class="hljs-type">Right</span> <span class="hljs-string">&quot;blah&quot;</span>)  
<span class="hljs-type">Right</span> [<span class="hljs-string">&quot;blah&quot;</span>,<span class="hljs-string">&quot;blah&quot;</span>,<span class="hljs-string">&quot;blah&quot;</span>]  
<span class="hljs-title">ghci</span>&gt; fmap (replicate <span class="hljs-number">3</span>) <span class="hljs-type">Nothing</span>  
<span class="hljs-type">Nothing</span>  
<span class="hljs-title">ghci</span>&gt; fmap (replicate <span class="hljs-number">3</span>) (<span class="hljs-type">Left</span> <span class="hljs-string">&quot;foo&quot;</span>)  
<span class="hljs-type">Left</span> <span class="hljs-string">&quot;foo&quot;</span>
</code></pre>
<p>&#x63A5;&#x4E0B;&#x4F86;&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B; functor laws&#x3002;&#x4E00;&#x500B;&#x6771;&#x897F;&#x8981;&#x6210;&#x70BA; functor&#xFF0C;&#x5FC5;&#x9808;&#x8981;&#x9075;&#x5B88;&#x67D0;&#x4E9B;&#x5B9A;&#x5F8B;&#x3002;&#x4E0D;&#x7BA1;&#x4EFB;&#x4F55;&#x4E00;&#x500B; functor &#x90FD;&#x88AB;&#x8981;&#x6C42;&#x5177;&#x6709;&#x67D0;&#x4E9B;&#x6027;&#x8CEA;&#x3002;&#x4ED6;&#x5011;&#x5FC5;&#x9808;&#x662F;&#x80FD;&#x88AB; map over &#x7684;&#x3002;&#x5C0D;&#x4ED6;&#x5011;&#x547C;&#x53EB; <code>fmap</code> &#x61C9;&#x8A72;&#x662F;&#x8981;&#x7528;&#x4E00;&#x500B;&#x51FD;&#x6578; map &#x6BCF;&#x4E00;&#x500B;&#x5143;&#x7D20;&#xFF0C;&#x4E0D;&#x591A;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5;&#x3002;&#x9019;&#x4E9B;&#x884C;&#x70BA;&#x90FD;&#x88AB; functor laws &#x6240;&#x63CF;&#x8FF0;&#x3002;&#x5C0D;&#x65BC; <code>Functor</code> &#x7684; instance &#x4F86;&#x8AAA;&#xFF0C;&#x7E3D;&#x5171;&#x5169;&#x689D;&#x5B9A;&#x5F8B;&#x61C9;&#x8A72;&#x88AB;&#x9075;&#x5B88;&#x3002;&#x4E0D;&#x904E;&#x4ED6;&#x5011;&#x4E0D;&#x6703;&#x5728; Haskell &#x4E2D;&#x81EA;&#x52D5;&#x88AB;&#x6AA2;&#x67E5;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x5FC5;&#x9808;&#x81EA;&#x5DF1;&#x78BA;&#x8A8D;&#x9019;&#x4E9B;&#x689D;&#x4EF6;&#x3002;</p>
<p>functor law &#x7684;&#x7B2C;&#x4E00;&#x689D;&#x8AAA;&#x660E;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x5011;&#x5C0D; functor &#x505A; map <code>id</code>&#xFF0C;&#x90A3;&#x5F97;&#x5230;&#x7684;&#x65B0;&#x7684; functor &#x61C9;&#x8A72;&#x8981;&#x8DDF;&#x539F;&#x4F86;&#x7684;&#x4E00;&#x6A23;&#x3002;&#x5982;&#x679C;&#x5BEB;&#x5F97;&#x6B63;&#x5F0F;&#x4E00;&#x9EDE;&#xFF0C;&#x4ED6;&#x4EE3;&#x8868; <code>fmap id = id</code>&#x3002;&#x57FA;&#x672C;&#x4E0A;&#x4ED6;&#x5C31;&#x662F;&#x8AAA;&#x5C0D; functor &#x547C;&#x53EB; <code>fmap id</code>&#xFF0C;&#x61C9;&#x8A72;&#x7B49;&#x540C;&#x65BC;&#x5C0D; functor &#x547C;&#x53EB; <code>id</code> &#x4E00;&#x6A23;&#x3002;&#x7562;&#x7ADF; <code>id</code> &#x53EA;&#x662F; identity function&#xFF0C;&#x4ED6;&#x53EA;&#x6703;&#x628A;&#x53C3;&#x6578;&#x7167;&#x539F;&#x6A23;&#x4E1F;&#x51FA;&#x3002;&#x4ED6;&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x5BEB;&#x6210; <code>\x -&gt; x</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x5C0D; functor &#x7684;&#x6982;&#x5FF5;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x88AB; map over &#x7684;&#x7269;&#x4EF6;&#xFF0C;&#x90A3; <code>fmap id = id</code> &#x7684;&#x6027;&#x5C31;&#x986F;&#x800C;&#x6613;&#x898B;&#x3002;</p>
<p>&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B;&#x9019;&#x500B;&#x5B9A;&#x5F8B;&#x7684;&#x5E7E;&#x500B;&#x6848;&#x4F8B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; fmap id (<span class="hljs-type">Just</span> <span class="hljs-number">3</span>)  
<span class="hljs-type">Just</span> <span class="hljs-number">3</span>  
<span class="hljs-title">ghci</span>&gt; id (<span class="hljs-type">Just</span> <span class="hljs-number">3</span>)  
<span class="hljs-type">Just</span> <span class="hljs-number">3</span>  
<span class="hljs-title">ghci</span>&gt; fmap id [<span class="hljs-number">1.</span><span class="hljs-number">.5</span>]  
[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]  
<span class="hljs-title">ghci</span>&gt; id [<span class="hljs-number">1.</span><span class="hljs-number">.5</span>]  
[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]  
<span class="hljs-title">ghci</span>&gt; fmap id []  
[]  
<span class="hljs-title">ghci</span>&gt; fmap id <span class="hljs-type">Nothing</span>  
<span class="hljs-type">Nothing</span>
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x770B;&#x770B; <code>Maybe</code> &#x7684; <code>fmap</code> &#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x6211;&#x5011;&#x4E0D;&#x96E3;&#x767C;&#x73FE;&#x7B2C;&#x4E00;&#x5B9A;&#x5F8B;&#x70BA;&#x4F55;&#x88AB;&#x9075;&#x5B88;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> <span class="hljs-type">Maybe</span> <span class="hljs-keyword">where</span></span>  
    fmap f (<span class="hljs-type">Just</span> x) = <span class="hljs-type">Just</span> (f x)  
    fmap f <span class="hljs-type">Nothing</span> = <span class="hljs-type">Nothing</span>
</code></pre>
<p>&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x60F3;&#x50CF;&#x5728; <code>f</code> &#x7684;&#x4F4D;&#x7F6E;&#x64FA;&#x4E0A; <code>id</code>&#x3002;&#x6211;&#x5011;&#x770B;&#x5230; <code>fmap id</code> &#x62FF;&#x5230; <code>Just x</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x7D50;&#x679C;&#x53EA;&#x4E0D;&#x904E;&#x662F; <code>Just (id x)</code>&#xFF0C;&#x800C; <code>id</code> &#x6709;&#x53EA;&#x56DE;&#x50B3;&#x4ED6;&#x62FF;&#x5230;&#x7684;&#x6771;&#x897F;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x77E5;&#x9053; <code>Just (id x)</code> &#x7B49;&#x50F9;&#x65BC; <code>Just x</code>&#x3002;&#x6240;&#x4EE5;&#x8AAA;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x5C0D; <code>Maybe</code> &#x4E2D;&#x7684; <code>Just</code> &#x7528; <code>id</code> &#x53BB;&#x505A; map over &#x7684;&#x52D5;&#x4F5C;&#xFF0C;&#x6703;&#x62FF;&#x56DE;&#x4E00;&#x6A23;&#x7684;&#x503C;&#x3002;</p>
<p>&#x800C;&#x5C07; <code>id</code> map over <code>Nothing</code> &#x6703;&#x62FF;&#x56DE; <code>Nothing</code> &#x4E26;&#x4E0D;&#x7A00;&#x5947;&#x3002;&#x6240;&#x4EE5;&#x5F9E;&#x9019;&#x5169;&#x500B; <code>fmap</code> &#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7684;&#x78BA; <code>fmap id = id</code> &#x6709;&#x88AB;&#x9075;&#x5B88;&#x3002;</p>
<p><img src="img/justice.png" alt=""></p>
<p><em>&#x7B2C;&#x4E8C;&#x5B9A;&#x5F8B;&#x63CF;&#x8FF0;&#x8AAA;&#x5148;&#x5C07;&#x5169;&#x500B;&#x51FD;&#x6578;&#x5408;&#x6210;&#x4E26;&#x5C07;&#x7D50;&#x679C; map over &#x4E00;&#x500B; functor &#x7684;&#x7D50;&#x679C;&#xFF0C;&#x61C9;&#x8A72;&#x8DDF;&#x5148;&#x5C07;&#x7B2C;&#x4E00;&#x500B;&#x51FD;&#x6578; map over &#x4E00;&#x500B; functor&#xFF0C;&#x518D;&#x5C07;&#x7B2C;&#x4E8C;&#x500B;&#x51FD;&#x6578; map over &#x90A3;&#x500B; functor &#x7684;&#x7D50;&#x679C;&#x662F;&#x4E00;&#x6A23;&#x7684;&#x3002;</em>&#x6B63;&#x5F0F;&#x5730;&#x5BEB;&#x4E0B;&#x4F86;&#x7684;&#x8A71;&#x5C31;&#x662F; <code>fmap (f . g) = fmap f . fmap g</code>&#x3002;&#x6216;&#x662F;&#x7528;&#x53E6;&#x5916;&#x4E00;&#x7A2E;&#x5BEB;&#x6CD5;&#xFF0C;&#x5C0D;&#x65BC;&#x4EFB;&#x4F55;&#x4E00;&#x500B; functor F&#xFF0C;&#x4E0B;&#x9762;&#x9019;&#x500B;&#x5F0F;&#x5B50;&#x61C9;&#x8A72;&#x8981;&#x88AB;&#x9075;&#x5B88;&#xFF1A;<code>fmap (f . g) F = fmap f (fmap g F)</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x80FD;&#x5920;&#x8B49;&#x660E;&#x67D0;&#x500B;&#x578B;&#x5225;&#x9075;&#x5B88;&#x5169;&#x500B;&#x5B9A;&#x5F8B;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x4FDD;&#x8B49;&#x4ED6;&#x8DDF;&#x5176;&#x4ED6; functor &#x5C0D;&#x65BC;&#x6620;&#x5C04;&#x65B9;&#x9762;&#x90FD;&#x64C1;&#x6709;&#x76F8;&#x540C;&#x7684;&#x6027;&#x8CEA;&#x3002;&#x6211;&#x5011;&#x77E5;&#x9053;&#x5982;&#x679C;&#x5C0D;&#x4ED6;&#x7528; <code>fmap</code>&#xFF0C;&#x6211;&#x5011;&#x77E5;&#x9053;&#x4E0D;&#x6703;&#x6709;&#x9664;&#x4E86; mapping &#x4EE5;&#x5916;&#x7684;&#x4E8B;&#x6703;&#x767C;&#x751F;&#xFF0C;&#x800C;&#x4ED6;&#x5C31;&#x50C5;&#x50C5;&#x6703;&#x8868;&#x73FE;&#x6210;&#x67D0;&#x500B;&#x53EF;&#x4EE5;&#x88AB; map over &#x7684;&#x6771;&#x897F;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x4E00;&#x500B; functor&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x518D;&#x4ED4;&#x7D30;&#x6AA2;&#x8996; <code>fmap</code> &#x5C0D;&#x65BC;&#x67D0;&#x4E9B;&#x578B;&#x5225;&#x7684;&#x5BE6;&#x4F5C;&#x4F86;&#x4E86;&#x89E3;&#x7B2C;&#x4E8C;&#x5B9A;&#x5F8B;&#x3002;&#x6B63;&#x5982;&#x6211;&#x5011;&#x5148;&#x524D;&#x5C0D; <code>Maybe</code> &#x6AA2;&#x8996;&#x7B2C;&#x4E00;&#x5B9A;&#x5F8B;&#x4E00;&#x822C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x80FD;&#x5728;&#x9019;&#x908A;&#x6F14;&#x7DF4;&#x4E00;&#x4E0B; <code>Maybe</code> &#x662F;&#x5982;&#x4F55;&#x9075;&#x5B88;&#x7B2C;&#x4E8C;&#x5B9A;&#x5F8B;&#x7684;&#x3002;&#x9996;&#x5148; <code>fmap (f . g)</code> &#x4F86; map over <code>Nothing</code> &#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5F97;&#x5230; <code>Nothing</code>&#x3002;&#x56E0;&#x70BA;&#x7528;&#x4EFB;&#x4F55;&#x51FD;&#x6578;&#x4F86; <code>fmap</code> <code>Nothing</code> &#x7684;&#x8A71;&#x90FD;&#x6703;&#x56DE;&#x50B3; <code>Nothing</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011; <code>fmap f (fmap g Nothing)</code>&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5F97;&#x5230; <code>Nothing</code>&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7576;&#x9762;&#x5C0D; <code>Nothing</code> &#x7684;&#x6642;&#x5019;&#xFF0C;<code>Maybe</code> &#x5F88;&#x986F;&#x7136;&#x662F;&#x9075;&#x5B88;&#x7B2C;&#x4E8C;&#x5B9A;&#x5F8B;&#x7684;&#x3002; &#x90A3;&#x5C0D;&#x65BC; <code>Just something</code> &#x5462;&#xFF1F;&#x5982;&#x679C;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>fmap (f . g) (Just x)</code> &#x7684;&#x8A71;&#xFF0C;&#x5F9E;&#x5BE6;&#x4F5C;&#x7684;&#x7A0B;&#x5F0F;&#x78BC;&#x4E2D;&#x6211;&#x53EF;&#x4EE5;&#x770B;&#x5230; <code>Just ((f . g ) x)</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <code>Just (f (g x))</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>fmap f (fmap g (Just x))</code> &#x7684;&#x8A71;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5F9E;&#x5BE6;&#x4F5C;&#x77E5;&#x9053; <code>fmap g (Just x)</code> &#x6703;&#x662F; <code>Just (g x)</code>&#x3002;<code>fmap f (fmap g (Just x))</code> &#x8DDF; <code>fmap f (Just (g x))</code> &#x76F8;&#x7B49;&#x3002;&#x800C;&#x5F9E;&#x5BE6;&#x4F5C;&#x4E0A;&#x9019;&#x53C8;&#x6703;&#x76F8;&#x7B49;&#x65BC; <code>Just (f (g x))</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x592A;&#x7406;&#x89E3;&#x9019;&#x908A;&#x7684;&#x8AAA;&#x660E;&#xFF0C;&#x5225;&#x64D4;&#x5FC3;&#x3002;&#x53EA;&#x8981;&#x78BA;&#x5B9A;&#x4F60;&#x4E86;&#x89E3;&#x4EC0;&#x9EBC;&#x662F;&#x51FD;&#x6578;&#x5408;&#x6210;&#x5C31;&#x597D;&#x3002;&#x5728;&#x591A;&#x6578;&#x7684;&#x60C5;&#x6CC1;&#x4E0B;&#x4F60;&#x53EF;&#x4EE5;&#x76F4;&#x89BA;&#x5730;&#x5C0D;&#x61C9;&#x5230;&#x9019;&#x4E9B;&#x578B;&#x5225;&#x8868;&#x73FE;&#x5F97;&#x5C31;&#x50CF; containers &#x6216;&#x51FD;&#x6578;&#x4E00;&#x6A23;&#x3002;&#x6216;&#x662F;&#x4E5F;&#x53EF;&#x4EE5;&#x63DB;&#x7A2E;&#x65B9;&#x6CD5;&#xFF0C;&#x53EA;&#x8981;&#x591A;&#x5617;&#x8A66;&#x5C0D;&#x578B;&#x5225;&#x4E2D;&#x4E0D;&#x540C;&#x7684;&#x503C;&#x505A;&#x64CD;&#x4F5C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x578B;&#x5225;&#x662F;&#x5426;&#x6709;&#x9075;&#x5B88;&#x5B9A;&#x5F8B;&#x3002;</p>
<p>&#x6211;&#x5011;&#x4F86;&#x770B;&#x4E00;&#x4E9B;&#x7D93;&#x5178;&#x7684;&#x4F8B;&#x5B50;&#x3002;&#x9019;&#x4E9B;&#x578B;&#x5225;&#x5EFA;&#x69CB;&#x5B50;&#x96D6;&#x7136;&#x662F; <code>Functor</code> &#x7684; instance&#xFF0C;&#x4F46;&#x5BE6;&#x969B;&#x4E0A;&#x4ED6;&#x5011;&#x4E26;&#x4E0D;&#x662F; functor&#xFF0C;&#x56E0;&#x70BA;&#x4ED6;&#x5011;&#x4E26;&#x4E0D;&#x9075;&#x5B88;&#x9019;&#x4E9B;&#x5B9A;&#x5F8B;&#x3002;&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B;&#x5176;&#x4E2D;&#x4E00;&#x500B;&#x578B;&#x5225;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">CMaybe</span> a = <span class="hljs-type">CNothing</span> | <span class="hljs-type">CJust</span> <span class="hljs-type">Int</span> a <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Show</span>)</span>
</code></pre>
<p>C &#x9019;&#x908A;&#x4EE3;&#x8868;&#x7684;&#x662F;&#x8A08;&#x6578;&#x5668;&#x3002;&#x4ED6;&#x662F;&#x4E00;&#x7A2E;&#x770B;&#x8D77;&#x4F86;&#x50CF;&#x662F; <code>Maybe a</code> &#x7684;&#x578B;&#x5225;&#xFF0C;&#x53EA;&#x5DEE;&#x5728; <code>Just</code> &#x5305;&#x542B;&#x4E86;&#x5169;&#x500B; field &#x800C;&#x4E0D;&#x662F;&#x4E00;&#x500B;&#x3002;&#x5728; <code>CJust</code> &#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x500B; field &#x662F; <code>Int</code>&#xFF0C;&#x4ED6;&#x662F;&#x626E;&#x6F14;&#x8A08;&#x6578;&#x5668;&#x7528;&#x7684;&#x3002;&#x800C;&#x7B2C;&#x4E8C;&#x500B; field &#x5247;&#x70BA;&#x578B;&#x5225; <code>a</code>&#xFF0C;&#x4ED6;&#x662F;&#x5F9E;&#x578B;&#x5225;&#x53C3;&#x6578;&#x4F86;&#x7684;&#xFF0C;&#x800C;&#x4ED6;&#x78BA;&#x5207;&#x7684;&#x578B;&#x5225;&#x7576;&#x7136;&#x6703;&#x4F9D;&#x64DA;&#x6211;&#x5011;&#x9078;&#x5B9A;&#x7684; <code>CMaybe a</code> &#x800C;&#x5B9A;&#x3002;&#x6211;&#x5011;&#x4F86;&#x5C0D;&#x4ED6;&#x4F5C;&#x4E9B;&#x64CD;&#x4F5C;&#x4F86;&#x7372;&#x5F97;&#x4E9B;&#x64CD;&#x4F5C;&#x4E0A;&#x7684;&#x76F4;&#x89BA;&#x5427;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">CNothing</span>  
<span class="hljs-type">CNothing</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span>  
<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span>  
<span class="hljs-title">ghci</span>&gt; :t <span class="hljs-type">CNothing</span>  
<span class="hljs-type">CNothing</span> :: <span class="hljs-type">CMaybe</span> a  
<span class="hljs-title">ghci</span>&gt; :t <span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span>  
<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span> :: <span class="hljs-type">CMaybe</span> [<span class="hljs-type">Char</span>]  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">CJust</span> <span class="hljs-number">100</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
<span class="hljs-type">CJust</span> <span class="hljs-number">100</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>CNothing</code>&#xFF0C;&#x5C31;&#x4EE3;&#x8868;&#x4E0D;&#x542B;&#x6709; field&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x7528;&#x7684;&#x662F; <code>CJust</code>&#xFF0C;&#x90A3;&#x7B2C;&#x4E00;&#x500B; field &#x662F;&#x6574;&#x6578;&#xFF0C;&#x800C;&#x7B2C;&#x4E8C;&#x500B; field &#x53EF;&#x4EE5;&#x70BA;&#x4EFB;&#x4F55;&#x578B;&#x5225;&#x3002;&#x6211;&#x5011;&#x4F86;&#x5B9A;&#x7FA9;&#x4E00;&#x500B; <code>Functor</code> &#x7684; instance&#xFF0C;&#x9019;&#x6A23;&#x6BCF;&#x6B21;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>fmap</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x51FD;&#x6578;&#x6703;&#x88AB;&#x5957;&#x7528;&#x5728;&#x7B2C;&#x4E8C;&#x500B; field&#xFF0C;&#x800C;&#x7B2C;&#x4E00;&#x500B; field &#x6703;&#x88AB;&#x52A0;&#x4E00;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> <span class="hljs-type">CMaybe</span> <span class="hljs-keyword">where</span></span>  
    fmap f <span class="hljs-type">CNothing</span> = <span class="hljs-type">CNothing</span>  
    fmap f (<span class="hljs-type">CJust</span> counter x) = <span class="hljs-type">CJust</span> (counter+<span class="hljs-number">1</span>) (f x)
</code></pre>
<p>&#x9019;&#x7A2E;&#x5B9A;&#x7FA9;&#x65B9;&#x5F0F;&#x6709;&#x9EDE;&#x50CF;&#x662F; <code>Maybe</code> &#x7684;&#x5B9A;&#x7FA9;&#x65B9;&#x5F0F;&#xFF0C;&#x53EA;&#x5DEE;&#x5728;&#x7576;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>fmap</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x78B0;&#x5230;&#x7684;&#x4E0D;&#x662F;&#x7A7A;&#x503C;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x4E0D;&#x53EA;&#x6703;&#x5957;&#x7528;&#x51FD;&#x6578;&#xFF0C;&#x9084;&#x6703;&#x628A;&#x8A08;&#x6578;&#x5668;&#x52A0;&#x4E00;&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x4F86;&#x770B;&#x4E00;&#x4E9B;&#x7BC4;&#x4F8B;&#x64CD;&#x4F5C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; fmap (++<span class="hljs-string">&quot;ha&quot;</span>) (<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;ho&quot;</span>)  
<span class="hljs-type">CJust</span> <span class="hljs-number">1</span> <span class="hljs-string">&quot;hoha&quot;</span>  
<span class="hljs-title">ghci</span>&gt; fmap (++<span class="hljs-string">&quot;he&quot;</span>) (fmap (++<span class="hljs-string">&quot;ha&quot;</span>) (<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;ho&quot;</span>))  
<span class="hljs-type">CJust</span> <span class="hljs-number">2</span> <span class="hljs-string">&quot;hohahe&quot;</span>  
<span class="hljs-title">ghci</span>&gt; fmap (++<span class="hljs-string">&quot;blah&quot;</span>) <span class="hljs-type">CNothing</span>  
<span class="hljs-type">CNothing</span>
</code></pre>
<p>&#x9019;&#x4E9B;&#x6703;&#x9075;&#x5B88; functor laws &#x55CE;&#xFF1F;&#x8981;&#x77E5;&#x9053;&#x6709;&#x4E0D;&#x9075;&#x5B88;&#x7684;&#x60C5;&#x5F62;&#xFF0C;&#x53EA;&#x8981;&#x627E;&#x5230;&#x4E00;&#x500B;&#x53CD;&#x4F8B;&#x5C31;&#x597D;&#x4E86;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; fmap id (<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span>)  
<span class="hljs-type">CJust</span> <span class="hljs-number">1</span> <span class="hljs-string">&quot;haha&quot;</span>  
<span class="hljs-title">ghci</span>&gt; id (<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span>)  
<span class="hljs-type">CJust</span> <span class="hljs-number">0</span> <span class="hljs-string">&quot;haha&quot;</span>
</code></pre>
<p>&#x6211;&#x5011;&#x77E5;&#x9053; functor law &#x7684;&#x7B2C;&#x4E00;&#x5B9A;&#x5F8B;&#x63CF;&#x8FF0;&#x7576;&#x6211;&#x5011;&#x7528; <code>id</code> &#x4F86; map over &#x4E00;&#x500B; functor &#x7684;&#x6642;&#x5019;&#xFF0C;&#x4ED6;&#x7684;&#x7D50;&#x679C;&#x61C9;&#x8A72;&#x8DDF;&#x53EA;&#x5C0D; functor &#x547C;&#x53EB; <code>id</code> &#x7684;&#x7D50;&#x679C;&#x4E00;&#x6A23;&#x3002;&#x4F46;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x9019;&#x500B;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x9019;&#x5C0D;&#x65BC; <code>CMaybe</code> &#x4E26;&#x4E0D;&#x9075;&#x5B88;&#x3002;&#x5118;&#x7BA1;&#x4ED6;&#x7684;&#x78BA;&#x662F; <code>Functor</code> typeclass &#x7684;&#x4E00;&#x500B; instace&#x3002;&#x4F46;&#x4ED6;&#x4E26;&#x4E0D;&#x9075;&#x5B88; functor law &#x56E0;&#x6B64;&#x4E0D;&#x662F;&#x4E00;&#x500B; functor&#x3002;&#x5982;&#x679C;&#x6709;&#x4EBA;&#x4F7F;&#x7528;&#x6211;&#x5011;&#x7684; <code>CMaybe</code> &#x578B;&#x5225;&#xFF0C;&#x628A;&#x4ED6;&#x7576;&#x4F5C; functor &#x7528;&#xFF0C;&#x90A3;&#x4ED6;&#x5C31;&#x6703;&#x671F;&#x5F85; functor laws &#x6703;&#x88AB;&#x9075;&#x5B88;&#x3002;&#x4F46; <code>CMaybe</code> &#x4E26;&#x6C92;&#x8FA6;&#x6CD5;&#x6EFF;&#x8DB3;&#xFF0C;&#x4FBF;&#x6703;&#x9020;&#x6210;&#x932F;&#x8AA4;&#x7684;&#x7A0B;&#x5F0F;&#x3002;&#x7576;&#x6211;&#x5011;&#x4F7F;&#x7528;&#x4E00;&#x500B; functor &#x7684;&#x6642;&#x5019;&#xFF0C;&#x51FD;&#x6578;&#x5408;&#x6210;&#x8DDF; map over &#x7684;&#x5148;&#x5F8C;&#x9806;&#x5E8F;&#x4E0D;&#x61C9;&#x8A72;&#x6709;&#x5F71;&#x97FF;&#x3002;&#x4F46;&#x5C0D;&#x65BC; <code>CMaybe</code> &#x4ED6;&#x662F;&#x6709;&#x5F71;&#x97FF;&#x7684;&#xFF0C;&#x56E0;&#x70BA;&#x4ED6;&#x7D00;&#x9304;&#x4E86;&#x88AB; map over &#x7684;&#x6B21;&#x6578;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x5E0C;&#x671B; <code>CMaybe</code> &#x9075;&#x5B88; functor law&#xFF0C;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x8981;&#x8B93; <code>Int</code> &#x6B04;&#x4F4D;&#x5728;&#x505A; <code>fmap</code> &#x7684;&#x6642;&#x5019;&#x7DAD;&#x6301;&#x4E0D;&#x8B8A;&#x3002;</p>
<p>&#x4E4D;&#x770B;&#x4E4B;&#x4E0B; functor laws &#x770B;&#x8D77;&#x4F86;&#x4E0D;&#x662F;&#x5F88;&#x5FC5;&#x8981;&#xFF0C;&#x4E5F;&#x5BB9;&#x6613;&#x8B93;&#x4EBA;&#x641E;&#x4E0D;&#x61C2;&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x77E5;&#x9053;&#x5982;&#x679C;&#x4E00;&#x500B;&#x578B;&#x5225;&#x9075;&#x5B88; functor laws&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x80FD;&#x5C0D;&#x4ED6;&#x4F5C;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x5047;&#x8A2D;&#x3002;&#x5982;&#x679C;&#x9075;&#x5B88;&#x4E86; functor laws&#xFF0C;&#x6211;&#x5011;&#x77E5;&#x9053;&#x5C0D;&#x4ED6;&#x505A; <code>fmap</code> &#x4E0D;&#x6703;&#x505A;&#x591A;&#x9918;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x53EA;&#x662F;&#x7528;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x505A;&#x6620;&#x5C04;&#x800C;&#x5DF2;&#x3002;&#x9019;&#x8B93;&#x5BEB;&#x51FA;&#x4F86;&#x7684;&#x7A0B;&#x5F0F;&#x78BC;&#x8DB3;&#x5920;&#x62BD;&#x8C61;&#x4E5F;&#x5BB9;&#x6613;&#x64F4;&#x5C55;&#x3002;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528;&#x5B9A;&#x5F8B;&#x4F86;&#x63A8;&#x8AD6;&#x578B;&#x5225;&#x7684;&#x884C;&#x70BA;&#x3002;</p>
<p>&#x6240;&#x6709;&#x5728;&#x6A19;&#x6E96;&#x51FD;&#x5F0F;&#x5EAB;&#x4E2D;&#x7684; <code>Functor</code> &#x7684; instance &#x90FD;&#x9075;&#x5B88;&#x9019;&#x4E9B;&#x5B9A;&#x5F8B;&#xFF0C;&#x4F46;&#x4F60;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x6AA2;&#x67E5;&#x4E00;&#x904D;&#x3002;&#x4E0B;&#x4E00;&#x6B21;&#x4F60;&#x5B9A;&#x7FA9;&#x4E00;&#x500B;&#x578B;&#x5225;&#x70BA; <code>Functor</code> &#x7684; instance &#x7684;&#x6642;&#x5019;&#xFF0C;&#x82B1;&#x9EDE;&#x6642;&#x9593;&#x78BA;&#x8A8D;&#x4ED6;&#x78BA;&#x5BE6;&#x9075;&#x5B88; functor laws&#x3002;&#x4E00;&#x65E6;&#x4F60;&#x64CD;&#x4F5C;&#x904E;&#x8DB3;&#x5920;&#x591A;&#x7684; functors &#x6642;&#xFF0C;&#x4F60;&#x5C31;&#x6703;&#x7372;&#x5F97;&#x76F4;&#x89BA;&#xFF0C;&#x77E5;&#x9053;&#x4ED6;&#x5011;&#x6703;&#x6709;&#x4EC0;&#x9EBC;&#x6A23;&#x7684;&#x6027;&#x8CEA;&#x8DDF;&#x884C;&#x70BA;&#x3002;&#x800C;&#x4E14; functor laws &#x4E5F;&#x6703;&#x89BA;&#x5F97;&#x986F;&#x800C;&#x6613;&#x898B;&#x3002;&#x4F46;&#x5C31;&#x7B97;&#x6C92;&#x6709;&#x9019;&#x4E9B;&#x76F4;&#x89BA;&#xFF0C;&#x4F60;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x4E00;&#x884C;&#x4E00;&#x884C;&#x5730;&#x4F86;&#x627E;&#x770B;&#x770B;&#x6709;&#x6C92;&#x6709;&#x53CD;&#x4F8B;&#x8B93;&#x9019;&#x4E9B;&#x5B9A;&#x5F8B;&#x5931;&#x6548;&#x3002;</p>
<p>&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x628A; functor &#x770B;&#x4F5C;&#x8F38;&#x51FA;&#x5177;&#x6709; context &#x7684;&#x503C;&#x3002;&#x4F8B;&#x5982;&#x8AAA; <code>Just 3</code> &#x5C31;&#x662F;&#x8F38;&#x51FA; <code>3</code>&#xFF0C;&#x4F46;&#x4ED6;&#x53C8;&#x5E36;&#x6709;&#x4E00;&#x500B;&#x53EF;&#x80FD;&#x6C92;&#x6709;&#x503C;&#x7684; context&#x3002;<code>[1,2,3]</code> &#x8F38;&#x51FA;&#x4E09;&#x500B;&#x503C;&#xFF0C;<code>1</code>,<code>2</code> &#x8DDF; <code>3</code>&#xFF0C;&#x540C;&#x6642;&#x4E5F;&#x5E36;&#x6709;&#x53EF;&#x80FD;&#x6709;&#x591A;&#x500B;&#x503C;&#x6216;&#x6C92;&#x6709;&#x503C;&#x7684; context&#x3002;<code>(+3)</code> &#x5247;&#x6703;&#x5E36;&#x6709;&#x4E00;&#x500B;&#x4F9D;&#x8CF4;&#x65BC;&#x53C3;&#x6578;&#x7684; context&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x628A; functor &#x60F3;&#x505A;&#x662F;&#x8F38;&#x51FA;&#x503C;&#x9019;&#x4EF6;&#x4E8B;&#xFF0C;&#x90A3;&#x4F60;&#x53EF;&#x4EE5;&#x628A; map over &#x4E00;&#x500B; functor &#x9019;&#x4EF6;&#x4E8B;&#x60F3;&#x6210;&#x5728; functor &#x8F38;&#x51FA;&#x7684;&#x5F8C;&#x9762;&#x518D;&#x591A;&#x52A0;&#x4E00;&#x5C64;&#x8F49;&#x63DB;&#x3002;&#x7576;&#x6211;&#x5011;&#x505A; <code>fmap (+3) [1,2,3]</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x662F;&#x628A; <code>(+3)</code> &#x63A5;&#x5230; <code>[1,2,3]</code> &#x5F8C;&#x9762;&#xFF0C;&#x6240;&#x4EE5;&#x7576;&#x6211;&#x5011;&#x6AA2;&#x8996;&#x4EFB;&#x4F55;&#x4E00;&#x500B; list &#x7684;&#x8F38;&#x51FA;&#x7684;&#x6642;&#x5019;&#xFF0C;<code>(+3)</code> &#x4E5F;&#x6703;&#x88AB;&#x5957;&#x7528;&#x5728;&#x4E0A;&#x9762;&#x3002;&#x53E6;&#x4E00;&#x500B;&#x4F8B;&#x5B50;&#x662F;&#x5C0D;&#x51FD;&#x6578;&#x505A; map over&#x3002;&#x7576;&#x6211;&#x5011;&#x505A; <code>fmap (+3) (*3)</code>&#xFF0C;&#x6211;&#x5011;&#x662F;&#x628A; <code>(+3)</code> &#x9019;&#x500B;&#x8F49;&#x63DB;&#x5957;&#x7528;&#x5728; <code>(*3)</code> &#x5F8C;&#x9762;&#x3002;&#x9019;&#x6A23;&#x60F3;&#x7684;&#x8A71;&#x6703;&#x5F88;&#x81EA;&#x7136;&#x5C31;&#x6703;&#x628A; <code>fmap</code> &#x8DDF;&#x51FD;&#x6578;&#x5408;&#x6210;&#x95DC;&#x806F;&#x8D77;&#x4F86;&#xFF08;<code>fmap (+3) (*3)</code> &#x7B49;&#x50F9;&#x65BC; <code>(+3) . (*3)</code>&#xFF0C;&#x4E5F;&#x7B49;&#x50F9;&#x65BC; <code>\x -&gt; ((x*3)+3)</code>&#xFF09;&#xFF0C;&#x7562;&#x7ADF;&#x6211;&#x5011;&#x662F;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x51FD;&#x6578; <code>(*3)</code> &#x7136;&#x5F8C;&#x5957;&#x7528; <code>(+3)</code> &#x8F49;&#x63DB;&#x3002;&#x6700;&#x5F8C;&#x7684;&#x7D50;&#x679C;&#x4ECD;&#x7136;&#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x53EA;&#x662F;&#x7576;&#x6211;&#x5011;&#x9935;&#x7D66;&#x4ED6;&#x4E00;&#x500B;&#x6578;&#x5B57;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x4ED6;&#x6703;&#x5148;&#x4E58;&#x4E0A;&#x4E09;&#x7136;&#x5F8C;&#x505A;&#x8F49;&#x63DB;&#x52A0;&#x4E0A;&#x4E09;&#x3002;&#x9019;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;&#x51FD;&#x6578;&#x5408;&#x6210;&#x5728;&#x505A;&#x7684;&#x4E8B;&#x3002;</p>
<h2 id="applicative-functors">Applicative functors</h2>
<p><img src="img/present.png" alt=""></p>
<p>&#x5728;&#x9019;&#x500B;&#x7AE0;&#x7BC0;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5B78;&#x5230; applicative functors&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x52A0;&#x5F37;&#x7248;&#x7684; functors&#xFF0C;&#x5728; Haskell &#x4E2D;&#x662F;&#x7528;&#x5728; <code>Control.Applicative</code> &#x4E2D;&#x7684; <code>Applicative</code> &#x9019;&#x500B; typeclass &#x4F86;&#x5B9A;&#x7FA9;&#x7684;&#x3002;</p>
<p>&#x4F60;&#x9084;&#x8A18;&#x5F97; Haskell &#x4E2D;&#x51FD;&#x6578;&#x9810;&#x8A2D;&#x5C31;&#x662F; Curried &#x7684;&#xFF0C;&#x90A3;&#x4EE3;&#x8868;&#x63A5;&#x53D7;&#x591A;&#x500B;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#x5BE6;&#x969B;&#x4E0A;&#x662F;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x7136;&#x5F8C;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5269;&#x9918;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;&#x5982;&#x679C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x7684;&#x578B;&#x5225;&#x662F; <code>a -&gt; b -&gt; c</code>&#xFF0C;&#x6211;&#x5011;&#x901A;&#x5E38;&#x6703;&#x8AAA;&#x9019;&#x500B;&#x51FD;&#x6578;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;&#x4E26;&#x56DE;&#x50B3; <code>c</code>&#xFF0C;&#x4F46;&#x4ED6;&#x5BE6;&#x969B;&#x4E0A;&#x662F;&#x63A5;&#x53D7; <code>a</code> &#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; <code>b -&gt; c</code> &#x7684;&#x51FD;&#x6578;&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; <code>(f x) y</code> &#x7684;&#x65B9;&#x5F0F;&#x547C;&#x53EB; <code>f x y</code>&#x3002;&#x9019;&#x500B;&#x6A5F;&#x5236;&#x8B93;&#x6211;&#x5011;&#x53EF;&#x4EE5; partially apply &#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6BD4;&#x8F03;&#x5C11;&#x7684;&#x53C3;&#x6578;&#x547C;&#x53EB;&#x4ED6;&#x5011;&#x3002;&#x53EF;&#x4EE5;&#x505A;&#x6210;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x518D;&#x9935;&#x7D66;&#x5176;&#x4ED6;&#x51FD;&#x6578;&#x3002;</p>
<p>&#x5230;&#x76EE;&#x524D;&#x70BA;&#x6B62;&#xFF0C;&#x7576;&#x6211;&#x5011;&#x8981;&#x5C0D; functor map over &#x4E00;&#x500B;&#x51FD;&#x6578;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x7528;&#x7684;&#x51FD;&#x6578;&#x90FD;&#x662F;&#x53EA;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x7684;&#x3002;&#x4F46;&#x5982;&#x679C;&#x6211;&#x5011;&#x8981; map &#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#x5462;&#xFF1F;&#x6211;&#x5011;&#x4F86;&#x770B;&#x5E7E;&#x500B;&#x5177;&#x9AD4;&#x7684;&#x4F8B;&#x5B50;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x6709; <code>Just 3</code> &#x7136;&#x5F8C;&#x6211;&#x5011;&#x505A; <code>fmap (*) (Just 3)</code>&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x6703;&#x7372;&#x5F97;&#x4EC0;&#x9EBC;&#x6A23;&#x7684;&#x7D50;&#x679C;&#xFF1F;&#x5F9E; <code>Maybe</code> &#x5C0D; <code>Functor</code> &#x7684; instance &#x5BE6;&#x4F5C;&#x4F86;&#x770B;&#xFF0C;&#x6211;&#x5011;&#x77E5;&#x9053;&#x5982;&#x679C;&#x4ED6;&#x662F; <code>Just something</code>&#xFF0C;&#x4ED6;&#x6703;&#x5C0D;&#x5728; <code>Just</code> &#x4E2D;&#x7684; <code>something</code> &#x505A;&#x6620;&#x5C04;&#x3002;&#x56E0;&#x6B64;&#x7576; <code>fmap (*) (Just 3)</code> &#x6703;&#x5F97;&#x5230; <code>Just ((*) 3)</code>&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5BEB;&#x505A; <code>Just (* 3)</code>&#x3002;&#x6211;&#x5011;&#x5F97;&#x5230;&#x4E86;&#x4E00;&#x500B;&#x5305;&#x5728; <code>Just</code> &#x4E2D;&#x7684;&#x51FD;&#x6578;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; :t fmap (++) (<span class="hljs-type">Just</span> <span class="hljs-string">&quot;hey&quot;</span>)  
<span class="hljs-title">fmap</span> (++) (<span class="hljs-type">Just</span> <span class="hljs-string">&quot;hey&quot;</span>) :: <span class="hljs-type">Maybe</span> ([<span class="hljs-type">Char</span>] -&gt; [<span class="hljs-type">Char</span>])  
<span class="hljs-title">ghci</span>&gt; :t fmap compare (<span class="hljs-type">Just</span> &apos;a&apos;)  
<span class="hljs-title">fmap</span> compare (<span class="hljs-type">Just</span> &apos;a&apos;) :: <span class="hljs-type">Maybe</span> (<span class="hljs-type">Char</span> -&gt; <span class="hljs-type">Ordering</span>)  
<span class="hljs-title">ghci</span>&gt; :t fmap compare <span class="hljs-string">&quot;A LIST OF CHARS&quot;</span>  
<span class="hljs-title">fmap</span> compare <span class="hljs-string">&quot;A LIST OF CHARS&quot;</span> :: [<span class="hljs-type">Char</span> -&gt; <span class="hljs-type">Ordering</span>]  
<span class="hljs-title">ghci</span>&gt; :t fmap (\x y z -&gt; x + y / z) [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]  
<span class="hljs-title">fmap</span> (\x y z -&gt; x + y / z) [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>] :: (<span class="hljs-type">Fractional</span> a) =&gt; [a -&gt; a -&gt; a]
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x5011; map <code>compare</code> &#x5230;&#x4E00;&#x500B;&#x5305;&#x542B;&#x8A31;&#x591A;&#x5B57;&#x5143;&#x7684; list &#x5462;&#xFF1F;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x662F; <code>(Ord a) =&gt; a -&gt; a -&gt; Ordering</code>&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5F97;&#x5230;&#x5305;&#x542B;&#x8A31;&#x591A; <code>Char -&gt; Ordering</code> &#x578B;&#x5225;&#x51FD;&#x6578;&#x7684; list&#xFF0C;&#x56E0;&#x70BA; <code>compare</code> &#x88AB; partially apply &#x5230; list &#x4E2D;&#x7684;&#x5B57;&#x5143;&#x3002;&#x4ED6;&#x4E0D;&#x662F;&#x5305;&#x542B;&#x8A31;&#x591A; <code>(Ord a) =&gt; a -&gt; Ordering</code> &#x7684;&#x51FD;&#x6578;&#xFF0C;&#x56E0;&#x70BA;&#x7B2C;&#x4E00;&#x500B; <code>a</code> &#x78B0;&#x5230;&#x7684;&#x578B;&#x5225;&#x662F; <code>Char</code>&#xFF0C;&#x6240;&#x4EE5;&#x7B2C;&#x4E8C;&#x500B; <code>a</code> &#x4E5F;&#x5FC5;&#x9808;&#x662F; <code>Char</code>&#x3002;</p>
<p>&#x6211;&#x5011;&#x770B;&#x5230;&#x5982;&#x4F55;&#x7528;&#x4E00;&#x500B;&#x591A;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#x4F86; map functor&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5F97;&#x5230;&#x4E00;&#x500B;&#x5305;&#x542B;&#x4E86;&#x51FD;&#x6578;&#x7684; functor&#x3002;&#x90A3;&#x73FE;&#x5728;&#x6211;&#x5011;&#x80FD;&#x5C0D;&#x9019;&#x500B;&#x5305;&#x542B;&#x4E86;&#x51FD;&#x6578;&#x7684; functor &#x505A;&#x4EC0;&#x9EBC;&#x5462;&#xFF1F;&#x6211;&#x5011;&#x80FD;&#x7528;&#x4E00;&#x500B;&#x5403;&#x9019;&#x4E9B;&#x51FD;&#x6578;&#x7684;&#x51FD;&#x6578;&#x4F86; map over &#x9019;&#x500B; functor&#xFF0C;&#x9019;&#x4E9B;&#x5728; functor &#x4E2D;&#x7684;&#x51FD;&#x6578;&#x90FD;&#x6703;&#x88AB;&#x7576;&#x4F5C;&#x53C3;&#x6578;&#x4E1F;&#x7D66;&#x6211;&#x5011;&#x7684;&#x51FD;&#x6578;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-keyword">let</span> a = fmap (*) [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]  
<span class="hljs-title">ghci</span>&gt; :t a  
<span class="hljs-title">a</span> :: [<span class="hljs-type">Integer</span> -&gt; <span class="hljs-type">Integer</span>]  
<span class="hljs-title">ghci</span>&gt; fmap (\f -&gt; f <span class="hljs-number">9</span>) a  
[<span class="hljs-number">9</span>,<span class="hljs-number">18</span>,<span class="hljs-number">27</span>,<span class="hljs-number">36</span>]
</code></pre>
<p>&#x4F46;&#x5982;&#x679C;&#x6211;&#x5011;&#x7684;&#x6709;&#x4E00;&#x500B; functor &#x88E1;&#x9762;&#x662F; <code>Just (3 *)</code> &#x9084;&#x6709;&#x53E6;&#x4E00;&#x500B; functor &#x88E1;&#x9762;&#x662F; <code>Just 5</code>&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x60F3;&#x8981;&#x628A;&#x7B2C;&#x4E00;&#x500B; <code>Just (3 *)</code> map over <code>Just 5</code> &#x5462;&#xFF1F;&#x5982;&#x679C;&#x662F;&#x666E;&#x901A;&#x7684; functor&#xFF0C;&#x90A3;&#x5C31;&#x6C92;&#x6551;&#x4E86;&#x3002;&#x56E0;&#x70BA;&#x4ED6;&#x5011;&#x53EA;&#x5141;&#x8A31; map &#x4E00;&#x500B;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6578;&#x3002;&#x5373;&#x4F7F;&#x6211;&#x5011;&#x7528; <code>\f -&gt; f 9</code> &#x4F86; map &#x4E00;&#x500B;&#x88DD;&#x4E86;&#x5F88;&#x591A;&#x51FD;&#x6578;&#x7684; functor&#xFF0C;&#x6211;&#x5011;&#x4E5F;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6578;&#x3002;&#x6211;&#x5011;&#x662F;&#x7121;&#x6CD5;&#x55AE;&#x7D14;&#x7528; <code>fmap</code> &#x4F86;&#x628A;&#x5305;&#x5728;&#x4E00;&#x500B; functor &#x7684;&#x51FD;&#x6578; map &#x53E6;&#x4E00;&#x500B;&#x5305;&#x5728; functor &#x4E2D;&#x7684;&#x503C;&#x3002;&#x6211;&#x5011;&#x80FD;&#x7528;&#x6A21;&#x5F0F;&#x5339;&#x914D; <code>Just</code> &#x4F86;&#x628A;&#x51FD;&#x6578;&#x5F9E;&#x88E1;&#x9762;&#x62BD;&#x51FA;&#x4F86;&#xFF0C;&#x7136;&#x5F8C;&#x518D; map <code>Just 5</code>&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x662F;&#x5E0C;&#x671B;&#x6709;&#x4E00;&#x500B;&#x4E00;&#x822C;&#x5316;&#x7684;&#x4F5C;&#x6CD5;&#xFF0C;&#x5C0D;&#x4EFB;&#x4F55; functor &#x90FD;&#x6709;&#x6548;&#x3002;</p>
<p>&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B; <code>Applicative</code> &#x9019;&#x500B; typeclass&#x3002;&#x4ED6;&#x4F4D;&#x5728; <code>Control.Applicative</code> &#x4E2D;&#xFF0C;&#x5728;&#x5176;&#x4E2D;&#x5B9A;&#x7FA9;&#x4E86;&#x5169;&#x500B;&#x51FD;&#x6578; <code>pure</code> &#x8DDF; <code>&lt;*&gt;</code>&#x3002;&#x4ED6;&#x4E26;&#x6C92;&#x6709;&#x63D0;&#x4F9B;&#x9810;&#x8A2D;&#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x5011;&#x60F3;&#x4F7F;&#x7528;&#x4ED6;&#x5FC5;&#x9808;&#x8981;&#x70BA;&#x4ED6;&#x5011; applicative functor &#x7684;&#x5BE6;&#x4F5C;&#x3002;typeclass &#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">class</span> (<span class="hljs-type">Functor</span> <span class="hljs-title">f</span>) =&gt; <span class="hljs-type">Applicative</span> f <span class="hljs-keyword">where</span></span>  
    pure :: a -&gt; f a  
    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
<p>&#x9019;&#x7C21;&#x7C21;&#x55AE;&#x55AE;&#x7684;&#x4E09;&#x884C;&#x53EF;&#x4EE5;&#x8B93;&#x6211;&#x5011;&#x5B78;&#x5230;&#x4E0D;&#x5C11;&#x3002;&#x9996;&#x5148;&#x4F86;&#x770B;&#x7B2C;&#x4E00;&#x884C;&#x3002;&#x4ED6;&#x958B;&#x555F;&#x4E86; <code>Applicative</code> &#x7684;&#x5B9A;&#x7FA9;&#xFF0C;&#x4E26;&#x52A0;&#x4E0A; class contraint&#x3002;&#x63CF;&#x8FF0;&#x4E86;&#x4E00;&#x500B;&#x578B;&#x5225;&#x69CB;&#x9020;&#x5B50;&#x8981;&#x662F; <code>Applicative</code>&#xFF0C;&#x4ED6;&#x5FC5;&#x9808;&#x4E5F;&#x662F; <code>Functor</code>&#x3002;&#x9019;&#x5C31;&#x662F;&#x70BA;&#x4EC0;&#x9EBC;&#x6211;&#x5011;&#x8AAA;&#x4E00;&#x500B;&#x578B;&#x5225;&#x69CB;&#x9020;&#x5B50;&#x5C6C;&#x65BC; <code>Applicative</code> &#x7684;&#x8A71;&#xFF0C;&#x4ED6;&#x4E5F;&#x6703;&#x662F; <code>Functor</code>&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x5011;&#x80FD;&#x5C0D;&#x4ED6;&#x4F7F;&#x7528; <code>fmap</code>&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x500B;&#x5B9A;&#x7FA9;&#x7684;&#x662F; <code>pure</code>&#x3002;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x5BA3;&#x544A;&#x662F; <code>pure :: a -&gt; f a</code>&#x3002;<code>f</code> &#x4EE3;&#x8868; applicative functor &#x7684; instance&#x3002;&#x7531;&#x65BC; Haskell &#x6709;&#x4E00;&#x500B;&#x512A;&#x79C0;&#x7684;&#x578B;&#x5225;&#x7CFB;&#x7D71;&#xFF0C;&#x5176;&#x4E2D;&#x51FD;&#x6578;&#x53C8;&#x662F;&#x5C07;&#x4E00;&#x4E9B;&#x53C3;&#x6578;&#x6620;&#x5C04;&#x6210;&#x7D50;&#x679C;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5F9E;&#x578B;&#x5225;&#x5BA3;&#x544A;&#x4E2D;&#x8B80;&#x51FA;&#x8A31;&#x591A;&#x8A0A;&#x606F;&#x3002;<code>pure</code> &#x61C9;&#x8A72;&#x8981;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x7136;&#x5F8C;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x5305;&#x542B;&#x90A3;&#x500B;&#x503C;&#x7684; applicative functor&#x3002;&#x6211;&#x5011;&#x9019;&#x908A;&#x662F;&#x7528;&#x76D2;&#x5B50;&#x4F86;&#x4F5C;&#x6BD4;&#x55BB;&#xFF0C;&#x5373;&#x4F7F;&#x6709;&#x4E00;&#x4E9B;&#x6BD4;&#x55BB;&#x4E0D;&#x5B8C;&#x5168;&#x7B26;&#x5408;&#x73FE;&#x5BE6;&#x7684;&#x60C5;&#x6CC1;&#x3002;&#x5118;&#x7BA1;&#x9019;&#x6A23;&#xFF0C;<code>a -&gt; f a</code> &#x4ECD;&#x6709;&#x8A31;&#x591A;&#x8C50;&#x5BCC;&#x7684;&#x8CC7;&#x8A0A;&#xFF0C;&#x4ED6;&#x78BA;&#x5BE6;&#x544A;&#x8A34;&#x6211;&#x5011;&#x4ED6;&#x6703;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x503C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; applicative functor&#xFF0C;&#x88E1;&#x9762;&#x88DD;&#x6709;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x5C0D;&#x65BC; <code>pure</code> &#x6BD4;&#x8F03;&#x597D;&#x7684;&#x8AAA;&#x6CD5;&#x662F;&#x628A;&#x4E00;&#x500B;&#x666E;&#x901A;&#x503C;&#x653E;&#x5230;&#x4E00;&#x500B;&#x9810;&#x8A2D;&#x7684; context &#x4E0B;&#xFF0C;&#x4E00;&#x500B;&#x6700;&#x5C0F;&#x7684; context &#x4F46;&#x4ECD;&#x7136;&#x5305;&#x542B;&#x9019;&#x500B;&#x503C;&#x3002;</p>
<p><code>&lt;*&gt;</code> &#x4E5F;&#x975E;&#x5E38;&#x6709;&#x8DA3;&#x3002;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x662F; <code>f (a -&gt; b) -&gt; f a -&gt; f b</code>&#x3002;&#x9019;&#x6709;&#x8B93;&#x4F60;&#x806F;&#x60F3;&#x5230;&#x4EC0;&#x9EBC;&#x55CE;&#xFF1F;&#x6C92;&#x932F;&#xFF01;&#x5C31;&#x662F; <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>&#x3002;&#x4ED6;&#x6709;&#x9EDE;&#x50CF;&#x52A0;&#x5F37;&#x7248;&#x7684; <code>fmap</code>&#x3002;&#x7136;&#x800C; <code>fmap</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x8DDF;&#x4E00;&#x500B; functor&#xFF0C;&#x7136;&#x5F8C;&#x5957;&#x7528; functor &#x4E4B;&#x4E2D;&#x7684;&#x51FD;&#x6578;&#x3002;<code>&lt;*&gt;</code> &#x5247;&#x662F;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x88DD;&#x6709;&#x51FD;&#x6578;&#x7684; functor &#x8DDF;&#x53E6;&#x4E00;&#x500B; functor&#xFF0C;&#x7136;&#x5F8C;&#x53D6;&#x51FA;&#x7B2C;&#x4E00;&#x500B; functor &#x4E2D;&#x7684;&#x51FD;&#x6578;&#x5C07;&#x4ED6;&#x5C0D;&#x7B2C;&#x4E8C;&#x500B; functor &#x4E2D;&#x7684;&#x503C;&#x505A; map&#x3002;</p>
<p>&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B; <code>Maybe</code> &#x7684; <code>Applicative</code> &#x5BE6;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Applicative</span> <span class="hljs-type">Maybe</span> <span class="hljs-keyword">where</span></span>  
    pure = <span class="hljs-type">Just</span>  
    <span class="hljs-type">Nothing</span> &lt;*&gt; _ = <span class="hljs-type">Nothing</span>  
    (<span class="hljs-type">Just</span> f) &lt;*&gt; something = fmap f something
</code></pre>
<p>&#x5F9E; class &#x7684;&#x5B9A;&#x7FA9;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x770B;&#x5230; <code>f</code> &#x4F5C;&#x70BA; applicative functor &#x6703;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5177;&#x9AD4;&#x578B;&#x5225;&#x7576;&#x4F5C;&#x53C3;&#x6578;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x662F;&#x5BEB;&#x6210; <code>instance Applicative Maybe where</code> &#x800C;&#x4E0D;&#x662F;&#x5BEB;&#x6210; <code>instance Applicative (Maybe a) where</code>&#x3002;</p>
<p>&#x9996;&#x5148;&#x770B;&#x5230; <code>pure</code>&#x3002;&#x4ED6;&#x53EA;&#x4E0D;&#x904E;&#x662F;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x6771;&#x897F;&#x7136;&#x5F8C;&#x5305;&#x6210; applicative functor&#x3002;&#x6211;&#x5011;&#x5BEB;&#x6210; <code>pure = Just</code> &#x662F;&#x56E0;&#x70BA; <code>Just</code> &#x4E0D;&#x904E;&#x5C31;&#x662F;&#x4E00;&#x500B;&#x666E;&#x901A;&#x51FD;&#x6578;&#x3002;&#x6211;&#x5011;&#x5176;&#x5BE6;&#x4E5F;&#x53EF;&#x4EE5;&#x5BEB;&#x6210; <code>pure x = Just x</code>&#x3002;</p>
<p>&#x63A5;&#x8457;&#x6211;&#x5011;&#x5B9A;&#x7FA9;&#x4E86; <code>&lt;*&gt;</code>&#x3002;&#x6211;&#x5011;&#x7121;&#x6CD5;&#x5F9E; <code>Nothing</code> &#x4E2D;&#x62BD;&#x51FA;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x56E0;&#x70BA; <code>Nothing</code> &#x4E26;&#x4E0D;&#x5305;&#x542B;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x8AAA;&#x5982;&#x679C;&#x6211;&#x5011;&#x8981;&#x5617;&#x8A66;&#x5F9E; <code>Nothing</code> &#x4E2D;&#x53D6;&#x51FA;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x7D50;&#x679C;&#x5FC5;&#x5B9A;&#x662F; <code>Nothing</code>&#x3002;&#x5982;&#x679C;&#x4F60;&#x770B;&#x770B; <code>Applicative</code> &#x7684;&#x5B9A;&#x7FA9;&#xFF0C;&#x4F60;&#x6703;&#x770B;&#x5230;&#x4ED6;&#x6709; <code>Functor</code> &#x7684;&#x9650;&#x5236;&#xFF0C;&#x4ED6;&#x4EE3;&#x8868; <code>&lt;*&gt;</code> &#x7684;&#x5169;&#x500B;&#x53C3;&#x6578;&#x90FD;&#x6703;&#x662F; functors&#x3002;&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x4E0D;&#x662F; <code>Nothing</code>&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x500B;&#x88DD;&#x4E86;&#x51FD;&#x6578;&#x7684; <code>Just</code>&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x5011;&#x5E0C;&#x671B;&#x5C07;&#x9019;&#x500B;&#x51FD;&#x6578;&#x5C0D;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x505A; map&#x3002;&#x9019;&#x500B;&#x4E5F;&#x8003;&#x616E;&#x5230;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x662F; <code>Nothing</code> &#x7684;&#x60C5;&#x6CC1;&#xFF0C;&#x56E0;&#x70BA; <code>fmap</code> &#x4EFB;&#x4F55;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x81F3; <code>Nothing</code> &#x6703;&#x56DE;&#x50B3; <code>Nothing</code>&#x3002;</p>
<p>&#x5C0D;&#x65BC; <code>Maybe</code> &#x800C;&#x8A00;&#xFF0C;&#x5982;&#x679C;&#x5DE6;&#x908A;&#x662F; <code>Just</code>&#xFF0C;&#x90A3; <code>&lt;*&gt;</code> &#x6703;&#x5F9E;&#x5176;&#x4E2D;&#x62BD;&#x51FA;&#x4E86;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x4F86; map &#x53F3;&#x908A;&#x7684;&#x503C;&#x3002;&#x5982;&#x679C;&#x6709;&#x4EFB;&#x4F55;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F; <code>Nothing</code>&#x3002;&#x90A3;&#x7D50;&#x679C;&#x4FBF;&#x662F; <code>Nothing</code>&#x3002;</p>
<p>&#x4F86;&#x8A66;&#x8A66;&#x770B;&#x5427;&#xFF01;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">Just</span> (+<span class="hljs-number">3</span>) &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">9</span>  
<span class="hljs-type">Just</span> <span class="hljs-number">12</span>  
<span class="hljs-title">ghci</span>&gt; pure (+<span class="hljs-number">3</span>) &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">10</span>  
<span class="hljs-type">Just</span> <span class="hljs-number">13</span>  
<span class="hljs-title">ghci</span>&gt; pure (+<span class="hljs-number">3</span>) &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">9</span>  
<span class="hljs-type">Just</span> <span class="hljs-number">12</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">Just</span> (++<span class="hljs-string">&quot;hahah&quot;</span>) &lt;*&gt; <span class="hljs-type">Nothing</span>  
<span class="hljs-type">Nothing</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">Nothing</span> &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-string">&quot;woot&quot;</span>  
<span class="hljs-type">Nothing</span>
</code></pre>
<p>&#x6211;&#x5011;&#x770B;&#x5230; <code>pure (+3)</code> &#x8DDF; <code>Just (+3)</code> &#x5728;&#x9019;&#x500B; case &#x4E0B;&#x662F;&#x4E00;&#x6A23;&#x7684;&#x3002;&#x5982;&#x679C;&#x4F60;&#x662F;&#x5728; applicative context &#x5E95;&#x4E0B;&#x8DDF; <code>Maybe</code> &#x6253;&#x4EA4;&#x9053;&#x7684;&#x8A71;&#x8ACB;&#x7528; <code>pure</code>&#xFF0C;&#x8981;&#x4E0D;&#x7136;&#x5C31;&#x7528; <code>Just</code>&#x3002;&#x524D;&#x56DB;&#x500B;&#x8F38;&#x5165;&#x5C55;&#x793A;&#x4E86;&#x51FD;&#x6578;&#x662F;&#x5982;&#x4F55;&#x88AB;&#x53D6;&#x51FA;&#x4E26;&#x505A; map &#x7684;&#x52D5;&#x4F5C;&#xFF0C;&#x4F46;&#x5728;&#x9019;&#x500B; case &#x5E95;&#x4E0B;&#xFF0C;&#x4ED6;&#x5011;&#x540C;&#x6A23;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; unwrap &#x51FD;&#x6578;&#x4F86; map over functors&#x3002;&#x6700;&#x5F8C;&#x4E00;&#x884C;&#x6BD4;&#x8F03;&#x6709;&#x8DA3;&#xFF0C;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x8A66;&#x8457;&#x5F9E; <code>Nothing</code> &#x53D6;&#x51FA;&#x51FD;&#x6578;&#x4E26;&#x5C07;&#x4ED6; map &#x5230;&#x67D0;&#x500B;&#x503C;&#x3002;&#x7D50;&#x679C;&#x7576;&#x7136;&#x662F; <code>Nothing</code>&#x3002;</p>
<p>&#x5C0D;&#x65BC;&#x666E;&#x901A;&#x7684; functors&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x500B;&#x51FD;&#x6578; map over &#x4E00;&#x500B; functors&#xFF0C;&#x4F46;&#x4F60;&#x53EF;&#x80FD;&#x6C92;&#x8FA6;&#x6CD5;&#x62FF;&#x5230;&#x7D50;&#x679C;&#x3002;&#x800C; applicative functors &#x5247;&#x8B93;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x55AE;&#x4E00;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x64CD;&#x4F5C;&#x597D;&#x5E7E;&#x500B; functors&#x3002;&#x770B;&#x770B;&#x4E0B;&#x9762;&#x4E00;&#x6BB5;&#x7A0B;&#x5F0F;&#x78BC;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; pure (+) &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">3</span> &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">5</span>  
<span class="hljs-type">Just</span> <span class="hljs-number">8</span>  
<span class="hljs-title">ghci</span>&gt; pure (+) &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">3</span> &lt;*&gt; <span class="hljs-type">Nothing</span>  
<span class="hljs-type">Nothing</span>  
<span class="hljs-title">ghci</span>&gt; pure (+) &lt;*&gt; <span class="hljs-type">Nothing</span> &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-number">5</span>  
<span class="hljs-type">Nothing</span>
</code></pre>
<p><img src="img/whale.png" alt=""></p>
<p>&#x7A76;&#x7ADF;&#x6211;&#x5011;&#x5BEB;&#x4E86;&#x4E9B;&#x4EC0;&#x9EBD;&#xFF1F;&#x6211;&#x5011;&#x4F86;&#x4E00;&#x6B65;&#x6B65;&#x770B;&#x4E00;&#x4E0B;&#x3002;<code>&lt;*&gt;</code> &#x662F; left-associative&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8AAA; <code>pure (+) &lt;*&gt; Just 3 &lt;*&gt; Just 5</code> &#x53EF;&#x4EE5;&#x5BEB;&#x6210; <code>(pure (+) &lt;*&gt; Just 3) &lt;*&gt; Just 5</code>&#x3002;&#x9996;&#x5148; <code>+</code> &#x662F;&#x64FA;&#x5728;&#x4E00;&#x500B; functor &#x4E2D;&#xFF0C;&#x5728;&#x9019;&#x908A;&#x525B;&#x597D;&#x4ED6;&#x662F;&#x4E00;&#x500B; <code>Maybe</code>&#x3002;&#x6240;&#x4EE5;&#x9996;&#x5148;&#xFF0C;&#x6211;&#x5011;&#x6709; <code>pure (+)</code>&#xFF0C;&#x4ED6;&#x7B49;&#x50F9;&#x65BC; <code>Just (+)</code>&#x3002;&#x63A5;&#x4E0B;&#x4F86;&#x7531;&#x65BC; partial application &#x7684;&#x95DC;&#x4FC2;&#xFF0C;<code>Just (+) &lt;*&gt; Just 3</code> &#x7B49;&#x50F9;&#x65BC; <code>Just (3+)</code>&#x3002;&#x628A;&#x4E00;&#x500B; <code>3</code> &#x9935;&#x7D66; <code>+</code> &#x5F62;&#x6210;&#x53E6;&#x4E00;&#x500B;&#x53EA;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x7684;&#x6548;&#x679C;&#x7B49;&#x65BC;&#x52A0;&#x4E0A; 3&#x3002;&#x6700;&#x5F8C; <code>Just (3+) &lt;*&gt; Just 5</code> &#x88AB;&#x904B;&#x7B97;&#xFF0C;&#x5176;&#x7D50;&#x679C;&#x662F; <code>Just 8</code>&#x3002;</p>
<p>&#x9019;&#x6A23;&#x5F88;&#x68D2;&#x5427;&#xFF01;&#x7528; applicative style &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x4F7F;&#x7528; applicative functors&#x3002;&#x50CF;&#x662F; <code>pure f &lt;*&gt; x &lt;*&gt; y &lt;*&gt; ...</code> &#x5C31;&#x8B93;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x62FF;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x591A;&#x500B;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x800C;&#x4E14;&#x9019;&#x4E9B;&#x53C3;&#x6578;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x88AB;&#x5305;&#x5728; functor &#x4E2D;&#x3002;&#x5C31;&#x9019;&#x6A23;&#x4F86;&#x5957;&#x7528;&#x5728;&#x591A;&#x500B;&#x5728; functor context &#x7684;&#x503C;&#x3002;&#x9019;&#x500B;&#x51FD;&#x6578;&#x53EF;&#x4EE5;&#x5403;&#x4EFB;&#x610F;&#x591A;&#x7684;&#x53C3;&#x6578;&#xFF0C;&#x7562;&#x7ADF; <code>&lt;*&gt;</code> &#x53EA;&#x662F;&#x505A; partial application &#x800C;&#x5DF2;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x8003;&#x616E;&#x5230; <code>pure f &lt;*&gt; x</code> &#x7B49;&#x65BC; <code>fmap f x</code> &#x7684;&#x8A71;&#xFF0C;&#x9019;&#x6A23;&#x7684;&#x7528;&#x6CD5;&#x5C31;&#x66F4;&#x65B9;&#x4FBF;&#x4E86;&#x3002;&#x9019;&#x662F; applicative laws &#x7684;&#x5176;&#x4E2D;&#x4E00;&#x689D;&#x3002;&#x6211;&#x5011;&#x7A0D;&#x5F8C;&#x6703;&#x66F4;&#x4ED4;&#x7D30;&#x5730;&#x6AA2;&#x8996;&#x9019;&#x689D;&#x5B9A;&#x5F8B;&#x3002;&#x73FE;&#x5728;&#x6211;&#x5011;&#x5148;&#x4F9D;&#x76F4;&#x89BA;&#x4F86;&#x4F7F;&#x7528;&#x4ED6;&#x3002;&#x5C31;&#x50CF;&#x6211;&#x5011;&#x5148;&#x524D;&#x6240;&#x8AAA;&#x7684;&#xFF0C;<code>pure</code> &#x628A;&#x4E00;&#x500B;&#x503C;&#x653E;&#x9032;&#x4E00;&#x500B;&#x9810;&#x8A2D;&#x7684; context &#x4E2D;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x8981;&#x628A;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x653E;&#x5728;&#x4E00;&#x500B;&#x9810;&#x8A2D;&#x7684; context&#xFF0C;&#x7136;&#x5F8C;&#x628A;&#x4ED6;&#x53D6;&#x51FA;&#x4E26;&#x5957;&#x7528;&#x5728;&#x653E;&#x5728;&#x53E6;&#x4E00;&#x500B; applicative functor &#x7684;&#x503C;&#x3002;&#x6211;&#x5011;&#x6703;&#x505A;&#x7684;&#x4E8B;&#x5C31;&#x662F;&#x628A;&#x51FD;&#x6578; map over &#x90A3;&#x500B; applicative functor&#x3002;&#x4F46;&#x6211;&#x5011;&#x4E0D;&#x6703;&#x5BEB;&#x6210; <code>pure f &lt;*&gt; x &lt;*&gt; y &lt;*&gt; ...</code>&#xFF0C;&#x800C;&#x662F;&#x5BEB;&#x6210; <code>fmap f x &lt;*&gt; y &lt;*&gt; ...</code>&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBD; <code>Control.Applicative</code> &#x6703; export &#x4E00;&#x500B;&#x51FD;&#x6578; <code>&lt;$&gt;</code>&#xFF0C;&#x4ED6;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;&#x4E2D;&#x7DB4;&#x7248;&#x7684; <code>fmap</code>&#x3002;&#x4ED6;&#x662F;&#x9019;&#x9EBC;&#x88AB;&#x5B9A;&#x7FA9;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell">(&lt;$&gt;) :: (<span class="hljs-type">Functor</span> f) =&gt; (a -&gt; b) -&gt; f a -&gt; f b  
<span class="hljs-title">f</span> &lt;$&gt; x = fmap f x
</code></pre>
<pre><code class="lang-text">&#x8981;&#x8A18;&#x4F4F;&#x578B;&#x5225;&#x8B8A;&#x6578;&#x8DDF;&#x53C3;&#x6578;&#x7684;&#x540D;&#x5B57;&#x9084;&#x6709;&#x503C;&#x7D81;&#x5B9A;&#x7684;&#x540D;&#x7A31;&#x4E0D;&#x885D;&#x7A81;&#x3002;``f`` &#x5728;&#x51FD;&#x6578;&#x7684;&#x578B;&#x5225;&#x5BA3;&#x544A;&#x4E2D;&#x662F;&#x578B;&#x5225;&#x8B8A;&#x6578;&#xFF0C;&#x8AAA;&#x660E; ``f`` &#x61C9;&#x8A72;&#x8981;&#x6EFF;&#x8DB3; ``Functor`` typeclass &#x7684;&#x689D;&#x4EF6;&#x3002;&#x800C;&#x5728;&#x51FD;&#x6578;&#x672C;&#x9AD4;&#x4E2D;&#x7684; ``f`` &#x5247;&#x8868;&#x793A;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x6211;&#x5011;&#x5C07;&#x4ED6; map over x&#x3002;&#x6211;&#x5011;&#x540C;&#x6A23;&#x7528; ``f`` &#x4F86;&#x8868;&#x793A;&#x4ED6;&#x5011;&#x4E26;&#x4EE3;&#x8868;&#x4ED6;&#x5011;&#x662F;&#x76F8;&#x540C;&#x7684;&#x6771;&#x897F;&#x3002;
</code></pre>
<p><code>&lt;$&gt;</code> &#x7684;&#x4F7F;&#x7528;&#x986F;&#x793A;&#x4E86; applicative style &#x7684;&#x597D;&#x8655;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x5C07; <code>f</code> &#x5957;&#x7528;&#x4E09;&#x500B; applicative functor&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5BEB;&#x6210; <code>f &lt;$&gt; x &lt;*&gt; y &lt;*&gt; z</code>&#x3002;&#x5982;&#x679C;&#x53C3;&#x6578;&#x4E0D;&#x662F; applicative functor &#x800C;&#x662F;&#x666E;&#x901A;&#x503C;&#x7684;&#x8A71;&#x3002;&#x6211;&#x5011;&#x5247;&#x5BEB;&#x6210; <code>f x y z</code>&#x3002;</p>
<p>&#x6211;&#x5011;&#x518D;&#x4ED4;&#x7D30;&#x770B;&#x770B;&#x4ED6;&#x662F;&#x5982;&#x4F55;&#x904B;&#x4F5C;&#x7684;&#x3002;&#x6211;&#x5011;&#x6709;&#x4E00;&#x500B; <code>Just &quot;johntra&quot;</code> &#x8DDF; <code>Just &quot;volta&quot;</code> &#x9019;&#x6A23;&#x7684;&#x503C;&#xFF0C;&#x6211;&#x5011;&#x5E0C;&#x671B;&#x5C07;&#x4ED6;&#x5011;&#x7D50;&#x5408;&#x6210;&#x4E00;&#x500B; <code>String</code>&#xFF0C;&#x4E26;&#x4E14;&#x5305;&#x542B;&#x5728; <code>Maybe</code> &#x4E2D;&#x3002;&#x6211;&#x5011;&#x6703;&#x9019;&#x6A23;&#x505A;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (++) &lt;$&gt; <span class="hljs-type">Just</span> <span class="hljs-string">&quot;johntra&quot;</span> &lt;*&gt; <span class="hljs-type">Just</span> <span class="hljs-string">&quot;volta&quot;</span>  
<span class="hljs-type">Just</span> <span class="hljs-string">&quot;johntravolta&quot;</span>
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5C07;&#x4E0A;&#x9762;&#x7684;&#x8DDF;&#x4E0B;&#x9762;&#x9019;&#x884C;&#x6BD4;&#x8F03;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (++) <span class="hljs-string">&quot;johntra&quot;</span> <span class="hljs-string">&quot;volta&quot;</span>  
<span class="hljs-string">&quot;johntravolta&quot;</span>
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5C07;&#x4E00;&#x500B;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6578;&#x5957;&#x7528;&#x5728; applicative functor &#x4E0A;&#x771F;&#x4E0D;&#x932F;&#x3002;&#x53EA;&#x8981;&#x7A0D;&#x5FAE;&#x5BEB;&#x4E00;&#x4E9B; <code>&lt;$&gt;</code> &#x8DDF; <code>&lt;*&gt;</code> &#x5C31;&#x53EF;&#x4EE5;&#x628A;&#x51FD;&#x6578;&#x8B8A;&#x6210; applicative style&#xFF0C;&#x53EF;&#x4EE5;&#x64CD;&#x4F5C; applicatives &#x4E26;&#x56DE;&#x50B3; applicatives&#x3002;</p>
<p>&#x7E3D;&#x4E4B;&#x7576;&#x6211;&#x5011;&#x5728;&#x505A; <code>(++) &lt;$&gt; Just &quot;johntra&quot; &lt;*&gt; Just &quot;volta&quot;</code> &#x6642;&#xFF0C;&#x9996;&#x5148;&#x6211;&#x5011;&#x5C07; <code>(++)</code> map over &#x5230; <code>Just &quot;johntra&quot;</code>&#xFF0C;&#x7136;&#x5F8C;&#x7522;&#x751F; <code>Just (&quot;johntra&quot;++)</code>&#xFF0C;&#x5176;&#x4E2D; <code>(++)</code> &#x7684;&#x578B;&#x5225;&#x70BA; <code>(++) :: [a] -&gt; [a] -&gt; [a]</code>&#xFF0C;<code>Just (&quot;johntra&quot;++)</code> &#x7684;&#x578B;&#x5225;&#x70BA; <code>Maybe ([Char] -&gt; [Char])</code>&#x3002;&#x6CE8;&#x610F;&#x5230; <code>(++)</code> &#x662F;&#x5982;&#x4F55;&#x5403;&#x6389;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#xFF0C;&#x4EE5;&#x53CA;&#x6211;&#x5011;&#x662F;&#x600E;&#x9EBC;&#x6C7A;&#x5B9A; <code>a</code> &#x662F; <code>Char</code> &#x7684;&#x3002;&#x7576;&#x6211;&#x5011;&#x505A; <code>Just (&quot;johntra&quot;++) &lt;*&gt; Just &quot;volta&quot;</code>&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5305;&#x5728; <code>Just</code> &#x4E2D;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x7136;&#x5F8C; map over <code>Just &quot;volta&quot;</code>&#xFF0C;&#x7522;&#x751F;&#x4E86; <code>Just &quot;johntravolta&quot;</code>&#x3002;&#x5982;&#x679C;&#x5169;&#x500B;&#x503C;&#x4E2D;&#x6709;&#x4EFB;&#x610F;&#x4E00;&#x500B;&#x70BA; <code>Nothing</code>&#xFF0C;&#x90A3;&#x6574;&#x500B;&#x7D50;&#x679C;&#x5C31;&#x6703;&#x662F; <code>Nothing</code>&#x3002;</p>
<p>&#x5230;&#x76EE;&#x524D;&#x70BA;&#x6B62;&#x6211;&#x5011;&#x53EA;&#x6709;&#x7528; <code>Maybe</code> &#x7576;&#x4F5C;&#x6211;&#x5011;&#x7684;&#x6848;&#x4F8B;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4E5F;&#x6703;&#x60F3;&#x8AAA; applicative functor &#x5DEE;&#x4E0D;&#x591A;&#x5C31;&#x7B49;&#x65BC; <code>Maybe</code>&#x3002;&#x4E0D;&#x904E;&#x5176;&#x5BE6;&#x6709;&#x8A31;&#x591A;&#x5176;&#x4ED6; <code>Applicative</code> &#x7684; instance&#x3002;&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B;&#x6709;&#x54EA;&#x4E9B;&#x3002;</p>
<p>List &#x4E5F;&#x662F; applicative functor&#x3002;&#x5F88;&#x9A5A;&#x8A1D;&#x55CE;&#xFF1F;&#x4F86;&#x770B;&#x770B;&#x6211;&#x5011;&#x662F;&#x600E;&#x9EBC;&#x5B9A;&#x7FA9; <code>[]</code> &#x70BA; <code>Applicative</code> &#x7684; instance &#x7684;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Applicative</span> [] <span class="hljs-keyword">where</span></span>  
    pure x = [x]  
    fs &lt;*&gt; xs = [f x | f &lt;- fs, x &lt;- xs]
</code></pre>
<p>&#x65E9;&#x5148;&#x6211;&#x5011;&#x8AAA;&#x904E; <code>pure</code> &#x662F;&#x628A;&#x4E00;&#x500B;&#x503C;&#x653E;&#x9032;&#x9810;&#x8A2D;&#x7684; context &#x4E2D;&#x3002;&#x63DB;&#x7A2E;&#x8AAA;&#x6CD5;&#x5C31;&#x662F;&#x4E00;&#x500B;&#x6703;&#x7522;&#x751F;&#x90A3;&#x500B;&#x503C;&#x7684;&#x6700;&#x5C0F; context&#x3002;&#x800C;&#x5C0D; list &#x800C;&#x8A00;&#x6700;&#x5C0F; context &#x5C31;&#x662F; <code>[]</code>&#xFF0C;&#x4F46;&#x7531;&#x65BC;&#x7A7A;&#x7684; list &#x4E26;&#x4E0D;&#x5305;&#x542B;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x6C92;&#x8FA6;&#x6CD5;&#x628A;&#x4ED6;&#x7576;&#x4F5C; <code>pure</code>&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC; <code>pure</code> &#x5176;&#x5BE6;&#x662F;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x503C;&#x7136;&#x5F8C;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x5305;&#x542B;&#x55AE;&#x5143;&#x7D20;&#x7684; list&#x3002;&#x540C;&#x6A23;&#x7684;&#xFF0C;<code>Maybe</code> &#x7684;&#x6700;&#x5C0F; context &#x662F; <code>Nothing</code>&#xFF0C;&#x4F46;&#x4ED6;&#x5176;&#x5BE6;&#x8868;&#x793A;&#x7684;&#x662F;&#x6C92;&#x6709;&#x503C;&#x3002;&#x6240;&#x4EE5; <code>pure</code> &#x5176;&#x5BE6;&#x662F;&#x88AB;&#x5BE6;&#x4F5C;&#x6210; <code>Just</code> &#x7684;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; pure <span class="hljs-string">&quot;Hey&quot;</span> :: [<span class="hljs-type">String</span>]  
[<span class="hljs-string">&quot;Hey&quot;</span>]  
<span class="hljs-title">ghci</span>&gt; pure <span class="hljs-string">&quot;Hey&quot;</span> :: <span class="hljs-type">Maybe</span> <span class="hljs-type">String</span>  
<span class="hljs-type">Just</span> <span class="hljs-string">&quot;Hey&quot;</span>
</code></pre>
<p>&#x81F3;&#x65BC; <code>&lt;*&gt;</code> &#x5462;&#xFF1F;&#x5982;&#x679C;&#x6211;&#x5011;&#x5047;&#x5B9A; <code>&lt;*&gt;</code> &#x7684;&#x578B;&#x5225;&#x662F;&#x9650;&#x5236;&#x5728; list &#x4E0A;&#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5F97;&#x5230; <code>(&lt;*&gt;) :: [a -&gt; b] -&gt; [a] -&gt; [b]</code>&#x3002;&#x4ED6;&#x662F;&#x7528; list comprehension &#x4F86;&#x5BE6;&#x4F5C;&#x7684;&#x3002;<code>&lt;*&gt;</code> &#x5FC5;&#x9808;&#x8981;&#x5F9E;&#x5DE6;&#x908A;&#x7684;&#x53C3;&#x6578;&#x53D6;&#x51FA;&#x51FD;&#x6578;&#xFF0C;&#x5C07;&#x4ED6; map over &#x53F3;&#x908A;&#x7684;&#x53C3;&#x6578;&#x3002;&#x4F46;&#x5DE6;&#x908A;&#x7684; list &#x6709;&#x53EF;&#x80FD;&#x4E0D;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x51FD;&#x6578;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x751A;&#x81F3;&#x662F;&#x591A;&#x500B;&#x51FD;&#x6578;&#x3002;&#x800C;&#x53F3;&#x908A;&#x7684; list &#x6709;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x591A;&#x500B;&#x503C;&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC;&#x6211;&#x5011;&#x7528; list comprehension &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x5F9E;&#x5169;&#x500B; list &#x53D6;&#x503C;&#x3002;&#x6211;&#x5011;&#x8981;&#x5C0D;&#x5DE6;&#x53F3;&#x4EFB;&#x610F;&#x7684;&#x7D44;&#x5408;&#x90FD;&#x505A;&#x5957;&#x7528;&#x7684;&#x52D5;&#x4F5C;&#x3002;&#x800C;&#x5F97;&#x5230;&#x7684;&#x7D50;&#x679C;&#x5C31;&#x6703;&#x662F;&#x5DE6;&#x53F3;&#x5169;&#x8005;&#x4EFB;&#x610F;&#x7D44;&#x5408;&#x7684;&#x7D50;&#x679C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; [(*<span class="hljs-number">0</span>),(+<span class="hljs-number">100</span>),(^<span class="hljs-number">2</span>)] &lt;*&gt; [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">101</span>,<span class="hljs-number">102</span>,<span class="hljs-number">103</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>]
</code></pre>
<p>&#x5DE6;&#x908A;&#x7684; list &#x5305;&#x542B;&#x4E09;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x800C;&#x53F3;&#x908A;&#x7684; list &#x6709;&#x4E09;&#x500B;&#x503C;&#x3002;&#x6240;&#x4EE5;&#x7D50;&#x679C;&#x6703;&#x662F;&#x6709;&#x4E5D;&#x500B;&#x5143;&#x7D20;&#x7684; list&#x3002;&#x5728;&#x5DE6;&#x908A; list &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x90FD;&#x88AB;&#x5957;&#x7528;&#x5230;&#x53F3;&#x908A;&#x7684;&#x503C;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x4ECA;&#x5929;&#x5728; list &#x4E2D;&#x7684;&#x51FD;&#x6578;&#x662F;&#x63A5;&#x6536;&#x5169;&#x500B;&#x53C3;&#x6578;&#x7684;&#xFF0C;&#x6211;&#x5011;&#x4E5F;&#x53EF;&#x4EE5;&#x5957;&#x7528;&#x5230;&#x5169;&#x500B; list &#x4E0A;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; [(+),(*)] &lt;*&gt; [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>] &lt;*&gt; [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]  
[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>]
</code></pre>
<p>&#x7531;&#x65BC; <code>&lt;*&gt;</code> &#x662F; left-associative&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8AAA; <code>[(+),(*)] &lt;*&gt; [1,2]</code> &#x6703;&#x5148;&#x904B;&#x4F5C;&#xFF0C;&#x7522;&#x751F; <code>[(1+),(2+),(1*),(2*)]</code>&#x3002;&#x7531;&#x65BC;&#x5DE6;&#x908A;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x90FD;&#x5957;&#x7528;&#x81F3;&#x53F3;&#x908A;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#x3002;&#x4E5F;&#x5C31;&#x7522;&#x751F; <code>[(1+),(2+),(1*),(2*)] &lt;*&gt; [3,4]</code>&#xFF0C;&#x5176;&#x4FBF;&#x662F;&#x6700;&#x7D42;&#x7D50;&#x679C;&#x3002;</p>
<p>list &#x7684; applicative style &#x662F;&#x76F8;&#x7576;&#x6709;&#x8DA3;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (++) &lt;$&gt; [<span class="hljs-string">&quot;ha&quot;</span>,<span class="hljs-string">&quot;heh&quot;</span>,<span class="hljs-string">&quot;hmm&quot;</span>] &lt;*&gt; [<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;!&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>]  
[<span class="hljs-string">&quot;ha?&quot;</span>,<span class="hljs-string">&quot;ha!&quot;</span>,<span class="hljs-string">&quot;ha.&quot;</span>,<span class="hljs-string">&quot;heh?&quot;</span>,<span class="hljs-string">&quot;heh!&quot;</span>,<span class="hljs-string">&quot;heh.&quot;</span>,<span class="hljs-string">&quot;hmm?&quot;</span>,<span class="hljs-string">&quot;hmm!&quot;</span>,<span class="hljs-string">&quot;hmm.&quot;</span>]
</code></pre>
<p>&#x770B;&#x770B;&#x6211;&#x5011;&#x662F;&#x5982;&#x4F55;&#x5C07;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x5B57;&#x4E32;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#x5957;&#x7528;&#x5230;&#x5169;&#x500B; applicative functor &#x4E0A;&#x7684;&#xFF0C;&#x53EA;&#x8981;&#x7528;&#x9069;&#x7576;&#x7684; applicative &#x904B;&#x7B97;&#x5B50;&#x5C31;&#x53EF;&#x4EE5;&#x9054;&#x6210;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5C07; list &#x770B;&#x4F5C;&#x662F;&#x4E00;&#x500B; non-deterministic &#x7684;&#x8A08;&#x7B97;&#x3002;&#x800C;&#x5C0D;&#x65BC;&#x50CF; <code>100</code> &#x6216;&#x662F; <code>&quot;what&quot;</code> &#x9019;&#x6A23;&#x7684;&#x503C;&#x5247;&#x662F; deterministic &#x7684;&#x8A08;&#x7B97;&#xFF0C;&#x53EA;&#x6703;&#x6709;&#x4E00;&#x500B;&#x7D50;&#x679C;&#x3002;&#x800C; <code>[1,2,3]</code> &#x5247;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;&#x6C92;&#x6709;&#x78BA;&#x5B9A;&#x7A76;&#x7ADF;&#x662F;&#x54EA;&#x4E00;&#x7A2E;&#x7D50;&#x679C;&#x3002;&#x6240;&#x4EE5;&#x4ED6;&#x4EE3;&#x8868;&#x7684;&#x662F;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x7684;&#x7D50;&#x679C;&#x3002;&#x7576;&#x4F60;&#x5728;&#x505A; <code>(+) &lt;$&gt; [1,2,3] &lt;*&gt; [4,5,6]</code>&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x60F3;&#x505A;&#x662F;&#x628A;&#x5169;&#x500B; non-deterministic &#x7684;&#x8A08;&#x7B97;&#x505A; <code>+</code>&#xFF0C;&#x53EA;&#x662F;&#x4ED6;&#x6703;&#x7522;&#x751F;&#x53E6;&#x4E00;&#x500B; non-deterministic &#x7684;&#x8A08;&#x7B97;&#xFF0C;&#x800C;&#x4E14;&#x7D50;&#x679C;&#x66F4;&#x52A0;&#x4E0D;&#x78BA;&#x5B9A;&#x3002;</p>
<p>Applicative style &#x5C0D;&#x65BC; list &#x800C;&#x8A00;&#x662F;&#x4E00;&#x500B;&#x53D6;&#x4EE3; list comprehension &#x7684;&#x597D;&#x65B9;&#x5F0F;&#x3002;&#x5728;&#x7B2C;&#x4E8C;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x770B;&#x5230; <code>[2,5,10]</code> &#x8DDF; <code>[8,10,11]</code> &#x76F8;&#x4E58;&#x7684;&#x7D50;&#x679C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x9019;&#x6A23;&#x505A;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; [ x*y | x &lt;- [<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>], y &lt;- [<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>]]     
[<span class="hljs-number">16</span>,<span class="hljs-number">20</span>,<span class="hljs-number">22</span>,<span class="hljs-number">40</span>,<span class="hljs-number">50</span>,<span class="hljs-number">55</span>,<span class="hljs-number">80</span>,<span class="hljs-number">100</span>,<span class="hljs-number">110</span>]
</code></pre>
<p>&#x6211;&#x5011;&#x53EA;&#x662F;&#x5F9E;&#x5169;&#x500B; list &#x4E2D;&#x53D6;&#x51FA;&#x5143;&#x7D20;&#xFF0C;&#x4E26;&#x5C07;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x5728;&#x4EFB;&#x4F55;&#x5143;&#x7D20;&#x7684;&#x7D44;&#x5408;&#x4E0A;&#x3002;&#x9019;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; applicative style &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x5BEB;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (*) &lt;$&gt; [<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>] &lt;*&gt; [<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>]  
[<span class="hljs-number">16</span>,<span class="hljs-number">20</span>,<span class="hljs-number">22</span>,<span class="hljs-number">40</span>,<span class="hljs-number">50</span>,<span class="hljs-number">55</span>,<span class="hljs-number">80</span>,<span class="hljs-number">100</span>,<span class="hljs-number">110</span>]
</code></pre>
<p>&#x9019;&#x5BEB;&#x6CD5;&#x5C0D;&#x6211;&#x4F86;&#x8AAA;&#x6BD4;&#x8F03;&#x6E05;&#x695A;&#x3002;&#x53EF;&#x4EE5;&#x6E05;&#x695A;&#x8868;&#x9054;&#x6211;&#x5011;&#x662F;&#x8981;&#x5C0D;&#x5169;&#x500B; non-deterministic &#x7684;&#x8A08;&#x7B97;&#x505A; <code>*</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x6240;&#x6709;&#x76F8;&#x4E58;&#x5927;&#x65BC; 50 &#x53EF;&#x80FD;&#x7684;&#x8A08;&#x7B97;&#x7D50;&#x679C;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x9019;&#x6A23;&#x5BEB;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; filter (&gt;<span class="hljs-number">50</span>) $ (*) &lt;$&gt; [<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>] &lt;*&gt; [<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>]  
[<span class="hljs-number">55</span>,<span class="hljs-number">80</span>,<span class="hljs-number">100</span>,<span class="hljs-number">110</span>]
</code></pre>
<p>&#x5F88;&#x5BB9;&#x6613;&#x770B;&#x5230; <code>pure f &lt;*&gt; xs</code> &#x7B49;&#x50F9;&#x65BC; <code>fmap f xs</code>&#x3002;&#x800C; <code>pure f</code> &#x5C31;&#x662F; <code>[f]</code>&#xFF0C;&#x800C;&#x4E14; <code>[f] &lt;*&gt; xs</code> &#x53EF;&#x5C07;&#x5DE6;&#x908A;&#x7684;&#x6BCF;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x53F3;&#x908A;&#x7684;&#x6BCF;&#x500B;&#x503C;&#x3002;&#x4F46;&#x5DE6;&#x908A;&#x5176;&#x5BE6;&#x53EA;&#x6709;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x6240;&#x4EE5;&#x4ED6;&#x505A;&#x8D77;&#x4F86;&#x5C31;&#x50CF;&#x662F; mapping&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x500B;&#x6211;&#x5011;&#x5DF2;&#x7D93;&#x770B;&#x904E;&#x7684; <code>Applicative</code> &#x7684; instance &#x662F; <code>IO</code>&#xFF0C;&#x4F86;&#x770B;&#x770B;&#x4ED6;&#x662F;&#x600E;&#x9EBC;&#x5BE6;&#x4F5C;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Applicative</span> <span class="hljs-type">IO</span> <span class="hljs-keyword">where</span></span>  
    pure = return  
    a &lt;*&gt; b = <span class="hljs-keyword">do</span>  
        f &lt;- a  
        x &lt;- b  
        return (f x)
</code></pre>
<p><img src="img/knight.png" alt=""></p>
<p>&#x7531;&#x65BC; <code>pure</code> &#x662F;&#x628A;&#x4E00;&#x500B;&#x503C;&#x653E;&#x9032;&#x6700;&#x5C0F;&#x7684; context &#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x5C07; <code>return</code> &#x5B9A;&#x7FA9;&#x6210; <code>pure</code> &#x662F;&#x5F88;&#x5408;&#x7406;&#x7684;&#x3002;&#x56E0;&#x70BA; <code>return</code> &#x4E5F;&#x662F;&#x505A;&#x540C;&#x6A23;&#x7684;&#x4E8B;&#x60C5;&#x3002;&#x4ED6;&#x505A;&#x4E86;&#x4E00;&#x500B;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5;&#x7684; I/O action&#xFF0C;&#x4ED6;&#x53EF;&#x4EE5;&#x7522;&#x751F;&#x67D0;&#x4E9B;&#x503C;&#x4F86;&#x4F5C;&#x70BA;&#x7D50;&#x679C;&#xFF0C;&#x4F46;&#x4ED6;&#x5BE6;&#x969B;&#x4E0A;&#x4E26;&#x6C92;&#x6709;&#x505A;&#x4EFB;&#x4F55; I/O &#x7684;&#x52D5;&#x4F5C;&#xFF0C;&#x4F8B;&#x5982;&#x8AAA;&#x5370;&#x51FA;&#x7D50;&#x679C;&#x5230;&#x7D42;&#x7AEF;&#x6216;&#x662F;&#x6A94;&#x6848;&#x3002;</p>
<p>&#x5982;&#x679C; <code>&lt;*&gt;</code> &#x88AB;&#x9650;&#x5B9A;&#x5728; <code>IO</code> &#x4E0A;&#x64CD;&#x4F5C;&#x7684;&#x8A71;&#xFF0C;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x6703;&#x662F; <code>(&lt;*&gt;) :: IO (a -&gt; b) -&gt; IO a -&gt; IO b</code>&#x3002;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x7522;&#x751F;&#x51FD;&#x6578;&#x7684; I/O action&#xFF0C;&#x9084;&#x6709;&#x53E6;&#x4E00;&#x500B; I/O action&#xFF0C;&#x4E26;&#x5F9E;&#x4EE5;&#x4E0A;&#x5169;&#x8005;&#x5275;&#x9020;&#x4E00;&#x500B;&#x65B0;&#x7684; I/O action&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x628A;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x9935;&#x7D66;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x3002;&#x800C;&#x5F97;&#x5230;&#x56DE;&#x50B3;&#x7684;&#x7D50;&#x679C;&#xFF0C;&#x7136;&#x5F8C;&#x653E;&#x5230;&#x65B0;&#x7684; I/O action &#x4E2D;&#x3002;&#x6211;&#x5011;&#x7528; do &#x7684;&#x8A9E;&#x6CD5;&#x4F86;&#x5BE6;&#x4F5C;&#x4ED6;&#x3002;&#x4F60;&#x9084;&#x8A18;&#x5F97;&#x7684;&#x8A71; do &#x5C31;&#x662F;&#x628A;&#x597D;&#x5E7E;&#x500B; I/O action &#x9ECF;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x8B8A;&#x6210;&#x4E00;&#x500B;&#x5927;&#x7684; I/O action&#x3002;</p>
<p>&#x800C;&#x5C0D;&#x65BC; <code>Maybe</code> &#x8DDF; <code>[]</code> &#x800C;&#x8A00;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x628A; <code>&lt;*&gt;</code> &#x60F3;&#x505A;&#x662F;&#x5F9E;&#x5DE6;&#x908A;&#x7684;&#x53C3;&#x6578;&#x53D6;&#x51FA;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x7136;&#x5F8C;&#x5957;&#x7528;&#x5230;&#x53F3;&#x908A;&#x7684;&#x53C3;&#x6578;&#x4E0A;&#x3002;&#x81F3;&#x65BC; <code>IO</code>&#xFF0C;&#x9019;&#x7A2E;&#x53D6;&#x51FA;&#x7684;&#x985E;&#x6BD4;&#x65B9;&#x5F0F;&#x4ECD;&#x7136;&#x9069;&#x7528;&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x591A;&#x52A0;&#x4E00;&#x500B; sequencing &#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x662F;&#x5F9E;&#x5169;&#x500B; I/O action &#x4E2D;&#x53D6;&#x503C;&#xFF0C;&#x4E5F;&#x662F;&#x5728; sequencing&#xFF0C;&#x628A;&#x4ED6;&#x5011;&#x9ECF;&#x6210;&#x4E00;&#x500B;&#x3002;&#x6211;&#x5011;&#x5F9E;&#x7B2C;&#x4E00;&#x500B; I/O action &#x4E2D;&#x53D6;&#x503C;&#xFF0C;&#x4F46;&#x8981;&#x53D6;&#x51FA; I/O action &#x7684;&#x7D50;&#x679C;&#xFF0C;&#x4ED6;&#x5FC5;&#x9808;&#x8981;&#x5148;&#x88AB;&#x57F7;&#x884C;&#x904E;&#x3002;</p>
<p>&#x8003;&#x616E;&#x4E0B;&#x9762;&#x9019;&#x500B;&#x7BC4;&#x4F8B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">myAction</span> :: <span class="hljs-type">IO</span> <span class="hljs-type">String</span>  
<span class="hljs-title">myAction</span> = <span class="hljs-keyword">do</span>  
    a &lt;- getLine  
    b &lt;- getLine  
    return $ a ++ b
</code></pre>
<p>&#x9019;&#x662F;&#x4E00;&#x500B;&#x63D0;&#x793A;&#x4F7F;&#x7528;&#x8005;&#x8F38;&#x5165;&#x5169;&#x884C;&#x4E26;&#x7522;&#x751F;&#x5C07;&#x5169;&#x884C;&#x8F38;&#x5165;&#x4E32;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x7D50;&#x679C;&#x7684;&#x4E00;&#x500B; I/O action&#x3002;&#x6211;&#x5011;&#x5148;&#x628A;&#x5169;&#x500B; <code>getLine</code> &#x9ECF;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x7136;&#x5F8C;&#x7528;&#x4E00;&#x500B; <code>return</code>&#xFF0C;&#x9019;&#x662F;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x60F3;&#x8981;&#x9019;&#x500B;&#x9ECF;&#x6210;&#x7684; I/O action &#x5305;&#x542B; <code>a ++ b</code> &#x7684;&#x7D50;&#x679C;&#x3002;&#x6211;&#x5011;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; applicative style &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x63CF;&#x8FF0;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">myAction</span> :: <span class="hljs-type">IO</span> <span class="hljs-type">String</span>  
<span class="hljs-title">myAction</span> = (++) &lt;$&gt; getLine &lt;*&gt; getLine
</code></pre>
<p>&#x6211;&#x5011;&#x5148;&#x524D;&#x7684;&#x4F5C;&#x6CD5;&#x662F;&#x5C07;&#x5169;&#x500B; I/O action &#x7684;&#x7D50;&#x679C;&#x9935;&#x7D66;&#x51FD;&#x6578;&#x3002;&#x9084;&#x8A18;&#x5F97; <code>getLine</code> &#x7684;&#x578B;&#x5225;&#x662F; <code>getLine :: IO String</code>&#x3002;&#x7576;&#x6211;&#x5011;&#x5C0D; applicative functor &#x4F7F;&#x7528; <code>&lt;*&gt;</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x7D50;&#x679C;&#x4E5F;&#x6703;&#x662F; applicative functor&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x518D;&#x4F7F;&#x7528;&#x76D2;&#x5B50;&#x7684;&#x985E;&#x6BD4;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x628A; <code>getLine</code> &#x60F3;&#x505A;&#x662F;&#x4E00;&#x500B;&#x53BB;&#x771F;&#x5BE6;&#x4E16;&#x754C;&#x4E2D;&#x62FF;&#x53D6;&#x5B57;&#x4E32;&#x7684;&#x76D2;&#x5B50;&#x3002;&#x800C; <code>(++) &lt;$&gt; getLine &lt;*&gt; getLine</code> &#x6703;&#x5275;&#x9020;&#x4E00;&#x500B;&#x6BD4;&#x8F03;&#x5927;&#x7684;&#x76D2;&#x5B50;&#xFF0C;&#x9019;&#x500B;&#x5927;&#x76D2;&#x5B50;&#x6703;&#x6D3E;&#x5169;&#x500B;&#x76D2;&#x5B50;&#x53BB;&#x7D42;&#x7AEF;&#x62FF;&#x53D6;&#x5B57;&#x4E32;&#xFF0C;&#x4E26;&#x628A;&#x7D50;&#x679C;&#x4E32;&#x63A5;&#x8D77;&#x4F86;&#x653E;&#x9032;&#x81EA;&#x5DF1;&#x7684;&#x76D2;&#x5B50;&#x4E2D;&#x3002;</p>
<p><code>(++) &lt;$&gt; getLine &lt;*&gt; getLine</code> &#x7684;&#x578B;&#x5225;&#x662F; <code>IO String</code>&#xFF0C;&#x4ED6;&#x4EE3;&#x8868;&#x9019;&#x500B;&#x8868;&#x9054;&#x5F0F;&#x5F0F;&#x4E00;&#x500B;&#x518D;&#x666E;&#x901A;&#x4E0D;&#x904E;&#x7684; I/O action&#xFF0C;&#x4ED6;&#x88E1;&#x9762;&#x4E5F;&#x88DD;&#x8457;&#x67D0;&#x7A2E;&#x503C;&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x9019;&#x6A23;&#x5BEB;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">main</span> = <span class="hljs-keyword">do</span>  
    a &lt;- (++) &lt;$&gt; getLine &lt;*&gt; getLine  
    putStrLn $ <span class="hljs-string">&quot;The two lines concatenated turn out to be: &quot;</span> ++ a
</code></pre>
<p>&#x5982;&#x679C;&#x4F60;&#x767C;&#x73FE;&#x4F60;&#x662F;&#x5728;&#x505A; binding I/O action &#x7684;&#x52D5;&#x4F5C;&#xFF0C;&#x800C;&#x4E14;&#x5728; binding &#x4E4B;&#x5F8C;&#x9084;&#x547C;&#x53EB;&#x4E00;&#x4E9B;&#x51FD;&#x6578;&#xFF0C;&#x6700;&#x5F8C;&#x7528; <code>return</code> &#x4F86;&#x5C07;&#x7D50;&#x679C;&#x5305;&#x8D77;&#x4F86;&#x3002; &#x90A3;&#x4F60;&#x53EF;&#x4EE5;&#x8003;&#x616E;&#x4F7F;&#x7528; applicative style&#xFF0C;&#x9019;&#x6A23;&#x53EF;&#x4EE5;&#x66F4;&#x7C21;&#x6F54;&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x500B; <code>Applicative</code> &#x7684; instance &#x662F; <code>(-&gt;) r</code>&#x3002;&#x96D6;&#x7136;&#x4ED6;&#x5011;&#x901A;&#x5E38;&#x662F;&#x7528;&#x5728; code golf &#x7684;&#x60C5;&#x6CC1;&#xFF0C;&#x4F46;&#x4ED6;&#x5011;&#x9084;&#x662F;&#x5341;&#x5206;&#x6709;&#x8DA3;&#x7684;&#x4F8B;&#x5B50;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x9084;&#x662F;&#x4F86;&#x770B;&#x4E00;&#x4E0B;&#x4ED6;&#x5011;&#x662F;&#x600E;&#x9EBC;&#x88AB;&#x5BE6;&#x4F5C;&#x7684;&#x3002;</p>
<pre><code class="lang-text">&#x5982;&#x679C;&#x4F60;&#x5FD8;&#x8A18; ``(-&gt;) r`` &#x7684;&#x610F;&#x601D;&#xFF0C;&#x56DE;&#x53BB;&#x7FFB;&#x7FFB;&#x524D;&#x4E00;&#x7AE0;&#x7BC0;&#x6211;&#x5011;&#x4ECB;&#x7D39; ``(-&gt;) r`` &#x4F5C;&#x70BA;&#x4E00;&#x500B; functor &#x7684;&#x7BC4;&#x4F8B;&#x3002;
</code></pre>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Applicative</span> ((-&gt;) r) <span class="hljs-keyword">where</span></span>  
    pure x = (\_ -&gt; x)  
    f &lt;*&gt; g = \x -&gt; f x (g x)
</code></pre>
<p>&#x7576;&#x6211;&#x5011;&#x7528; <code>pure</code> &#x5C07;&#x4E00;&#x500B;&#x503C;&#x5305;&#x6210; applicative functor &#x7684;&#x6642;&#x5019;&#xFF0C;&#x4ED6;&#x7522;&#x751F;&#x7684;&#x7D50;&#x679C;&#x6C38;&#x9060;&#x90FD;&#x6703;&#x662F;&#x90A3;&#x500B;&#x503C;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x6700;&#x5C0F;&#x7684; context&#x3002;&#x90A3;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBC;&#x5C0D;&#x65BC; function &#x7684; <code>pure</code> &#x5BE6;&#x4F5C;&#x4F86;&#x8B1B;&#xFF0C;&#x4ED6;&#x5C31;&#x662F;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x7136;&#x5F8C;&#x9020;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x6C38;&#x9060;&#x56DE;&#x50B3;&#x90A3;&#x500B;&#x503C;&#xFF0C;&#x4E0D;&#x7BA1;&#x4ED6;&#x88AB;&#x9935;&#x4E86;&#x4EC0;&#x9EBC;&#x53C3;&#x6578;&#x3002;&#x5982;&#x679C;&#x4F60;&#x9650;&#x5B9A; <code>pure</code> &#x7684;&#x578B;&#x5225;&#x81F3; <code>(-&gt;) r</code> &#x4E0A;&#xFF0C;&#x4ED6;&#x5C31;&#x6703;&#x662F; <code>pure :: a -&gt; (r -&gt; a)</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (pure <span class="hljs-number">3</span>) <span class="hljs-string">&quot;blah&quot;</span>  
<span class="hljs-number">3</span>
</code></pre>
<p>&#x7531;&#x65BC; currying &#x7684;&#x95DC;&#x4FC2;&#xFF0C;&#x51FD;&#x6578;&#x5957;&#x7528;&#x662F; left-associative&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5FFD;&#x7565;&#x6389;&#x62EC;&#x5F27;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; pure <span class="hljs-number">3</span> <span class="hljs-string">&quot;blah&quot;</span>  
<span class="hljs-number">3</span>
</code></pre>
<p>&#x800C; <code>&lt;*&gt;</code> &#x7684;&#x5BE6;&#x4F5C;&#x662F;&#x6BD4;&#x8F03;&#x4E0D;&#x5BB9;&#x6613;&#x77AD;&#x89E3;&#x7684;&#xFF0C;&#x6211;&#x5011;&#x6700;&#x597D;&#x770B;&#x4E00;&#x4E0B;&#x600E;&#x9EBC;&#x7528; applicative style &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x4F7F;&#x7528;&#x4F5C;&#x70BA; applicative functor &#x7684; function&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; :t (+) &lt;$&gt; (+<span class="hljs-number">3</span>) &lt;*&gt; (*<span class="hljs-number">100</span>)  
(+) &lt;$&gt; (+<span class="hljs-number">3</span>) &lt;*&gt; (*<span class="hljs-number">100</span>) :: (<span class="hljs-type">Num</span> a) =&gt; a -&gt; a  
<span class="hljs-title">ghci</span>&gt; (+) &lt;$&gt; (+<span class="hljs-number">3</span>) &lt;*&gt; (*<span class="hljs-number">100</span>) $ <span class="hljs-number">5</span>  
<span class="hljs-number">508</span>
</code></pre>
<p>&#x5C07;&#x5169;&#x500B; applicative functor &#x9935;&#x7D66; <code>&lt;*&gt;</code> &#x53EF;&#x4EE5;&#x7522;&#x751F;&#x4E00;&#x500B;&#x65B0;&#x7684; applicative functor&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6211;&#x5011;&#x4E1F;&#x7D66;&#x4ED6;&#x5169;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x6211;&#x5011;&#x80FD;&#x5F97;&#x5230;&#x4E00;&#x500B;&#x65B0;&#x7684;&#x51FD;&#x6578;&#x3002;&#x6240;&#x4EE5;&#x662F;&#x600E;&#x9EBC;&#x4E00;&#x56DE;&#x4E8B;&#x5462;&#xFF1F;&#x7576;&#x6211;&#x5011;&#x505A; <code>(+) &lt;$&gt; (+3) &lt;*&gt; (*100)</code>&#xFF0C;&#x6211;&#x5011;&#x662F;&#x5728;&#x5BE6;&#x4F5C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x6703;&#x5C07; <code>(+3)</code> &#x8DDF; <code>(*100)</code> &#x7684;&#x7D50;&#x679C;&#x518D;&#x5957;&#x7528; <code>+</code>&#x3002;&#x8981;&#x770B;&#x4E00;&#x500B;&#x5BE6;&#x969B;&#x7684;&#x7BC4;&#x4F8B;&#x7684;&#x8A71;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x4E0B; <code>(+) &lt;$&gt; (+3) &lt;*&gt; (*100) $ 5</code> &#x9996;&#x5148; <code>5</code> &#x88AB;&#x4E1F;&#x7D66; <code>(+3)</code> &#x8DDF; <code>(*100)</code>&#xFF0C;&#x7522;&#x751F; <code>8</code> &#x8DDF; <code>500</code>&#x3002;&#x7136;&#x5F8C; <code>+</code> &#x88AB;&#x5957;&#x7528;&#x5230; <code>8</code> &#x8DDF; <code>500</code>&#xFF0C;&#x5F97;&#x5230; <code>508</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (\x y z -&gt; [x,y,z]) &lt;$&gt; (+<span class="hljs-number">3</span>) &lt;*&gt; (*<span class="hljs-number">2</span>) &lt;*&gt; (/<span class="hljs-number">2</span>) $ <span class="hljs-number">5</span>  
[<span class="hljs-number">8.0</span>,<span class="hljs-number">10.0</span>,<span class="hljs-number">2.5</span>]
</code></pre>
<p><img src="img/jazzb.png" alt=""></p>
<p>&#x9019;&#x908A;&#x4E5F;&#x4E00;&#x6A23;&#x3002;&#x6211;&#x5011;&#x5275;&#x5EFA;&#x4E86;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x6703;&#x547C;&#x53EB; <code>\x y z -&gt; [x,y,z]</code>&#xFF0C;&#x800C;&#x4E1F;&#x7684;&#x53C3;&#x6578;&#x662F; <code>(+3)</code>, <code>(*2)</code> &#x8DDF; <code>(/2)</code>&#x3002;<code>5</code> &#x88AB;&#x4E1F;&#x7D66;&#x4EE5;&#x4E0A;&#x4E09;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x7136;&#x5F8C;&#x4ED6;&#x5011;&#x7D50;&#x679C;&#x53C8;&#x63A5;&#x5230; <code>\x y z -&gt; [x, y, z]</code>&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5C07;&#x51FD;&#x6578;&#x60F3;&#x505A;&#x662F;&#x88DD;&#x8457;&#x6700;&#x7D42;&#x7D50;&#x679C;&#x7684;&#x76D2;&#x5B50;&#xFF0C;&#x6240;&#x4EE5; <code>k &lt;$&gt; f &lt;*&gt; g</code> &#x6703;&#x88FD;&#x9020;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x6703;&#x5C07; <code>f</code> &#x8DDF; <code>g</code> &#x7684;&#x7D50;&#x679C;&#x4E1F;&#x7D66; <code>k</code>&#x3002;&#x7576;&#x6211;&#x5011;&#x505A; <code>(+) &lt;$&gt; Just 3 &lt;*&gt; Just 5</code>&#xFF0C;&#x6211;&#x5011;&#x662F;&#x7528; <code>+</code> &#x5957;&#x7528;&#x5728;&#x4E00;&#x4E9B;&#x53EF;&#x80FD;&#x6709;&#x6216;&#x53EF;&#x80FD;&#x6C92;&#x6709;&#x7684;&#x503C;&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x7D50;&#x679C;&#x4E5F;&#x6703;&#x662F;&#x53EF;&#x80FD;&#x6709;&#x6216;&#x6C92;&#x6709;&#x3002;&#x7576;&#x6211;&#x5011;&#x505A; <code>(+) &lt;$&gt; (+10) &lt;*&gt; (+5)</code>&#xFF0C;&#x6211;&#x5011;&#x662F;&#x5C07; <code>+</code> &#x5957;&#x7528;&#x5728; <code>(+10)</code> &#x8DDF; <code>(+5)</code> &#x7684;&#x7D50;&#x679C;&#x4E0A;&#xFF0C;&#x800C;&#x7D50;&#x679C;&#x4E5F;&#x6703;&#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x7576;&#x88AB;&#x9935;&#x7D66;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x7684;&#x6642;&#x5019;&#x6703;&#x7522;&#x751F;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x6211;&#x5011;&#x901A;&#x5E38;&#x4E0D;&#x6703;&#x5C07;&#x51FD;&#x6578;&#x7576;&#x4F5C; applicative &#x7528;&#xFF0C;&#x4E0D;&#x904E;&#x4ECD;&#x7136;&#x503C;&#x5F97;&#x7576;&#x4F5C;&#x7DF4;&#x7FD2;&#x3002;&#x5C0D;&#x65BC; <code>(-&gt;) r</code> &#x600E;&#x9EBC;&#x5B9A;&#x7FA9;&#x6210; <code>Applicative</code> &#x7684;&#x4E26;&#x4E0D;&#x662F;&#x771F;&#x7684;&#x90A3;&#x9EBC;&#x91CD;&#x8981;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x662F;&#x5F88;&#x61C2;&#x7684;&#x8A71;&#x4E5F;&#x6C92;&#x95DC;&#x4FC2;&#x3002;&#x9019;&#x53EA;&#x662F;&#x8B93;&#x4F60;&#x7372;&#x5F97;&#x4E00;&#x4E9B;&#x64CD;&#x4F5C;&#x4E0A;&#x7684;&#x76F4;&#x89BA;&#x7F77;&#x4E86;&#x3002;</p>
<p>&#x4E00;&#x500B;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x9084;&#x6C92;&#x78B0;&#x904E;&#x7684; <code>Applicative</code> &#x7684; instance &#x662F; <code>ZipList</code>&#xFF0C;&#x4ED6;&#x662F;&#x5305;&#x542B;&#x5728; <code>Control.Applicative</code> &#x4E2D;&#x3002;</p>
<p>&#x5C0D;&#x65BC; list &#x8981;&#x4F5C;&#x70BA;&#x4E00;&#x500B; applicative functor &#x53EF;&#x4EE5;&#x6709;&#x591A;&#x7A2E;&#x65B9;&#x5F0F;&#x3002;&#x6211;&#x5011;&#x5DF2;&#x7D93;&#x4ECB;&#x7D39;&#x904E;&#x5176;&#x4E2D;&#x4E00;&#x7A2E;&#x3002;&#x5982;&#x679C;&#x5957;&#x7528; <code>&lt;*&gt;</code>&#xFF0C;&#x5DE6;&#x908A;&#x662F;&#x8A31;&#x591A;&#x51FD;&#x6578;&#xFF0C;&#x800C;&#x53F3;&#x908A;&#x662F;&#x8A31;&#x591A;&#x503C;&#xFF0C;&#x90A3;&#x7D50;&#x679C;&#x6703;&#x662F;&#x51FD;&#x6578;&#x5957;&#x7528;&#x5230;&#x503C;&#x7684;&#x6240;&#x6709;&#x7D44;&#x5408;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x505A; <code>[(+3),(*2)] &lt;*&gt; [1,2]</code>&#x3002;&#x90A3; <code>(+3)</code> &#x6703;&#x5148;&#x5957;&#x7528;&#x81F3; <code>1</code> &#x8DDF; <code>2</code>&#x3002;&#x63A5;&#x8457; <code>(*2)</code> &#x5957;&#x7528;&#x81F3; <code>1</code> &#x8DDF; <code>2</code>&#x3002;&#x800C;&#x5F97;&#x5230; <code>[4,5,2,4]</code>&#x3002;</p>
<p>&#x7136;&#x800C; <code>[(+3),(*2)] &lt;*&gt; [1,2]</code> &#x4E5F;&#x53EF;&#x4EE5;&#x9019;&#x6A23;&#x904B;&#x4F5C;:&#x628A;&#x5DE6;&#x908A;&#x7B2C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x53F3;&#x908A;&#x7B2C;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x63A5;&#x8457;&#x5DE6;&#x908A;&#x7B2C;&#x4E8C;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x53F3;&#x908A;&#x7B2C;&#x4E8C;&#x500B;&#x503C;&#xFF0C;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;&#x9019;&#x6A23;&#x5F97;&#x5230;&#x7684;&#x6703;&#x662F; <code>[4,4]</code>&#x3002;&#x6216;&#x662F; <code>[1 + 3, 2 * 2]</code>&#x3002;</p>
<p>&#x7531;&#x65BC;&#x4E00;&#x500B;&#x578B;&#x5225;&#x4E0D;&#x80FD;&#x5C0D;&#x540C;&#x4E00;&#x500B; typeclass &#x5B9A;&#x7FA9;&#x5169;&#x500B; instance&#xFF0C;&#x6240;&#x4EE5;&#x624D;&#x6703;&#x5B9A;&#x7FA9;&#x4E86; <code>ZipList a</code>&#xFF0C;&#x4ED6;&#x53EA;&#x6709;&#x4E00;&#x500B;&#x69CB;&#x9020;&#x5B50; <code>ZipList</code>&#xFF0C;&#x4ED6;&#x53EA;&#x5305;&#x542B;&#x4E00;&#x500B;&#x6B04;&#x4F4D;&#xFF0C;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x662F; list&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Applicative</span> <span class="hljs-type">ZipList</span> <span class="hljs-keyword">where</span></span>  
        pure x = <span class="hljs-type">ZipList</span> (repeat x)  
        <span class="hljs-type">ZipList</span> fs &lt;*&gt; <span class="hljs-type">ZipList</span> xs = <span class="hljs-type">ZipList</span> (zipWith (\f x -&gt; f x) fs xs)
</code></pre>
<p><code>&lt;*&gt;</code> &#x505A;&#x7684;&#x5C31;&#x662F;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x8AAA;&#x7684;&#x3002;&#x4ED6;&#x5C07;&#x7B2C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x7B2C;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x7B2C;&#x4E8C;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x7B2C;&#x4E8C;&#x500B;&#x503C;&#x3002;&#x9019;&#x4E5F;&#x662F; <code>zipWith (\f x -&gt; f x) fs xs</code> &#x505A;&#x7684;&#x4E8B;&#x3002;&#x7531;&#x65BC; <code>zipWith</code> &#x7684;&#x7279;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x7D50;&#x679C;&#x6703;&#x8DDF; list &#x4E2D;&#x6BD4;&#x8F03;&#x77ED;&#x7684;&#x90A3;&#x500B;&#x4E00;&#x6A23;&#x9577;&#x3002;</p>
<p><code>pure</code> &#x4E5F;&#x503C;&#x5F97;&#x6211;&#x5011;&#x8A0E;&#x8AD6;&#x4E00;&#x4E0B;&#x3002;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x628A;&#x4ED6;&#x91CD;&#x8907;&#x5730;&#x653E;&#x9032;&#x4E00;&#x500B; list &#x4E2D;&#x3002;<code>pure &quot;haha&quot;</code> &#x5C31;&#x6703;&#x662F; <code>ZipList ([&quot;haha&quot;,&quot;haha&quot;,&quot;haha&quot;...</code>&#x3002;&#x9019;&#x53EF;&#x80FD;&#x6703;&#x9020;&#x6210;&#x4E9B;&#x6DF7;&#x6DC6;&#xFF0C;&#x7562;&#x7ADF;&#x6211;&#x5011;&#x8AAA;&#x904E; <code>pure</code> &#x662F;&#x628A;&#x4E00;&#x500B;&#x503C;&#x653E;&#x9032;&#x4E00;&#x500B;&#x6700;&#x5C0F;&#x7684; context &#x4E2D;&#x3002;&#x800C;&#x4F60;&#x6703;&#x60F3;&#x8AAA;&#x7121;&#x9650;&#x9577;&#x7684; list &#x4E0D;&#x53EF;&#x80FD;&#x6703;&#x662F;&#x4E00;&#x500B;&#x6700;&#x5C0F;&#x7684; context&#x3002;&#x4F46;&#x5C0D;&#x65BC; zip list &#x4F86;&#x8AAA;&#x9019;&#x662F;&#x5F88;&#x5408;&#x7406;&#x7684;&#xFF0C;&#x56E0;&#x70BA;&#x4ED6;&#x5FC5;&#x9808;&#x5728; list &#x7684;&#x6BCF;&#x500B;&#x4F4D;&#x7F6E;&#x90FD;&#x6709;&#x503C;&#x3002;&#x9019;&#x4E5F;&#x9075;&#x5B88;&#x4E86; <code>pure f &lt;*&gt; xs</code> &#x5FC5;&#x9808;&#x8981;&#x7B49;&#x50F9;&#x65BC; <code>fmap f xs</code> &#x7684;&#x7279;&#x6027;&#x3002;&#x5982;&#x679C; <code>pure 3</code> &#x53EA;&#x662F;&#x56DE;&#x50B3; <code>ZipList [3]</code>&#xFF0C;&#x90A3; <code>pure (*2) &lt;*&gt; ZipList [1,5,10]</code> &#x5C31;&#x53EA;&#x6703;&#x7B97;&#x51FA; <code>ZipList [2]</code>&#xFF0C;&#x56E0;&#x70BA;&#x5169;&#x500B; zip list &#x7B97;&#x51FA;&#x7D50;&#x679C;&#x7684;&#x9577;&#x5EA6;&#x6703;&#x662F;&#x6BD4;&#x8F03;&#x77ED;&#x7684;&#x90A3;&#x500B;&#x7684;&#x9577;&#x5EA6;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011; zip &#x4E00;&#x500B;&#x6709;&#x9650;&#x9577;&#x7684; list &#x4EE5;&#x53CA;&#x4E00;&#x500B;&#x7121;&#x9650;&#x9577;&#x7684; list&#xFF0C;&#x90A3;&#x7D50;&#x679C;&#x7684;&#x9577;&#x6703;&#x662F;&#x6709;&#x9650;&#x9577;&#x7684; list &#x7684;&#x9577;&#x5EA6;&#x3002;</p>
<p>&#x90A3; zip list &#x662F;&#x600E;&#x9EBC;&#x7528; applicative style &#x64CD;&#x4F5C;&#x7684;&#x5462;&#xFF1F;&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B;&#xFF0C;<code>ZipList a</code> &#x578B;&#x5225;&#x4E26;&#x6C92;&#x6709;&#x5B9A;&#x7FA9;&#x6210; <code>Show</code> &#x7684; instance&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x7528; <code>getZipList</code> &#x51FD;&#x6578;&#x4F86;&#x5F9E; zip list &#x53D6;&#x51FA;&#x4E00;&#x500B;&#x666E;&#x901A;&#x7684; list&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getZipList $ (+) &lt;$&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] &lt;*&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">100</span>]  
[<span class="hljs-number">101</span>,<span class="hljs-number">102</span>,<span class="hljs-number">103</span>]  
<span class="hljs-title">ghci</span>&gt; getZipList $ (+) &lt;$&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] &lt;*&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">100</span>,<span class="hljs-number">100.</span>.]  
[<span class="hljs-number">101</span>,<span class="hljs-number">102</span>,<span class="hljs-number">103</span>]  
<span class="hljs-title">ghci</span>&gt; getZipList $ max &lt;$&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>] &lt;*&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]  
[<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]  
<span class="hljs-title">ghci</span>&gt; getZipList $ (,,) &lt;$&gt; <span class="hljs-type">ZipList</span> <span class="hljs-string">&quot;dog&quot;</span> &lt;*&gt; <span class="hljs-type">ZipList</span> <span class="hljs-string">&quot;cat&quot;</span> &lt;*&gt; <span class="hljs-type">ZipList</span> <span class="hljs-string">&quot;rat&quot;</span>  
[(&apos;d&apos;,&apos;c&apos;,&apos;r&apos;),(&apos;o&apos;,&apos;a&apos;,&apos;a&apos;),(&apos;g&apos;,&apos;t&apos;,&apos;t&apos;)]
</code></pre>
<pre><code class="lang-text">``(,,)`` &#x51FD;&#x6578;&#x8DDF; ``\x y z -&gt; (x,y,z)`` &#x662F;&#x7B49;&#x50F9;&#x7684;&#xFF0C;&#x800C; ``(,)`` &#x8DDF; ``\x y -&gt; (x,y)`` &#x662F;&#x7B49;&#x50F9;&#x7684;&#x3002;
</code></pre>
<p>&#x9664;&#x4E86; <code>zipWith</code>&#xFF0C;&#x6A19;&#x6E96;&#x51FD;&#x5F0F;&#x5EAB;&#x4E2D;&#x4E5F;&#x6709; <code>zipWith3</code>, <code>zipWith4</code> &#x4E4B;&#x985E;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x6700;&#x591A;&#x652F;&#x63F4;&#x5230; 7&#x3002;<code>zipWith</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4E26;&#x628A;&#x5169;&#x500B; list zip &#x8D77;&#x4F86;&#x3002;<code>zipWith3</code> &#x5247;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x4E09;&#x500B;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x7136;&#x5F8C;&#x628A;&#x4E09;&#x500B; list zip &#x8D77;&#x4F86;&#x3002;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;&#x7528; applicative style &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x64CD;&#x4F5C; zip list &#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5C0D;&#x6BCF;&#x500B;&#x6578;&#x91CF;&#x7684; list &#x90FD;&#x5B9A;&#x7FA9;&#x4E00;&#x500B;&#x7368;&#x7ACB;&#x7684; zip &#x51FD;&#x6578;&#x4F86; zip &#x4ED6;&#x5011;&#x3002;&#x6211;&#x5011;&#x53EA;&#x9700;&#x8981;&#x7528; applicative style &#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x628A;&#x4EFB;&#x610F;&#x6578;&#x91CF;&#x7684; list zip &#x8D77;&#x4F86;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<p><code>Control.Applicative</code> &#x5B9A;&#x7FA9;&#x4E86;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x53EB;&#x505A; <code>liftA2</code>&#xFF0C;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x662F; <code>liftA2 :: (Applicative f) =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code>&#x3002;&#x4ED6;&#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">liftA2</span> :: (<span class="hljs-type">Applicative</span> f) =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c  
<span class="hljs-title">liftA2</span> f a b = f &lt;$&gt; a &lt;*&gt; b
</code></pre>
<p>&#x4E26;&#x6C92;&#x6709;&#x592A;&#x96E3;&#x7406;&#x89E3;&#x7684;&#x6771;&#x897F;&#xFF0C;&#x4ED6;&#x4E0D;&#x904E;&#x5C31;&#x662F;&#x5C0D;&#x5169;&#x500B; applicatives &#x5957;&#x7528;&#x51FD;&#x6578;&#x800C;&#x5DF2;&#xFF0C;&#x800C;&#x4E0D;&#x7528;&#x6211;&#x5011;&#x525B;&#x525B;&#x719F;&#x6089;&#x7684; applicative style&#x3002;&#x6211;&#x5011;&#x63D0;&#x53CA;&#x4ED6;&#x7684;&#x7406;&#x7531;&#x53EA;&#x662F;&#x8981;&#x5C55;&#x793A;&#x70BA;&#x4EC0;&#x9EBC; applicative functors &#x6BD4;&#x8D77;&#x4E00;&#x822C;&#x7684;&#x666E;&#x901A; functor &#x8981;&#x5F37;&#x3002;&#x5982;&#x679C;&#x53EA;&#x662F;&#x666E;&#x901A;&#x7684; functor &#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x53EA;&#x80FD;&#x5C07;&#x4E00;&#x500B;&#x51FD;&#x6578; map over &#x9019;&#x500B; functor&#x3002;&#x4F46;&#x6709;&#x4E86; applicative functor&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C0D;&#x597D;&#x591A;&#x500B; functor &#x5957;&#x7528;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x3002;&#x770B;&#x770B;&#x9019;&#x500B;&#x51FD;&#x6578;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x4ED6;&#x6703;&#x662F; <code>(a -&gt; b -&gt; c) -&gt; (f a -&gt; f b -&gt; f c)</code>&#x3002;&#x7576;&#x6211;&#x5011;&#x5F9E;&#x9019;&#x6A23;&#x7684;&#x89D2;&#x5EA6;&#x4F86;&#x770B;&#x4ED6;&#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x8AAA; <code>liftA2</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x666E;&#x901A;&#x7684;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#xFF0C;&#x4E26;&#x5C07;&#x4ED6;&#x5347;&#x7D1A;&#x6210;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x53EF;&#x4EE5;&#x904B;&#x4F5C;&#x5728;&#x5169;&#x500B; functor &#x4E4B;&#x4E0A;&#x3002;</p>
<p>&#x53E6;&#x5916;&#x4E00;&#x500B;&#x6709;&#x8DA3;&#x7684;&#x6982;&#x5FF5;&#x662F;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x5169;&#x500B; applicative functor &#x4E26;&#x628A;&#x4ED6;&#x5011;&#x7D50;&#x5408;&#x6210;&#x4E00;&#x500B; applicative functor&#xFF0C;&#x9019;&#x500B;&#x65B0;&#x7684;&#x5C07;&#x9019;&#x5169;&#x500B; applicative functor &#x88DD;&#x5728; list &#x4E2D;&#x3002;&#x8209;&#x4F8B;&#x4F86;&#x8AAA;&#xFF0C;&#x6211;&#x5011;&#x73FE;&#x5728;&#x6709; <code>Just 3</code> &#x8DDF; <code>Just 4</code>&#x3002;&#x6211;&#x5011;&#x5047;&#x8A2D;&#x5F8C;&#x8005;&#x662F;&#x4E00;&#x500B;&#x53EA;&#x5305;&#x542B;&#x55AE;&#x5143;&#x7D20;&#x7684; list&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; fmap (\x -&gt; [x]) (<span class="hljs-type">Just</span> <span class="hljs-number">4</span>)  
<span class="hljs-type">Just</span> [<span class="hljs-number">4</span>]
</code></pre>
<p>&#x6240;&#x4EE5;&#x5047;&#x8A2D;&#x6211;&#x5011;&#x6709; <code>Just 3</code> &#x8DDF; <code>Just [4]</code>&#x3002;&#x6211;&#x5011;&#x6709;&#x600E;&#x9EBC;&#x5F97;&#x5230; <code>Just [3,4]</code> &#x5462;&#xFF1F;&#x5F88;&#x7C21;&#x55AE;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; liftA2 (:) (<span class="hljs-type">Just</span> <span class="hljs-number">3</span>) (<span class="hljs-type">Just</span> [<span class="hljs-number">4</span>])  
<span class="hljs-type">Just</span> [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]  
<span class="hljs-title">ghci</span>&gt; (:) &lt;$&gt; <span class="hljs-type">Just</span> <span class="hljs-number">3</span> &lt;*&gt; <span class="hljs-type">Just</span> [<span class="hljs-number">4</span>]  
<span class="hljs-type">Just</span> [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]
</code></pre>
<p>&#x9084;&#x8A18;&#x5F97; <code>:</code> &#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x8DDF;&#x4E00;&#x500B; list&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x65B0;&#x7684; list&#xFF0C;&#x5176;&#x4E2D;&#x90A3;&#x500B;&#x5143;&#x7D20;&#x5DF2;&#x7D93;&#x63A5;&#x5728;&#x524D;&#x9762;&#x3002;&#x73FE;&#x5728;&#x6211;&#x5011;&#x6709;&#x4E86; <code>Just [3,4]</code>&#xFF0C;&#x6211;&#x5011;&#x80FD;&#x5920;&#x5C07;&#x4ED6;&#x8DDF; <code>Just 2</code> &#x7D81;&#x5728;&#x4E00;&#x8D77;&#x8B8A;&#x6210; <code>Just [2,3,4]</code> &#x55CE;&#xFF1F;&#x7576;&#x7136;&#x53EF;&#x4EE5;&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C07;&#x4EFB;&#x610F;&#x6578;&#x91CF;&#x7684; applicative &#x7D81;&#x5728;&#x4E00;&#x8D77;&#x8B8A;&#x6210;&#x4E00;&#x500B; applicative&#xFF0C;&#x88E1;&#x9762;&#x5305;&#x542B;&#x4E00;&#x500B;&#x88DD;&#x6709;&#x7D50;&#x679C;&#x7684; list&#x3002;&#x6211;&#x5011;&#x8A66;&#x8457;&#x5BE6;&#x4F5C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x4E32;&#x88DD;&#x6709; applicative &#x7684; list&#xFF0C;&#x7136;&#x5F8C;&#x56DE;&#x50B3;&#x4E00;&#x500B; applicative &#x88E1;&#x9762;&#x6709;&#x4E00;&#x500B;&#x88DD;&#x6709;&#x7D50;&#x679C;&#x7684; list&#x3002;&#x6211;&#x5011;&#x7A31;&#x547C;&#x4ED6;&#x70BA; <code>sequenceA</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">sequenceA</span> :: (<span class="hljs-type">Applicative</span> f) =&gt; [f a] -&gt; f [a]  
<span class="hljs-title">sequenceA</span> [] = pure []  
<span class="hljs-title">sequenceA</span> (x:xs) = (:) &lt;$&gt; x &lt;*&gt; sequenceA xs
</code></pre>
<p>&#x5C45;&#x7136;&#x7528;&#x5230;&#x4E86;&#x905E;&#x8FF4;&#xFF01;&#x9996;&#x5148;&#x6211;&#x5011;&#x4F86;&#x770B;&#x4E00;&#x4E0B;&#x4ED6;&#x7684;&#x578B;&#x5225;&#x3002;&#x4ED6;&#x5C07;&#x4E00;&#x4E32; applicative &#x7684; list &#x8F49;&#x63DB;&#x6210;&#x4E00;&#x500B; applicative &#x88DD;&#x6709;&#x4E00;&#x500B; list&#x3002;&#x5F9E;&#x9019;&#x500B;&#x8CC7;&#x8A0A;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x63A8;&#x6E2C;&#x51FA;&#x908A;&#x754C;&#x689D;&#x4EF6;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x8981;&#x5C07;&#x4E00;&#x500B;&#x7A7A;&#x7684; list &#x8B8A;&#x6210;&#x4E00;&#x500B;&#x88DD;&#x6709; list &#x7684; applicative&#x3002;&#x6211;&#x5011;&#x53EA;&#x8981;&#x628A;&#x9019;&#x500B;&#x7A7A;&#x7684; list &#x653E;&#x9032;&#x4E00;&#x500B;&#x9810;&#x8A2D;&#x7684; context&#x3002;&#x73FE;&#x5728;&#x4F86;&#x770B;&#x4E00;&#x4E0B;&#x6211;&#x5011;&#x600E;&#x9EBC;&#x7528;&#x905E;&#x8FF4;&#x7684;&#x3002;&#x5982;&#x679C;&#x5011;&#x6709;&#x4E00;&#x500B;&#x53EF;&#x4EE5;&#x5206;&#x6210;&#x982D;&#x8DDF;&#x5C3E;&#x7684; list&#xFF08;<code>x</code> &#x662F;&#x4E00;&#x500B; applicative &#x800C; <code>xs</code> &#x662F;&#x4E00;&#x4E32; applicatve&#xFF09;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C0D;&#x5C3E;&#x5DF4;&#x547C;&#x53EB; <code>sequenceA</code>&#xFF0C;&#x4FBF;&#x6703;&#x5F97;&#x5230;&#x4E00;&#x500B;&#x88DD;&#x6709; list &#x7684; applicative&#x3002;&#x7136;&#x5F8C;&#x6211;&#x5011;&#x53EA;&#x8981;&#x5C07;&#x5728; <code>x</code> &#x4E2D;&#x7684;&#x503C;&#x628A;&#x4ED6;&#x63A5;&#x5230;&#x88DD;&#x6709; list &#x7684; applicative &#x524D;&#x9762;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6211;&#x5011;&#x505A; <code>sequenceA [Just 1, Just 2]</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <code>(:) &lt;$&gt; Just 1 &lt;*&gt; sequenceA [Just 2]</code>&#x3002;&#x90A3;&#x6703;&#x7B49;&#x50F9;&#x65BC; <code>(:) &lt;$&gt; Just 1 &lt;*&gt; ((:) &lt;$&gt; Just 2 &lt;*&gt; sequenceA [])</code>&#x3002;&#x6211;&#x5011;&#x77E5;&#x9053; <code>sequenceA []</code> &#x7B97;&#x51FA;&#x4F86;&#x6703;&#x662F; <code>Just []</code>&#xFF0C;&#x6240;&#x4EE5;&#x904B;&#x7B97;&#x5F0F;&#x5C31;&#x8B8A;&#x6210; <code>(:) &lt;$&gt; Just 1 &lt;*&gt; ((:) &lt;$&gt; Just 2 &lt;*&gt; Just [])</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <code>(:) &lt;$&gt; Just 1 &lt;*&gt; Just [2]</code>&#xFF0C;&#x7B97;&#x51FA;&#x4F86;&#x5C31;&#x662F; <code>Just [1,2]</code>&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x7A2E;&#x5BE6;&#x4F5C; <code>sequenceA</code> &#x7684;&#x65B9;&#x5F0F;&#x662F;&#x7528; fold&#x3002;&#x8981;&#x8A18;&#x5F97;&#x5E7E;&#x4E4E;&#x4EFB;&#x4F55;&#x9700;&#x8981;&#x8D70;&#x904D;&#x6574;&#x500B; list &#x4E26; accumulate &#x6210;&#x4E00;&#x500B;&#x7D50;&#x679C;&#x7684;&#x90FD;&#x53EF;&#x4EE5;&#x7528; fold &#x4F86;&#x5BE6;&#x4F5C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">sequenceA</span> :: (<span class="hljs-type">Applicative</span> f) =&gt; [f a] -&gt; f [a]  
<span class="hljs-title">sequenceA</span> = foldr (liftA2 (:)) (pure [])
</code></pre>
<p>&#x6211;&#x5011;&#x5F9E;&#x53F3;&#x5F80;&#x5DE6;&#x8D70;&#xFF0C;&#x4E26;&#x4E14;&#x8D77;&#x59CB;&#x7684; accumulator &#x662F;&#x7528; <code>pure []</code>&#x3002;&#x6211;&#x5011;&#x662F;&#x7528; <code>liftA2 (:)</code> &#x4F86;&#x7D50;&#x5408; accumulator &#x8DDF; list &#x4E2D;&#x6700;&#x5F8C;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x800C;&#x5F97;&#x5230;&#x4E00;&#x500B; applicative&#xFF0C;&#x88E1;&#x9762;&#x88DD;&#x6709;&#x4E00;&#x500B;&#x55AE;&#x4E00;&#x5143;&#x7D20;&#x7684;&#x4E00;&#x500B; list&#x3002;&#x7136;&#x5F8C;&#x6211;&#x5011;&#x518D;&#x7528; <code>liftA2 (:)</code> &#x4F86;&#x7D50;&#x5408; accumulator &#x8DDF;&#x6700;&#x5F8C;&#x4E00;&#x500B;&#x5143;&#x7D20;&#xFF0C;&#x76F4;&#x5230;&#x6211;&#x5011;&#x53EA;&#x5269;&#x4E0B; accumulator &#x70BA;&#x6B62;&#xFF0C;&#x800C;&#x5F97;&#x5230;&#x4E00;&#x500B; applicative&#xFF0C;&#x88E1;&#x9762;&#x88DD;&#x6709;&#x6240;&#x6709;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x6211;&#x5011;&#x4F86;&#x8A66;&#x8A66;&#x770B;&#x5957;&#x7528;&#x5728;&#x4E0D;&#x540C; applicative &#x4E0A;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; sequenceA [<span class="hljs-type">Just</span> <span class="hljs-number">3</span>, <span class="hljs-type">Just</span> <span class="hljs-number">2</span>, <span class="hljs-type">Just</span> <span class="hljs-number">1</span>]  
<span class="hljs-type">Just</span> [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]  
<span class="hljs-title">ghci</span>&gt; sequenceA [<span class="hljs-type">Just</span> <span class="hljs-number">3</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">Just</span> <span class="hljs-number">1</span>]  
<span class="hljs-type">Nothing</span>  
<span class="hljs-title">ghci</span>&gt; sequenceA [(+<span class="hljs-number">3</span>),(+<span class="hljs-number">2</span>),(+<span class="hljs-number">1</span>)] <span class="hljs-number">3</span>  
[<span class="hljs-number">6</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>]  
<span class="hljs-title">ghci</span>&gt; sequenceA [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">6</span>]]  
<span class="hljs-title">ghci</span>&gt; sequenceA [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>],[]]  
[]
</code></pre>
<p>&#x5F88;&#x9177;&#x5427;&#x3002;&#x7576;&#x6211;&#x5011;&#x5957;&#x7528;&#x5728; <code>Maybe</code> &#x4E0A;&#x6642;&#xFF0C;<code>sequenceA</code> &#x5275;&#x9020;&#x4E00;&#x500B;&#x65B0;&#x7684; <code>Maybe</code>&#xFF0C;&#x4ED6;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x500B; list &#x88DD;&#x6709;&#x6240;&#x6709;&#x7D50;&#x679C;&#x3002;&#x5982;&#x679C;&#x5176;&#x4E2D;&#x4E00;&#x500B;&#x503C;&#x662F; <code>Nothing</code>&#xFF0C;&#x90A3;&#x6574;&#x500B;&#x7D50;&#x679C;&#x5C31;&#x6703;&#x662F; <code>Nothing</code>&#x3002;&#x5982;&#x679C;&#x4F60;&#x6709;&#x4E00;&#x4E32; <code>Maybe</code> &#x578B;&#x5225;&#x7684;&#x503C;&#xFF0C;&#x4F46;&#x4F60;&#x53EA;&#x5728;&#x4E4E;&#x7576;&#x7D50;&#x679C;&#x4E0D;&#x5305;&#x542B;&#x4EFB;&#x4F55; <code>Nothing</code> &#x7684;&#x60C5;&#x6CC1;&#xFF0C;&#x9019;&#x6A23;&#x7684;&#x7279;&#x6027;&#x5C31;&#x5F88;&#x65B9;&#x4FBF;&#x3002;</p>
<p>&#x7576;&#x5957;&#x7528;&#x5728;&#x51FD;&#x6578;&#x6642;&#xFF0C;<code>sequenceA</code> &#x63A5;&#x53D7;&#x88DD;&#x6709;&#x4E00;&#x5806;&#x51FD;&#x6578;&#x7684; list&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x56DE;&#x50B3; list &#x7684;&#x51FD;&#x6578;&#x3002;&#x5728;&#x6211;&#x5011;&#x7684;&#x7BC4;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x5BEB;&#x4E86;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x53EA;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x6578;&#x503C;&#x4F5C;&#x70BA;&#x53C3;&#x6578;&#xFF0C;&#x4ED6;&#x6703;&#x628A;&#x4ED6;&#x5957;&#x7528;&#x81F3; list &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x5305;&#x542B;&#x7D50;&#x679C;&#x7684; list&#x3002;<code>sequenceA [(+3),(+2),(+1)] 3</code> &#x6703;&#x5C07; <code>3</code> &#x9935;&#x7D66; <code>(+3)</code>, <code>(+2)</code> &#x8DDF; <code>(+1)</code>&#xFF0C;&#x7136;&#x5F8C;&#x5C07;&#x6240;&#x6709;&#x7D50;&#x679C;&#x88DD;&#x5728;&#x4E00;&#x500B; list &#x4E2D;&#x3002;</p>
<p>&#x800C; <code>(+) &lt;$&gt; (+3) &lt;*&gt; (*2)</code> &#x6703;&#x5275;&#x898B;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x55AE;&#x4E00;&#x53C3;&#x6578;&#x7684;&#x4E00;&#x51FD;&#x6578;&#xFF0C;&#x5C07;&#x4ED6;&#x540C;&#x6642;&#x9935;&#x7D66; <code>(+3)</code> &#x8DDF; <code>(*2)</code>&#xFF0C;&#x7136;&#x5F8C;&#x547C;&#x53EB; <code>+</code> &#x4F86;&#x5C07;&#x5169;&#x8005;&#x52A0;&#x8D77;&#x4F86;&#x3002;&#x540C;&#x6A23;&#x7684;&#x9053;&#x7406;&#xFF0C;<code>sequenceA [(+3),(*2)]</code> &#x662F;&#x88FD;&#x9020;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x55AE;&#x4E00;&#x53C3;&#x6578;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x6703;&#x5C07;&#x4ED6;&#x9935;&#x7D66;&#x6240;&#x6709;&#x5305;&#x542B;&#x5728; list &#x4E2D;&#x7684;&#x51FD;&#x6578;&#x3002;&#x4F46;&#x4ED6;&#x6700;&#x5F8C;&#x4E0D;&#x662F;&#x547C;&#x53EB; <code>+</code>&#xFF0C;&#x800C;&#x662F;&#x547C;&#x53EB; <code>:</code> &#x8DDF; <code>pure []</code> &#x4F86;&#x628A;&#x7D50;&#x679C;&#x63A5;&#x6210;&#x4E00;&#x500B; list&#xFF0C;&#x5F97;&#x5230;&#x6700;&#x5F8C;&#x7684;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x7576;&#x6211;&#x5011;&#x6709;&#x4E00;&#x4E32;&#x51FD;&#x6578;&#xFF0C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x5C07;&#x76F8;&#x540C;&#x7684;&#x8F38;&#x5165;&#x90FD;&#x9935;&#x7D66;&#x4ED6;&#x5011;&#x4E26;&#x6AA2;&#x8996;&#x7D50;&#x679C;&#x7684;&#x6642;&#x5019;&#xFF0C;<code>sequenceA</code> &#x975E;&#x5E38;&#x597D;&#x7528;&#x3002;&#x4F8B;&#x5982;&#x8AAA;&#xFF0C;&#x6211;&#x5011;&#x624B;&#x4E0A;&#x6709;&#x4E00;&#x500B;&#x6578;&#x503C;&#xFF0C;&#x4F46;&#x4E0D;&#x77E5;&#x9053;&#x4ED6;&#x662F;&#x5426;&#x6EFF;&#x8DB3;&#x4E00;&#x4E32; predicate&#x3002;&#x4E00;&#x7A2E;&#x5BE6;&#x4F5C;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x50CF;&#x9019;&#x6A23;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; map (\f -&gt; f <span class="hljs-number">7</span>) [(&gt;<span class="hljs-number">4</span>),(&lt;<span class="hljs-number">10</span>),odd]  
[<span class="hljs-type">True</span>,<span class="hljs-type">True</span>,<span class="hljs-type">True</span>]  
<span class="hljs-title">ghci</span>&gt; and $ map (\f -&gt; f <span class="hljs-number">7</span>) [(&gt;<span class="hljs-number">4</span>),(&lt;<span class="hljs-number">10</span>),odd]  
<span class="hljs-type">True</span>
</code></pre>
<p>&#x8A18;&#x4F4F; <code>and</code> &#x63A5;&#x53D7;&#x4E00;&#x4E32;&#x5E03;&#x6797;&#x503C;&#xFF0C;&#x4E26;&#x53EA;&#x6709;&#x5728;&#x5168;&#x90E8;&#x90FD;&#x662F; <code>True</code> &#x7684;&#x6642;&#x5019;&#x624D;&#x56DE;&#x50B3; <code>True</code>&#x3002; &#x53E6;&#x4E00;&#x7A2E;&#x5BE6;&#x4F5C;&#x65B9;&#x5F0F;&#x662F;&#x7528; <code>sequenceA</code>&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; sequenceA [(&gt;<span class="hljs-number">4</span>),(&lt;<span class="hljs-number">10</span>),odd] <span class="hljs-number">7</span>  
[<span class="hljs-type">True</span>,<span class="hljs-type">True</span>,<span class="hljs-type">True</span>]  
<span class="hljs-title">ghci</span>&gt; and $ sequenceA [(&gt;<span class="hljs-number">4</span>),(&lt;<span class="hljs-number">10</span>),odd] <span class="hljs-number">7</span>  
<span class="hljs-type">True</span>
</code></pre>
<p><code>sequenceA [(&gt;4),(&lt;10),odd]</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x6578;&#x503C;&#x4E26;&#x5C07;&#x4ED6;&#x9935;&#x7D66;&#x6240;&#x6709;&#x7684; predicate&#xFF0C;&#x5305;&#x542B; <code>[(&gt;4),(&lt;10),odd]</code>&#x3002;&#x7136;&#x5F8C;&#x56DE;&#x50B3;&#x4E00;&#x4E32;&#x5E03;&#x6797;&#x503C;&#x3002;&#x4ED6;&#x5C07;&#x4E00;&#x500B;&#x578B;&#x5225;&#x70BA; <code>(Num a) =&gt; [a -&gt; Bool]</code> &#x7684; list &#x8B8A;&#x6210;&#x4E00;&#x500B;&#x578B;&#x5225;&#x70BA; <code>(Num a) =&gt; a -&gt; [Bool]</code> &#x7684;&#x51FD;&#x6578;&#xFF0C;&#x5F88;&#x9177;&#x5427;&#x3002;</p>
<p>&#x7531;&#x65BC; list &#x8981;&#x6C42;&#x88E1;&#x9762;&#x5143;&#x7D20;&#x7684;&#x578B;&#x5225;&#x8981;&#x4E00;&#x81F4;&#xFF0C;&#x6240;&#x4EE5;&#x5305;&#x542B;&#x5728; list &#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6578;&#x90FD;&#x662F;&#x540C;&#x6A23;&#x578B;&#x5225;&#x3002;&#x4F60;&#x4E0D;&#x80FD;&#x5275;&#x9020;&#x4E00;&#x500B;&#x50CF;&#x662F; <code>[ord, (+3)]</code> &#x9019;&#x6A23;&#x7684; list&#xFF0C;&#x56E0;&#x70BA; <code>ord</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5B57;&#x5143;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x6578;&#x503C;&#xFF0C;&#x7136;&#x800C; <code>(+3)</code> &#x63A5;&#x53D7;&#x4E00;&#x500B;&#x6578;&#x503C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B;&#x6578;&#x503C;&#x3002;</p>
<p>&#x7576;&#x8DDF; <code>[]</code> &#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x7684;&#x6642;&#x5019;&#xFF0C;<code>sequenceA</code> &#x63A5;&#x53D7;&#x4E00;&#x4E32; list&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x53E6;&#x4E00;&#x4E32; list&#x3002;&#x4ED6;&#x5BE6;&#x969B;&#x4E0A;&#x662F;&#x5275;&#x5EFA;&#x4E00;&#x500B;&#x5305;&#x542B;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x7D44;&#x5408;&#x7684; list&#x3002;&#x70BA;&#x4E86;&#x65B9;&#x4FBF;&#x8AAA;&#x660E;&#xFF0C;&#x6211;&#x5011;&#x6BD4;&#x8F03;&#x4E00;&#x4E0B;&#x4F7F;&#x7528; <code>sequenceA</code> &#x8DDF; list comprehension &#x7684;&#x5DEE;&#x7570;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; sequenceA [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">6</span>]]  
<span class="hljs-title">ghci</span>&gt; [[x,y] | x &lt;- [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], y &lt;- [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">6</span>]]  
<span class="hljs-title">ghci</span>&gt; sequenceA [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>]]  
<span class="hljs-title">ghci</span>&gt; [[x,y] | x &lt;- [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], y &lt;- [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>]]  
<span class="hljs-title">ghci</span>&gt; sequenceA [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>]]  
<span class="hljs-title">ghci</span>&gt; [[x,y,z] | x &lt;- [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], y &lt;- [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>], z &lt;- [<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]]  
[[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>]]
</code></pre>
<p>&#x9019;&#x53EF;&#x80FD;&#x6709;&#x9EDE;&#x96E3;&#x4EE5;&#x7406;&#x89E3;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x4F60;&#x591A;&#x505A;&#x9EDE;&#x5617;&#x8A66;&#xFF0C;&#x4F60;&#x6703;&#x6BD4;&#x8F03;&#x80FD;&#x770B;&#x51FA;&#x4F86;&#x4E9B;&#x7709;&#x76EE;&#x3002;&#x5047;&#x8A2D;&#x6211;&#x5011;&#x5728;&#x505A; <code>sequenceA [[1,2],[3,4]]</code>&#x3002;&#x8981;&#x77E5;&#x9053;&#x9019;&#x662F;&#x600E;&#x9EBC;&#x56DE;&#x4E8B;&#xFF0C;&#x6211;&#x5011;&#x9996;&#x5148;&#x7528; <code>sequenceA</code> &#x7684;&#x5B9A;&#x7FA9; <code>sequenceA (x:xs) = (:) &lt;$&gt; x &lt;*&gt; sequenceA xs</code> &#x9084;&#x6709;&#x908A;&#x754C;&#x689D;&#x4EF6; <code>sequenceA [] = pure []</code> &#x4F86;&#x770B;&#x770B;&#x3002;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x5BE6;&#x969B;&#x8A08;&#x7B97;&#xFF0C;&#x4F46;&#x4ED6;&#x53EF;&#x4EE5;&#x5E6B;&#x52A9;&#x4F60;&#x7406;&#x89E3; <code>sequenceA</code> &#x662F;&#x600E;&#x9EBC;&#x904B;&#x4F5C;&#x5728;&#x4E00;&#x4E32; list &#x4E0A;&#xFF0C;&#x7562;&#x7ADF;&#x9019;&#x6709;&#x9EDE;&#x8907;&#x96DC;&#x3002;</p>
<pre><code class="lang-text"># &#x6211;&#x5011;&#x5F9E; ``sequenceA [[1,2],[3,4]]`` &#x958B;&#x59CB;
# &#x90A3;&#x53EF;&#x4EE5;&#x88AB;&#x8A08;&#x7B97;&#x6210; ``(:) &lt;$&gt; [1,2] &lt;*&gt; sequenceA [[3,4]]``
# &#x8A08;&#x7B97;&#x5167;&#x5C64;&#x7684; ``sequenceA``&#xFF0C;&#x6703;&#x5F97;&#x5230; ``(:) &lt;$&gt; [1,2] &lt;*&gt; ((:) &lt;$&gt; [3,4] &lt;*&gt; sequenceA [])``
# &#x6211;&#x5011;&#x78B0;&#x5230;&#x4E86;&#x908A;&#x754C;&#x689D;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x6703;&#x662F; ``(:) &lt;$&gt; [1,2] &lt;*&gt; ((:) &lt;$&gt; [3,4] &lt;*&gt; [[]])``
# &#x73FE;&#x5728;&#x6211;&#x5011;&#x8A08;&#x7B97; ``(:) &lt;$&gt; [3,4] &lt;*&gt; [[]] `` &#x7684;&#x90E8;&#x4EFD;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5C0D;&#x5DE6;&#x908A; list &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C; (&#x4E5F;&#x5C31;&#x662F; ``3`` &#x8DDF; ``4``) &#x8DDF;&#x53F3;&#x908A;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C; (&#x53EA;&#x6709; ``[]``)&#x5957;&#x7528; ``:``&#xFF0C;&#x800C;&#x5F97;&#x5230; ``[3:[], 4:[]]``&#xFF0C;&#x4E5F;&#x5C31;&#x662F; ``[[3],[4]]``&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x6709; ``(:) &lt;$&gt; [1,2] &lt;*&gt; [[3],[4]]``
# &#x800C;&#x5C0D;&#x65BC;&#x5DE6;&#x908A;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;(``1`` &#x8DDF; ``2``)&#x4EE5;&#x53CA;&#x53F3;&#x908A;&#x53EF;&#x80FD;&#x7684;&#x503C;&#xFF08;``[3]`` &#x8DDF; ``[4]``&#xFF09;&#x6211;&#x5011;&#x5957;&#x7528; ``:`` &#x800C;&#x5F97;&#x5230; ``[1:[3], 1:[4], 2:[3], 2:[4]]``&#xFF0C;&#x4ED6;&#x7B49;&#x65BC; ``[[1,3],[1,4],[2,3],[2,4]]``
</code></pre>
<p>&#x8A08;&#x7B97; <code>(+) &lt;$&gt; [1,2] &lt;*&gt; [4,5,6]</code> &#x6703;&#x5F97;&#x5230;&#x4E00;&#x500B; non-deterministic &#x7684;&#x7D50;&#x679C; <code>x + y</code>&#xFF0C;&#x5176;&#x4E2D; <code>x</code> &#x4EE3;&#x8868; <code>[1,2]</code> &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x800C; <code>y</code> &#x4EE3;&#x8868; <code>[4,5,6]</code> &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#x3002;&#x6211;&#x5011;&#x7528; list &#x4F86;&#x8868;&#x793A;&#x6BCF;&#x4E00;&#x7A2E;&#x53EF;&#x80FD;&#x7684;&#x60C5;&#x5F62;&#x3002;&#x540C;&#x6A23;&#x7684;&#xFF0C;&#x7576;&#x6211;&#x5011;&#x5728;&#x505A; <code>sequence [[1,2],[3,4],[5,6],[7,8]]</code>&#xFF0C;&#x4ED6;&#x7684;&#x7D50;&#x679C;&#x6703;&#x662F; non-deterministic &#x7684; <code>[x,y,z,w]</code>&#xFF0C;&#x5176;&#x4E2D; <code>x</code> &#x4EE3;&#x8868; <code>[1,2]</code> &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x800C; <code>y</code> &#x4EE3;&#x8868; <code>[3,4]</code> &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#x3002;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;&#x6211;&#x5011;&#x7528; list &#x4EE3;&#x8868; non-deterministic &#x7684;&#x8A08;&#x7B97;&#xFF0C;&#x6BCF;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x4E00;&#x500B;&#x53EF;&#x80FD;&#x7684;&#x60C5;&#x5F62;&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBD;&#x6703;&#x7528;&#x5230; list of list&#x3002;</p>
<p>&#x7576;&#x4F7F;&#x7528;&#x5728; I/O action &#x4E0A;&#x7684;&#x6642;&#x5019;&#xFF0C;<code>sequenceA</code> &#x8DDF; <code>sequence</code> &#x662F;&#x7B49;&#x50F9;&#x7684;&#x3002;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x4E32; I/O action &#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; I/O action&#xFF0C;&#x9019;&#x500B; I/O action &#x6703;&#x8A08;&#x7B97; list &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x500B; I/O action&#xFF0C;&#x4E26;&#x628A;&#x7D50;&#x679C;&#x653E;&#x5728;&#x4E00;&#x500B; list &#x4E2D;&#x3002;&#x8981;&#x5C07;&#x578B;&#x5225;&#x70BA; <code>[IO a]</code> &#x7684;&#x503C;&#x8F49;&#x63DB;&#x6210; <code>IO [a]</code> &#x7684;&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6703;&#x7522;&#x751F;&#x4E00;&#x4E32; list &#x7684;&#x4E00;&#x500B; I/O action&#xFF0C;&#x90A3;&#x9019;&#x4E9B; I/O action &#x5FC5;&#x9808;&#x8981;&#x4E00;&#x500B;&#x4E00;&#x500B;&#x5730;&#x88AB;&#x8A08;&#x7B97;&#xFF0C;&#x7562;&#x7ADF;&#x5C0D;&#x65BC;&#x9019;&#x4E9B; I/O action &#x4F60;&#x6C92;&#x8FA6;&#x6CD5;&#x4E0D;&#x8A08;&#x7B97;&#x5C31;&#x5F97;&#x5230;&#x7D50;&#x679C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; sequenceA [getLine, getLine, getLine]  
<span class="hljs-title">heyh</span>  
<span class="hljs-title">ho</span>  
<span class="hljs-title">woo</span>  
[<span class="hljs-string">&quot;heyh&quot;</span>,<span class="hljs-string">&quot;ho&quot;</span>,<span class="hljs-string">&quot;woo&quot;</span>]
</code></pre>
<p>&#x5C31;&#x50CF;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6578;&#x4E00;&#x6A23;&#xFF0C;applicative functors &#x4E5F;&#x9075;&#x5FAA;&#x4E00;&#x4E9B;&#x5B9A;&#x5F8B;&#x3002;&#x5176;&#x4E2D;&#x6700;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x500B;&#x662F;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x63D0;&#x904E;&#x7684; <code>pure f &lt;*&gt; x = fmap f x</code>&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x8B49;&#x660E;&#x4E00;&#x4E9B;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x4ECB;&#x7D39;&#x904E;&#x7684; applicative functor &#x9075;&#x5B88;&#x9019;&#x500B;&#x5B9A;&#x5F8B;&#x7576;&#x4F5C;&#x7DF4;&#x7FD2;&#x3002;&#x5176;&#x4ED6;&#x7684; functors law &#x6709;&#xFF1A;</p>
<pre><code class="lang-text"># ``pure id &lt;*&gt; v = v``
# ``pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)``
# ``pure f &lt;*&gt; pure x = pure (f x)``
# ``u &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u``
</code></pre>
<p>&#x6211;&#x5011;&#x4E0D;&#x6703;&#x4E00;&#x9805;&#x4E00;&#x9805;&#x5730;&#x7D30;&#x770B;&#xFF0C;&#x90A3;&#x6A23;&#x6703;&#x82B1;&#x8CBB;&#x5F88;&#x5927;&#x7684;&#x7BC7;&#x5E45;&#x800C;&#x4E14;&#x5C0D;&#x8B80;&#x8005;&#x4F86;&#x8AAA;&#x5F88;&#x7121;&#x804A;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x4F60;&#x6709;&#x8208;&#x8DA3;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x91DD;&#x5C0D;&#x67D0;&#x4E9B; instance &#x770B;&#x770B;&#x4ED6;&#x5011;&#x6703;&#x4E0D;&#x6703;&#x9075;&#x5B88;&#x3002;</p>
<p>&#x7D50;&#x8AD6;&#x5C31;&#x662F; applicative functor &#x4E0D;&#x53EA;&#x662F;&#x6709;&#x8DA3;&#x800C;&#x4E14;&#x5BE6;&#x7528;&#xFF0C; &#x4ED6;&#x5141;&#x8A31;&#x6211;&#x5011;&#x7D50;&#x5408;&#x4E0D;&#x540C;&#x7A2E;&#x985E;&#x7684;&#x8A08;&#x7B97;&#xFF0C;&#x50CF;&#x662F; I/O &#x8A08;&#x7B97;&#xFF0C;non-deterministic &#x7684;&#x8A08;&#x7B97;&#xFF0C;&#x6709;&#x53EF;&#x80FD;&#x5931;&#x6557;&#x7684;&#x8A08;&#x7B97;&#x7B49;&#x7B49;&#x3002;&#x800C;&#x4F7F;&#x7528; <code>&lt;$&gt;</code> &#x8DDF; <code>&lt;*&gt;</code> &#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C07;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6578;&#x4F86;&#x904B;&#x4F5C;&#x5728;&#x4EFB;&#x610F;&#x6578;&#x91CF;&#x7684; applicative functors &#x4E0A;&#x3002;</p>
<h2 id="&#x95DC;&#x9375;&#x5B57;newtype">&#x95DC;&#x9375;&#x5B57;&quot;newtype&quot;</h2>
<p><img src="img/maoi.png" alt=""></p>
<p>&#x5230;&#x76EE;&#x524D;&#x70BA;&#x6B62;&#xFF0C;&#x6211;&#x5011;&#x5DF2;&#x7D93;&#x770B;&#x904E;&#x4E86;&#x5982;&#x4F55;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x5B9A;&#x7FA9;&#x81EA;&#x5DF1;&#x7684; algebraic data type&#x3002;&#x6211;&#x5011;&#x4E5F;&#x5B78;&#x7FD2;&#x5230;&#x4E86;&#x5982;&#x4F55;&#x7528; <code>type</code> &#x4F86;&#x5B9A;&#x7FA9; type synonyms&#x3002;&#x5728;&#x9019;&#x500B;&#x7AE0;&#x7BC0;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x770B;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x4F7F;&#x7528; <code>newtype</code> &#x4F86;&#x5F9E;&#x4E00;&#x500B;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x4E2D;&#x5B9A;&#x7FA9;&#x51FA;&#x65B0;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x4E26;&#x8AAA;&#x660E;&#x6211;&#x5011;&#x70BA;&#x4EC0;&#x9EBD;&#x6703;&#x60F3;&#x8981;&#x90A3;&#x9EBC;&#x505A;&#x3002;</p>
<p>&#x5728;&#x4E4B;&#x524D;&#x7684;&#x7AE0;&#x7BC0;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x77AD;&#x89E3;&#x5230;&#x5176;&#x5BE6; list &#x6709;&#x5F88;&#x591A;&#x7A2E;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x88AB;&#x8996;&#x70BA;&#x4E00;&#x7A2E; applicative functor&#x3002;&#x4E00;&#x4E2D;&#x65B9;&#x5F0F;&#x662F;&#x5B9A;&#x7FA9; <code>&lt;*&gt;</code> &#x5C07;&#x5DE6;&#x908A;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#x8DDF;&#x53F3;&#x908A;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x503C;&#x7D44;&#x5408;&#xFF0C;&#x800C;&#x5F97;&#x5230;&#x5404;&#x7A2E;&#x7D44;&#x5408;&#x7684;&#x7D50;&#x679C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; [(+<span class="hljs-number">1</span>),(*<span class="hljs-number">100</span>),(*<span class="hljs-number">5</span>)] &lt;*&gt; [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">100</span>,<span class="hljs-number">200</span>,<span class="hljs-number">300</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">15</span>]
</code></pre>
<p>&#x7B2C;&#x4E8C;&#x7A2E;&#x65B9;&#x5F0F;&#x662F;&#x5C07; <code>&lt;*&gt;</code> &#x5B9A;&#x7FA9;&#x6210;&#x5C07;&#x5DE6;&#x908A;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x53F3;&#x908A;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x503C;&#xFF0C;&#x7136;&#x5F8C;&#x5C07;&#x5DE6;&#x908A;&#x7B2C;&#x4E8C;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x53F3;&#x908A;&#x7B2C;&#x4E8C;&#x500B;&#x503C;&#x3002;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;&#x6700;&#x7D42;&#xFF0C;&#x9019;&#x8868;&#x73FE;&#x5F97;&#x6709;&#x9EDE;&#x50CF;&#x5C07;&#x5169;&#x500B; list &#x7528;&#x4E00;&#x500B;&#x62C9;&#x934A;&#x62C9;&#x8D77;&#x4F86;&#x4E00;&#x6A23;&#x3002;&#x4F46;&#x7531;&#x65BC; list &#x5DF2;&#x7D93;&#x88AB;&#x5B9A;&#x7FA9;&#x6210; <code>Applicaitive</code> &#x7684; instance &#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x8981;&#x600E;&#x9EBC;&#x8981;&#x8B93; list &#x53EF;&#x4EE5;&#x88AB;&#x5B9A;&#x7FA9;&#x6210;&#x7B2C;&#x4E8C;&#x7A2E;&#x65B9;&#x5F0F;&#x5462;&#xFF1F;&#x5982;&#x679C;&#x4F60;&#x9084;&#x8A18;&#x5F97;&#x6211;&#x5011;&#x8AAA;&#x904E;&#x6211;&#x5011;&#x662F;&#x6709;&#x5F88;&#x597D;&#x7684;&#x7406;&#x7531;&#x5B9A;&#x7FA9;&#x4E86; <code>ZipList a</code>&#xFF0C;&#x5176;&#x4E2D;&#x4ED6;&#x88E1;&#x9762;&#x53EA;&#x5305;&#x542B;&#x4E00;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x8DDF;&#x53EA;&#x5305;&#x542B;&#x4E00;&#x500B;&#x6B04;&#x4F4D;&#x3002;&#x5176;&#x5BE6;&#x4ED6;&#x7684;&#x7406;&#x7531;&#x5C31;&#x662F;&#x8981;&#x8B93; <code>ZipList</code> &#x5B9A;&#x7FA9;&#x6210;&#x7528;&#x62C9;&#x934A;&#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x8868;&#x73FE; applicative &#x884C;&#x70BA;&#x3002;&#x6211;&#x5011;&#x53EA;&#x4E0D;&#x904E;&#x7528; <code>ZipList</code> &#x9019;&#x500B;&#x69CB;&#x9020;&#x5B50;&#x5C07;&#x4ED6;&#x5305;&#x8D77;&#x4F86;&#xFF0C;&#x7136;&#x5F8C;&#x7528; <code>getZipList</code> &#x4F86;&#x89E3;&#x958B;&#x4F86;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getZipList $ <span class="hljs-type">ZipList</span> [(+<span class="hljs-number">1</span>),(*<span class="hljs-number">100</span>),(*<span class="hljs-number">5</span>)] &lt;*&gt; <span class="hljs-type">ZipList</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
[<span class="hljs-number">2</span>,<span class="hljs-number">200</span>,<span class="hljs-number">15</span>]
</code></pre>
<p>&#x6240;&#x4EE5;&#x9019;&#x8DDF; newtype &#x9019;&#x500B;&#x95DC;&#x9375;&#x5B57;&#x6709;&#x4EC0;&#x9EBD;&#x95DC;&#x4FC2;&#x5462;&#xFF1F;&#x60F3;&#x60F3;&#x770B;&#x6211;&#x5011;&#x662F;&#x600E;&#x9EBC;&#x5BA3;&#x544A;&#x6211;&#x5011;&#x7684; <code>ZipList a</code> &#x7684;&#xFF0C;&#x4E00;&#x7A2E;&#x65B9;&#x5F0F;&#x662F;&#x50CF;&#x9019;&#x6A23;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">ZipList</span> a = <span class="hljs-type">ZipList</span> [a]</span>
</code></pre>
<p>&#x4E5F;&#x5C31;&#x662F;&#x4E00;&#x500B;&#x53EA;&#x6709;&#x4E00;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x7684;&#x578B;&#x5225;&#x800C;&#x4E14;&#x90A3;&#x500B;&#x69CB;&#x9020;&#x5B50;&#x88E1;&#x9762;&#x53EA;&#x6709;&#x4E00;&#x500B;&#x6B04;&#x4F4D;&#x3002;&#x6211;&#x5011;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; record syntax &#x4F86;&#x5B9A;&#x7FA9;&#x4E00;&#x500B;&#x89E3;&#x958B;&#x7684;&#x51FD;&#x6578;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">ZipList</span> a = <span class="hljs-type">ZipList</span> { <span class="hljs-title">getZipList</span> :: [<span class="hljs-title">a</span>] }</span>
</code></pre>
<p>&#x9019;&#x6A23;&#x807D;&#x8D77;&#x4F86;&#x4E0D;&#x932F;&#x3002;&#x9019;&#x6A23;&#x6211;&#x5011;&#x5C31;&#x6709;&#x5169;&#x7A2E;&#x65B9;&#x5F0F;&#x4F86;&#x8B93;&#x4E00;&#x500B;&#x578B;&#x5225;&#x4F86;&#x8868;&#x73FE;&#x4E00;&#x500B; typeclass&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x4F86;&#x628A;&#x4E00;&#x500B;&#x578B;&#x5225;&#x5305;&#x5728;&#x53E6;&#x4E00;&#x500B;&#x88E1;&#x9762;&#xFF0C;&#x7136;&#x5F8C;&#x518D;&#x5C07;&#x4ED6;&#x5B9A;&#x7FA9;&#x6210;&#x7B2C;&#x4E8C;&#x7A2E;&#x8868;&#x73FE;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x800C;&#x5728; Haskell &#x4E2D; <code>newtype</code> &#x6B63;&#x662F;&#x70BA;&#x4E86;&#x9019;&#x7A2E;&#x60C5;&#x5F62;&#xFF0C;&#x6211;&#x5011;&#x60F3;&#x5C07;&#x4E00;&#x500B;&#x578B;&#x5225;&#x5305;&#x5728;&#x53E6;&#x4E00;&#x500B;&#x578B;&#x5225;&#x4E2D;&#x3002;&#x5728;&#x5BE6;&#x969B;&#x7684;&#x51FD;&#x5F0F;&#x5EAB;&#x4E2D; <code>ZipList a</code> &#x662F;&#x9019;&#x6A23;&#x5B9A;&#x7FA9;&#x4E86;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">ZipList</span> a = <span class="hljs-type">ZipList</span> { <span class="hljs-title">getZipList</span> :: [<span class="hljs-title">a</span>] }</span>
</code></pre>
<p>&#x9019;&#x908A;&#x6211;&#x5011;&#x4E0D;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x53CD;&#x800C;&#x662F;&#x7528; <code>newtype</code> &#x95DC;&#x9375;&#x5B57;&#x3002;&#x9019;&#x662F;&#x70BA;&#x4EC0;&#x9EBD;&#x5462;&#xFF1F;&#x7B2C;&#x4E00;&#x500B;&#x7406;&#x7531;&#x662F; <code>newtype</code> &#x6BD4;&#x8F03;&#x5FEB;&#x901F;&#x3002;&#x5982;&#x679C;&#x4F60;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x4F86;&#x5305;&#x4E00;&#x500B;&#x578B;&#x5225;&#x7684;&#x8A71;&#xFF0C;&#x5728;&#x4F60;&#x57F7;&#x884C;&#x7684;&#x6642;&#x5019;&#x6703;&#x6709;&#x4E00;&#x4E9B;&#x5305;&#x8D77;&#x4F86;&#x8DDF;&#x89E3;&#x958B;&#x4F86;&#x7684;&#x6210;&#x672C;&#x3002;&#x4F46;&#x5982;&#x679C;&#x4F60;&#x7528; <code>newtype</code> &#x7684;&#x8A71;&#xFF0C;Haskell &#x6703;&#x77E5;&#x9053;&#x4F60;&#x53EA;&#x662F;&#x8981;&#x5C07;&#x4E00;&#x500B;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x5305;&#x6210;&#x4E00;&#x500B;&#x65B0;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x4F60;&#x60F3;&#x8981;&#x5167;&#x90E8;&#x904B;&#x4F5C;&#x5B8C;&#x5168;&#x4E00;&#x6A23;&#x4F46;&#x53EA;&#x662F;&#x8981;&#x4E00;&#x500B;&#x5168;&#x65B0;&#x7684;&#x578B;&#x5225;&#x800C;&#x5DF2;&#x3002;&#x6709;&#x4E86;&#x9019;&#x500B;&#x6982;&#x5FF5;&#xFF0C;Haskell &#x53EF;&#x4EE5;&#x5C07;&#x5305;&#x88F9;&#x8DDF;&#x89E3;&#x958B;&#x4F86;&#x7684;&#x6210;&#x672C;&#x90FD;&#x53BB;&#x9664;&#x6389;&#x3002;</p>
<p>&#x90A3;&#x70BA;&#x4EC0;&#x9EBD;&#x6211;&#x5011;&#x4E0D;&#x662F;&#x4E00;&#x76F4;&#x4F7F;&#x7528; <code>newtype</code> &#x5462;&#xFF1F;&#x7576;&#x4F60;&#x7528; <code>newtype</code> &#x4F86;&#x88FD;&#x4F5C;&#x4E00;&#x500B;&#x65B0;&#x7684;&#x578B;&#x5225;&#x6642;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x5B9A;&#x7FA9;&#x55AE;&#x4E00;&#x4E00;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#xFF0C;&#x800C;&#x4E14;&#x90A3;&#x500B;&#x69CB;&#x9020;&#x5B50;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x500B;&#x6B04;&#x4F4D;&#x3002;&#x4F46;&#x4F7F;&#x7528; <code>data</code> &#x7684;&#x8A71;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8B93;&#x90A3;&#x500B;&#x578B;&#x5225;&#x6709;&#x597D;&#x5E7E;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#xFF0C;&#x4E26;&#x4E14;&#x6BCF;&#x500B;&#x69CB;&#x9020;&#x5B50;&#x53EF;&#x4EE5;&#x6709;&#x96F6;&#x500B;&#x6216;&#x591A;&#x500B;&#x6B04;&#x4F4D;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Profession</span> = <span class="hljs-type">Fighter</span> | <span class="hljs-type">Archer</span> | <span class="hljs-type">Accountant</span>  </span>

<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Race</span> = <span class="hljs-type">Human</span> | <span class="hljs-type">Elf</span> | <span class="hljs-type">Orc</span> | <span class="hljs-type">Goblin</span>  </span>

<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">PlayerCharacter</span> = <span class="hljs-type">PlayerCharacter</span> <span class="hljs-type">Race</span> <span class="hljs-type">Profession</span></span>
</code></pre>
<p>&#x7576;&#x4F7F;&#x7528; <code>newtype</code>&#x7684;&#x6642;&#x5019;&#xFF0C;&#x4F60;&#x662F;&#x88AB;&#x9650;&#x5236;&#x53EA;&#x80FD;&#x7528;&#x4E00;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x8DDF;&#x55AE;&#x4E00;&#x6B04;&#x4F4D;&#x3002;</p>
<p>&#x5C0D;&#x65BC; <code>newtype</code> &#x6211;&#x5011;&#x4E5F;&#x80FD;&#x4F7F;&#x7528; <code>deriving</code> &#x95DC;&#x9375;&#x5B57;&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5; derive &#x50CF;&#x662F; <code>Eq</code>, <code>Ord</code>, <code>Enum</code>, <code>Bounded</code>, <code>Show</code> &#x8DDF; <code>Read</code> &#x7684; instance&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x5C0D;&#x65B0;&#x7684;&#x578B;&#x5225;&#x505A; derive&#xFF0C;&#x90A3;&#x539F;&#x672C;&#x7684;&#x578B;&#x5225;&#x5FC5;&#x9808;&#x5DF2;&#x7D93;&#x5728;&#x90A3;&#x500B; typeclass &#x4E2D;&#x3002;&#x9019;&#x6A23;&#x5F88;&#x5408;&#x7406;&#xFF0C;&#x7562;&#x7ADF; <code>newtype</code> &#x5C31;&#x662F;&#x8981;&#x5C07;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x5305;&#x8D77;&#x4F86;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x6309;&#x7167;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x5F0F;&#x5B9A;&#x7FA9;&#x7684;&#x8A71;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x80FD;&#x5C0D;&#x6211;&#x5011;&#x7684;&#x578B;&#x5225;&#x505A;&#x5370;&#x51FA;&#x4EE5;&#x53CA;&#x6BD4;&#x8F03;&#x76F8;&#x7B49;&#x6027;&#x7684;&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">CharList</span> = <span class="hljs-type">CharList</span> { <span class="hljs-title">getCharList</span> :: [<span class="hljs-type">Char</span>] } <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Eq</span>, <span class="hljs-type">Show</span>)</span>
</code></pre>
<p>&#x6211;&#x5011;&#x4F86;&#x8DD1;&#x8DD1;&#x770B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">CharList</span> <span class="hljs-string">&quot;this will be shown!&quot;</span>  
<span class="hljs-type">CharList</span> {getCharList = <span class="hljs-string">&quot;this will be shown!&quot;</span>}  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">CharList</span> <span class="hljs-string">&quot;benny&quot;</span> == <span class="hljs-type">CharList</span> <span class="hljs-string">&quot;benny&quot;</span>  
<span class="hljs-type">True</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">CharList</span> <span class="hljs-string">&quot;benny&quot;</span> == <span class="hljs-type">CharList</span> <span class="hljs-string">&quot;oisters&quot;</span>  
<span class="hljs-type">False</span>
</code></pre>
<p>&#x5C0D;&#x65BC;&#x9019;&#x500B; <code>newtype</code>&#xFF0C;&#x4ED6;&#x7684;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x6709;&#x4E0B;&#x5217;&#x578B;&#x5225;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-type">CharList</span> :: [<span class="hljs-type">Char</span>] -&gt; <span class="hljs-type">CharList</span>
</code></pre>
<p>&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B; <code>[Char]</code> &#x7684;&#x503C;&#xFF0C;&#x4F8B;&#x5982; <code>&quot;my sharona&quot;</code> &#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; <code>CharList</code> &#x7684;&#x503C;&#x3002;&#x5F9E;&#x4E0A;&#x9762;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>CharList</code> &#x7684;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x7684;&#x7BC4;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7684;&#x78BA;&#x662F;&#x9019;&#x6A23;&#x3002;&#x76F8;&#x53CD;&#x5730;&#xFF0C;<code>getCharList</code> &#x5177;&#x6709;&#x4E0B;&#x5217;&#x7684;&#x578B;&#x5225;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">getCharList</span> :: <span class="hljs-type">CharList</span> -&gt; [<span class="hljs-type">Char</span>]
</code></pre>
<p>&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B; <code>CharList</code> &#x7684;&#x503C;&#x4E26;&#x5C07;&#x4ED6;&#x8F49;&#x6210; <code>[Char]</code>&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5C07;&#x9019;&#x500B;&#x60F3;&#x6210;&#x5305;&#x88DD;&#x8DDF;&#x89E3;&#x958B;&#x7684;&#x52D5;&#x4F5C;&#xFF0C;&#x4F46;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5C07;&#x4ED6;&#x60F3;&#x6210;&#x5F9E;&#x4E00;&#x500B;&#x578B;&#x5225;&#x8F49;&#x6210;&#x53E6;&#x4E00;&#x500B;&#x578B;&#x5225;&#x3002;</p>
<h3 id="using-newtype-to-make-type-class-instances">Using newtype to make type class instances</h3>
<p>&#x6709;&#x597D;&#x5E7E;&#x6B21;&#x6211;&#x5011;&#x60F3;&#x8981;&#x8B93;&#x6211;&#x5011;&#x7684;&#x578B;&#x5225;&#x5C6C;&#x65BC;&#x67D0;&#x500B; typeclass&#xFF0C;&#x4F46;&#x578B;&#x5225;&#x8B8A;&#x6578;&#x4E26;&#x6C92;&#x6709;&#x7B26;&#x5408;&#x6211;&#x5011;&#x60F3;&#x8981;&#x7684;&#x3002;&#x8981;&#x628A; <code>Maybe</code> &#x5B9A;&#x7FA9;&#x6210; <code>Functor</code> &#x7684; instance &#x5F88;&#x5BB9;&#x6613;&#xFF0C;&#x56E0;&#x70BA; <code>Functor</code> &#x9019;&#x500B; typeclass &#x88AB;&#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-type">Functor</span> f <span class="hljs-keyword">where</span></span>  
    fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
<p>&#x6211;&#x5011;&#x5148;&#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> <span class="hljs-type">Maybe</span> <span class="hljs-keyword">where</span></span>
</code></pre>
<p>&#x7136;&#x5F8C;&#x6211;&#x5011;&#x5BE6;&#x4F5C; <code>fmap</code>&#x3002;&#x7576;&#x6240;&#x6709;&#x7684;&#x578B;&#x5225;&#x8B8A;&#x6578;&#x88AB;&#x586B;&#x4E0A;&#x6642;&#xFF0C;&#x7531;&#x65BC; <code>Maybe</code> &#x53D6;&#x4EE3;&#x4E86; <code>Functor</code> &#x4E2D; <code>f</code> &#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6211;&#x5011;&#x770B;&#x770B; <code>fmap</code> &#x904B;&#x4F5C;&#x5728; <code>Maybe</code> &#x4E0A;&#x6642;&#x662F;&#x4EC0;&#x9EBD;&#x6A23;&#xFF0C;&#x4ED6;&#x6703;&#x50CF;&#x9019;&#x6A23;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">fmap</span> :: (a -&gt; b) -&gt; <span class="hljs-type">Maybe</span> a -&gt; <span class="hljs-type">Maybe</span> b
</code></pre>
<p><img src="img/shamrock.png" alt=""></p>
<p>&#x770B;&#x8D77;&#x4F86;&#x4E0D;&#x932F;&#x5427;&#xFF1F;&#x73FE;&#x5728;&#x6211;&#x5011;&#x60F3;&#x8981; tuple &#x6210;&#x70BA; <code>Functor</code> &#x7684;&#x4E00;&#x500B; instance&#xFF0C;&#x6240;&#x4EE5;&#x7576;&#x6211;&#x5011;&#x7528; <code>fmap</code> &#x4F86; map over &#x4E00;&#x500B; tuple &#x6642;&#xFF0C;&#x4ED6;&#x6703;&#x5148;&#x5957;&#x7528;&#x5230; tuple &#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x3002;&#x9019;&#x6A23;&#x7576;&#x6211;&#x5011;&#x505A; <code>fmap (+3) (1,1)</code> &#x6703;&#x5F97;&#x5230; <code>(4,1)</code>&#x3002;&#x4E0D;&#x904E;&#x8981;&#x5B9A;&#x7FA9;&#x51FA;&#x9019;&#x6A23;&#x7684; instance &#x6709;&#x4E9B;&#x56F0;&#x96E3;&#x3002;&#x5C0D;&#x65BC; <code>Maybe</code>&#xFF0C;&#x6211;&#x5011;&#x53EA;&#x8981;&#x5BEB; <code>instance Functor Maybe where</code>&#xFF0C;&#x9019;&#x662F;&#x56E0;&#x70BA;&#x5C0D;&#x65BC;&#x53EA;&#x5403;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x7684;&#x578B;&#x5225;&#x69CB;&#x9020;&#x5B50;&#x6211;&#x5011;&#x5F88;&#x5BB9;&#x6613;&#x5B9A;&#x7FA9;&#x6210; <code>Functor</code> &#x7684; instance&#x3002;&#x4F46;&#x5C0D;&#x65BC; <code>(a,b)</code> &#x9019;&#x6A23;&#x7684;&#x5C31;&#x6C92;&#x8FA6;&#x6CD5;&#x3002;&#x8981;&#x7E5E;&#x904E;&#x9019;&#x6A23;&#x7684;&#x56F0;&#x5883;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; <code>newtype</code> &#x4F86;&#x91CD;&#x65B0;&#x5B9A;&#x7FA9;&#x6211;&#x5011;&#x7684; tuple&#xFF0C;&#x9019;&#x6A23;&#x7B2C;&#x4E8C;&#x500B;&#x578B;&#x5225;&#x53C3;&#x6578;&#x5C31;&#x4EE3;&#x8868;&#x4E86; tuple &#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x90E8;&#x4EFD;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">Pair</span> b a = <span class="hljs-type">Pair</span> { <span class="hljs-title">getPair</span> :: (<span class="hljs-title">a</span>,<span class="hljs-title">b</span>) }</span>
</code></pre>
<p>&#x73FE;&#x5728;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C07;&#x4ED6;&#x5B9A;&#x7FA9;&#x6210; <code>Functor</code> &#x7684; instance&#xFF0C;&#x6240;&#x4EE5;&#x51FD;&#x6578;&#x88AB; map over tuple &#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x90E8;&#x4EFD;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Functor</span> (<span class="hljs-type">Pair</span> <span class="hljs-title">c</span>) <span class="hljs-keyword">where</span></span>  
    fmap f (<span class="hljs-type">Pair</span> (x,y)) = <span class="hljs-type">Pair</span> (f x, y)
</code></pre>
<p>&#x6B63;&#x5982;&#x4F60;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C0D; newtype &#x5B9A;&#x7FA9;&#x7684;&#x578B;&#x5225;&#x505A;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x3002;&#x6211;&#x5011;&#x7528;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x4F86;&#x62FF;&#x5230;&#x5E95;&#x5C64;&#x7684; tuple&#xFF0C;&#x7136;&#x5F8C;&#x6211;&#x5011;&#x5C07; <code>f</code> &#x4F86;&#x5957;&#x7528;&#x81F3; tuple &#x7684;&#x7B2C;&#x4E00;&#x500B;&#x90E8;&#x4EFD;&#xFF0C;&#x7136;&#x5F8C;&#x6211;&#x5011;&#x7528; <code>Pair</code> &#x9019;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x4F86;&#x5C07; tuple &#x8F49;&#x63DB;&#x6210; <code>Pair b a</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x554F; <code>fmap</code> &#x7684;&#x578B;&#x5225;&#x7A76;&#x7ADF;&#x662F;&#x4EC0;&#x9EBD;&#xFF0C;&#x4ED6;&#x6703;&#x662F;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">fmap</span> :: (a -&gt; b) -&gt; <span class="hljs-type">Pair</span> c a -&gt; <span class="hljs-type">Pair</span> c b
</code></pre>
<p>&#x6211;&#x5011;&#x8AAA;&#x904E; <code>instance Functor (Pair c) where</code> &#x8DDF; <code>Pair c</code> &#x53D6;&#x4EE3;&#x4E86; <code>Functor</code> &#x4E2D; <code>f</code> &#x7684;&#x4F4D;&#x7F6E;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-type">Functor</span> f <span class="hljs-keyword">where</span></span>  
    fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x5C07;&#x4E00;&#x500B; tuple &#x8F49;&#x63DB;&#x6210; <code>Pair b a</code>&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; <code>fmap</code> &#x4F86; map over &#x7B2C;&#x4E00;&#x500B;&#x90E8;&#x4EFD;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getPair $ fmap (*<span class="hljs-number">100</span>) (<span class="hljs-type">Pair</span> (<span class="hljs-number">2</span>,<span class="hljs-number">3</span>))  
(<span class="hljs-number">200</span>,<span class="hljs-number">3</span>)  
<span class="hljs-title">ghci</span>&gt; getPair $ fmap reverse (<span class="hljs-type">Pair</span> (<span class="hljs-string">&quot;london calling&quot;</span>, <span class="hljs-number">3</span>))  
(<span class="hljs-string">&quot;gnillac nodnol&quot;</span>,<span class="hljs-number">3</span>)
</code></pre>
<h3 id="on-newtype-laziness">On newtype laziness</h3>
<p>&#x6211;&#x5011;&#x63D0;&#x5230; <code>newtype</code> &#x4E00;&#x822C;&#x4F86;&#x8B1B;&#x6BD4; <code>data</code> &#x4F86;&#x5F97;&#x6709;&#x6548;&#x7387;&#x3002;<code>newtype</code> &#x80FD;&#x505A;&#x7684;&#x552F;&#x4E00;&#x4E00;&#x4EF6;&#x4E8B;&#x5C31;&#x662F;&#x5C07;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x5305;&#x6210;&#x65B0;&#x7684;&#x578B;&#x5225;&#x3002;&#x9019;&#x6A23; Haskell &#x5728;&#x5167;&#x90E8;&#x5C31;&#x80FD;&#x5C07;&#x65B0;&#x7684;&#x578B;&#x5225;&#x7684;&#x503C;&#x7528;&#x820A;&#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x64CD;&#x4F5C;&#x3002;&#x53EA;&#x662F;&#x8981;&#x8A18;&#x4F4F;&#x4ED6;&#x5011;&#x9084;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x578B;&#x5225;&#x3002;&#x9019;&#x4EE3;&#x8868; <code>newtype</code> &#x4E26;&#x4E0D;&#x53EA;&#x662F;&#x6709;&#x6548;&#x7387;&#xFF0C;&#x4ED6;&#x4E5F;&#x5177;&#x5099; lazy &#x7684;&#x7279;&#x6027;&#x3002;&#x6211;&#x5011;&#x4F86;&#x8AAA;&#x660E;&#x4E00;&#x4E0B;&#x9019;&#x662F;&#x4EC0;&#x9EBD;&#x610F;&#x601D;&#x3002;</p>
<p>&#x5C31;&#x50CF;&#x6211;&#x5011;&#x4E4B;&#x524D;&#x8AAA;&#x5F97;&#xFF0C;Haskell &#x9810;&#x8A2D;&#x662F;&#x5177;&#x5099; lazy &#x7684;&#x7279;&#x6027;&#xFF0C;&#x9019;&#x4EE3;&#x8868;&#x53EA;&#x6709;&#x7576;&#x6211;&#x5011;&#x8981;&#x5C07;&#x51FD;&#x6578;&#x7684;&#x7D50;&#x679C;&#x5370;&#x51FA;&#x4F86;&#x7684;&#x6642;&#x5019;&#x8A08;&#x7B97;&#x624D;&#x6703;&#x767C;&#x751F;&#x3002;&#x6216;&#x8005;&#x8AAA;&#xFF0C;&#x53EA;&#x6709;&#x7576;&#x6211;&#x5011;&#x771F;&#x7684;&#x9700;&#x8981;&#x7D50;&#x679C;&#x7684;&#x6642;&#x5019;&#x8A08;&#x7B97;&#x624D;&#x6703;&#x767C;&#x751F;&#x3002;&#x5728; Haskell &#x4E2D; <code>undefined</code> &#x4EE3;&#x8868;&#x6703;&#x9020;&#x6210;&#x932F;&#x8AA4;&#x7684;&#x8A08;&#x7B97;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x8A66;&#x8457;&#x8A08;&#x7B97;&#x4ED6;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5C07;&#x4ED6;&#x5370;&#x5230;&#x7D42;&#x7AEF;&#x4E2D;&#xFF0C;Haskell &#x6703;&#x4E1F;&#x51FA;&#x932F;&#x8AA4;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; undefined  
*** <span class="hljs-type">Exception</span>: <span class="hljs-type">Prelude</span>.undefined
</code></pre>
<p>&#x7136;&#x800C;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x5011;&#x505A;&#x4E00;&#x500B; list&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E00;&#x4E9B; <code>undefined</code> &#x7684;&#x503C;&#xFF0C;&#x4F46;&#x537B;&#x8981;&#x6C42;&#x4E00;&#x500B;&#x4E0D;&#x662F; <code>undefined</code> &#x7684; head&#xFF0C;&#x90A3;&#x4E00;&#x5207;&#x90FD;&#x6703;&#x9806;&#x5229;&#x5730;&#x88AB;&#x8A08;&#x7B97;&#xFF0C;&#x56E0;&#x70BA; Haskell &#x4E26;&#x4E0D;&#x9700;&#x8981; list &#x4E2D;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x4F86;&#x5F97;&#x5230;&#x7D50;&#x679C;&#x3002;&#x6211;&#x5011;&#x50C5;&#x50C5;&#x9700;&#x8981;&#x770B;&#x5230;&#x7B2C;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x800C;&#x5DF2;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; head [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,undefined,<span class="hljs-number">2</span>,undefined]  
<span class="hljs-number">3</span>
</code></pre>
<p>&#x73FE;&#x5728;&#x5011;&#x8003;&#x616E;&#x4E0B;&#x9762;&#x7684;&#x578B;&#x5225;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">CoolBool</span> = <span class="hljs-type">CoolBool</span> { <span class="hljs-title">getCoolBool</span> :: <span class="hljs-type">Bool</span> }</span>
</code></pre>
<p>&#x9019;&#x662F;&#x4E00;&#x500B;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x5B9A;&#x7FA9;&#x7684; algebraic data type&#x3002;&#x4ED6;&#x6709;&#x4E00;&#x500B;&#x503C;&#x5EFA;&#x69CB;&#x5B50;&#x4E26;&#x53EA;&#x6709;&#x4E00;&#x500B;&#x578B;&#x5225;&#x70BA; <code>Bool</code> &#x7684;&#x6B04;&#x4F4D;&#x3002;&#x6211;&#x5011;&#x5BEB;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x4F86;&#x5C0D; <code>CoolBool</code> &#x505A;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; <code>&quot;hello&quot;</code> &#x7684;&#x503C;&#x3002;&#x4ED6;&#x4E26;&#x4E0D;&#x6703;&#x7BA1; <code>CoolBool</code> &#x4E2D;&#x88DD;&#x7684;&#x7A76;&#x7ADF;&#x662F; <code>True</code> &#x6216; <code>False</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">helloMe</span> :: <span class="hljs-type">CoolBool</span> -&gt; <span class="hljs-type">String</span>  
<span class="hljs-title">helloMe</span> (<span class="hljs-type">CoolBool</span> _) = <span class="hljs-string">&quot;hello&quot;</span>
</code></pre>
<p>&#x9019;&#x6B21;&#x6211;&#x5011;&#x4E0D;&#x9935;&#x7D66;&#x9019;&#x500B;&#x51FD;&#x6578;&#x4E00;&#x500B;&#x666E;&#x901A;&#x7684; <code>CoolBool</code>&#xFF0C;&#x800C;&#x662F;&#x4E1F;&#x7D66;&#x4ED6;&#x4E00;&#x500B; <code>undefined</code>&#x3002;</p>
<pre><code class="lang-text">ghci&gt; helloMe undefined  
&quot;*** Exception: Prelude.undefined  &quot;
</code></pre>
<p>&#x7D50;&#x679C;&#x6536;&#x5230;&#x4E86;&#x4E00;&#x500B; Exception&#x3002;&#x662F;&#x4EC0;&#x9EBD;&#x9020;&#x6210;&#x9019;&#x500B; Exception &#x7684;&#x5462;&#xFF1F;&#x7528; <code>data</code> &#x5B9A;&#x7FA9;&#x7684;&#x578B;&#x5225;&#x53EF;&#x4EE5;&#x6709;&#x597D;&#x5E7E;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#xFF08;&#x5118;&#x7BA1; <code>CoolBool</code> &#x53EA;&#x6709;&#x4E00;&#x500B;&#xFF09;&#x6240;&#x4EE5;&#x7576;&#x6211;&#x5011;&#x8981;&#x770B;&#x770B;&#x9935;&#x7D66;&#x51FD;&#x6578;&#x7684;&#x503C;&#x662F;&#x5426;&#x662F; <code>(CoolBool _)</code> &#x7684;&#x5F62;&#x5F0F;&#xFF0C;Haskell &#x6703;&#x9700;&#x8981;&#x505A;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x8A08;&#x7B97;&#x4F86;&#x770B;&#x770B;&#x662F;&#x54EA;&#x500B;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x88AB;&#x7528;&#x5230;&#x3002;&#x4F46;&#x7576;&#x6211;&#x5011;&#x8A08;&#x7B97; <code>undefined</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x5C31;&#x7B97;&#x662F;&#x4E00;&#x9EDE;&#x4E5F;&#x6703;&#x4E1F;&#x51FA; Exception&#x3002;</p>
<p>&#x6211;&#x5011;&#x4E0D;&#x7528; <code>data</code> &#x4F86;&#x5B9A;&#x7FA9; <code>CoolBool</code> &#x800C;&#x7528; <code>newtype</code>&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">CoolBool</span> = <span class="hljs-type">CoolBool</span> { <span class="hljs-title">getCoolBool</span> :: <span class="hljs-type">Bool</span> }</span>
</code></pre>
<p>&#x6211;&#x5011;&#x4E0D;&#x7528;&#x4FEE;&#x6539; <code>helloMe</code> &#x51FD;&#x6578;&#xFF0C;&#x56E0;&#x70BA;&#x5C0D;&#x65BC;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x4F7F;&#x7528; <code>newtype</code> &#x6216; <code>data</code> &#x90FD;&#x662F;&#x4E00;&#x6A23;&#x3002;&#x6211;&#x5011;&#x518D;&#x4F86;&#x5C07; <code>undefined</code> &#x9935;&#x7D66; <code>helloMe</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; helloMe undefined  
<span class="hljs-string">&quot;hello&quot;</span>
</code></pre>
<p>&#x5C45;&#x7136;&#x6B63;&#x5E38;&#x904B;&#x4F5C;&#xFF01;&#x70BA;&#x4EC0;&#x9EBD;&#x5462;&#xFF1F;&#x6B63;&#x5982;&#x6211;&#x5011;&#x8AAA;&#x904E;&#x5F97;&#xFF0C;&#x7576;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>newtype</code> &#x7684;&#x6642;&#x5019;&#xFF0C;Haskell &#x5167;&#x90E8;&#x53EF;&#x4EE5;&#x5C07;&#x65B0;&#x7684;&#x578B;&#x5225;&#x7528;&#x820A;&#x7684;&#x578B;&#x5225;&#x4F86;&#x8868;&#x793A;&#x3002;&#x4ED6;&#x4E0D;&#x5FC5;&#x52A0;&#x5165;&#x53E6;&#x4E00;&#x5C64; box &#x4F86;&#x5305;&#x4F4F;&#x820A;&#x6709;&#x7684;&#x578B;&#x5225;&#x3002;&#x4ED6;&#x53EA;&#x8981;&#x6CE8;&#x610F;&#x4ED6;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x578B;&#x5225;&#x5C31;&#x597D;&#x4E86;&#x3002;&#x800C;&#x4E14; Haskell &#x6703;&#x77E5;&#x9053; <code>newtype</code> &#x5B9A;&#x7FA9;&#x7684;&#x578B;&#x5225;&#x4E00;&#x5B9A;&#x53EA;&#x6703;&#x6709;&#x4E00;&#x500B;&#x69CB;&#x9020;&#x5B50;&#xFF0C;&#x4ED6;&#x4E0D;&#x5FC5;&#x8A08;&#x7B97;&#x9935;&#x7D66;&#x51FD;&#x6578;&#x7684;&#x503C;&#x5C31;&#x80FD;&#x78BA;&#x5B9A;&#x4ED6;&#x662F; <code>(CoolBool _)</code> &#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x56E0;&#x70BA; <code>newtype</code> &#x53EA;&#x6709;&#x4E00;&#x500B;&#x53EF;&#x80FD;&#x7684;&#x503C;&#x8DDF;&#x55AE;&#x4E00;&#x6B04;&#x4F4D;&#xFF01;</p>
<p>&#x9019;&#x6A23;&#x884C;&#x70BA;&#x7684;&#x5DEE;&#x7570;&#x53EF;&#x80FD;&#x6C92;&#x4EC0;&#x9EBC;&#x95DC;&#x4FC2;&#xFF0C;&#x4F46;&#x5BE6;&#x969B;&#x4E0A;&#x4ED6;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x3002;&#x56E0;&#x70BA;&#x4ED6;&#x8B93;&#x6211;&#x5011;&#x8A8D;&#x77E5;&#x5230;&#x5118;&#x7BA1;&#x5F9E;&#x64B0;&#x5BEB;&#x7A0B;&#x5F0F;&#x7684;&#x89C0;&#x9EDE;&#x4F86;&#x770B;&#x6C92;&#x4EC0;&#x9EBD;&#x5DEE;&#x7570;&#xFF0C;&#x4F46;&#x4ED6;&#x5011;&#x7684;&#x78BA;&#x662F;&#x5169;&#x7A2E;&#x4E0D;&#x540C;&#x7684;&#x6A5F;&#x5236;&#x3002;&#x5118;&#x7BA1; <code>data</code> &#x53EF;&#x4EE5;&#x8B93;&#x4F60;&#x5F9E;&#x7121;&#x5230;&#x6709;&#x5B9A;&#x7FA9;&#x578B;&#x5225;&#xFF0C;<code>newtype</code> &#x662F;&#x5F9E;&#x4E00;&#x500B;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x505A;&#x51FA;&#x4F86;&#x7684;&#x3002;&#x5C0D; <code>newtype</code> &#x505A;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x4E26;&#x4E0D;&#x662F;&#x50CF;&#x5F9E;&#x76D2;&#x5B50;&#x4E2D;&#x53D6;&#x51FA;&#x6771;&#x897F;&#xFF0C;&#x4ED6;&#x6BD4;&#x8F03;&#x50CF;&#x662F;&#x5C07;&#x4E00;&#x500B;&#x578B;&#x5225;&#x8F49;&#x63DB;&#x6210;&#x53E6;&#x4E00;&#x500B;&#x578B;&#x5225;&#x3002;</p>
<h3 id="type-vs-newtype-vs-data">type vs newtype vs data</h3>
<p>&#x5230;&#x76EE;&#x524D;&#x70BA;&#x6B62;&#xFF0C;&#x4F60;&#x4E5F;&#x8A31;&#x5C0D;&#x65BC; <code>type</code>,<code>data</code> &#x8DDF; <code>newtype</code> &#x4E4B;&#x9593;&#x7684;&#x5DEE;&#x7570;&#x9084;&#x4E0D;&#x662F;&#x5F88;&#x77AD;&#x89E3;&#xFF0C;&#x8B93;&#x6211;&#x5011;&#x5FEB;&#x901F;&#x8907;&#x7FD2;&#x4E00;&#x904D;&#x3002;</p>
<p><code>type</code> &#x95DC;&#x9375;&#x5B57;&#x662F;&#x8B93;&#x6211;&#x5011;&#x5B9A;&#x7FA9; type synonyms&#x3002;&#x4ED6;&#x4EE3;&#x8868;&#x6211;&#x5011;&#x53EA;&#x662F;&#x8981;&#x7D66;&#x4E00;&#x500B;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x53E6;&#x4E00;&#x500B;&#x540D;&#x5B57;&#xFF0C;&#x5047;&#x8A2D;&#x6211;&#x5011;&#x9019;&#x6A23;&#x505A;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">IntList</span> = [<span class="hljs-type">Int</span>]</span>
</code></pre>
<p>&#x9019;&#x6A23;&#x505A;&#x53EF;&#x4EE5;&#x5141;&#x8A31;&#x6211;&#x5011;&#x7528; <code>IntList</code> &#x7684;&#x540D;&#x7A31;&#x4F86;&#x6307;&#x7A31; <code>[Int]</code>&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x4EA4;&#x63DB;&#x5730;&#x4F7F;&#x7528;&#x4ED6;&#x5011;&#x3002;&#x4F46;&#x6211;&#x5011;&#x4E26;&#x4E0D;&#x6703;&#x56E0;&#x6B64;&#x6709;&#x4E00;&#x500B; <code>IntList</code> &#x7684;&#x503C;&#x69CB;&#x9020;&#x5B50;&#x3002;&#x56E0;&#x70BA; <code>[Int]</code> &#x8DDF; <code>IntList</code> &#x53EA;&#x662F;&#x5169;&#x7A2E;&#x6307;&#x7A31;&#x540C;&#x4E00;&#x500B;&#x578B;&#x5225;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x6211;&#x5011;&#x5728;&#x6307;&#x7A31;&#x7684;&#x6642;&#x5019;&#x7528;&#x54EA;&#x4E00;&#x500B;&#x4E26;&#x7121;&#x6240;&#x8B02;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; ([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] :: <span class="hljs-type">IntList</span>) ++ ([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] :: [<span class="hljs-type">Int</span>])  
[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
</code></pre>
<p>&#x7576;&#x6211;&#x5011;&#x60F3;&#x8981;&#x8B93; type signature &#x66F4;&#x6E05;&#x695A;&#x4E00;&#x4E9B;&#xFF0C;&#x7D66;&#x4E88;&#x6211;&#x5011;&#x66F4;&#x77AD;&#x89E3;&#x51FD;&#x6578;&#x7684; context &#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5B9A;&#x7FA9; type synonyms&#x3002;&#x8209;&#x4F8B;&#x4F86;&#x8AAA;&#xFF0C;&#x7576;&#x6211;&#x5011;&#x7528;&#x4E00;&#x500B;&#x578B;&#x5225;&#x70BA; <code>[(String,String)]</code> &#x7684; association list &#x4F86;&#x4EE3;&#x8868;&#x4E00;&#x500B;&#x96FB;&#x8A71;&#x7C3F;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5B9A;&#x7FA9;&#x4E00;&#x500B; <code>PhoneBook</code> &#x7684; type synonym&#xFF0C;&#x9019;&#x6A23; type signature &#x6703;&#x6BD4;&#x8F03;&#x5BB9;&#x6613;&#x8B80;&#x3002;</p>
<p><code>newtype</code> &#x95DC;&#x9375;&#x5B57;&#x5C07;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x5305;&#x6210;&#x4E00;&#x500B;&#x65B0;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x662F;&#x70BA;&#x4E86;&#x8981;&#x8B93;&#x4ED6;&#x5011;&#x53EF;&#x4EE5;&#x662F;&#x7279;&#x5B9A; typeclass &#x7684; instance &#x800C;&#x9019;&#x6A23;&#x505A;&#x3002;&#x7576;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>newtype</code> &#x4F86;&#x5305;&#x88F9;&#x4E00;&#x500B;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x6642;&#xFF0C;&#x9019;&#x500B;&#x578B;&#x5225;&#x8DDF;&#x539F;&#x6709;&#x7684;&#x578B;&#x5225;&#x662F;&#x5206;&#x958B;&#x7684;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x5C07;&#x4E0B;&#x9762;&#x7684;&#x578B;&#x5225;&#x7528; <code>newtype</code> &#x5B9A;&#x7FA9;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">CharList</span> = <span class="hljs-type">CharList</span> { <span class="hljs-title">getCharList</span> :: [<span class="hljs-type">Char</span>] }</span>
</code></pre>
<p>&#x6211;&#x5011;&#x4E0D;&#x80FD;&#x7528; <code>++</code> &#x4F86;&#x5C07; <code>CharList</code> &#x8DDF; <code>[Char]</code> &#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x6211;&#x5011;&#x4E5F;&#x4E0D;&#x80FD;&#x7528; <code>++</code> &#x4F86;&#x5C07;&#x5169;&#x500B; <code>CharList</code> &#x63A5;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x56E0;&#x70BA; <code>++</code> &#x53EA;&#x80FD;&#x5957;&#x7528;&#x5728; list &#x4E0A;&#xFF0C;&#x800C; <code>CharList</code> &#x4E26;&#x4E0D;&#x662F; list&#xFF0C;&#x5118;&#x7BA1;&#x4F60;&#x6703;&#x8AAA;&#x4ED6;&#x5305;&#x542B;&#x4E00;&#x500B; list&#x3002;&#x4F46;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5C07;&#x5169;&#x500B; <code>CharList</code> &#x8F49;&#x6210; list&#xFF0C;&#x5C07;&#x4ED6;&#x5011; <code>++</code> &#x7136;&#x5F8C;&#x518D;&#x8F49;&#x56DE; <code>CharList</code>&#x3002;</p>
<p>&#x7576;&#x6211;&#x5011;&#x5728; <code>newtype</code> &#x5BA3;&#x544A;&#x4E2D;&#x4F7F;&#x7528; record syntax &#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5F97;&#x5230;&#x5C07;&#x65B0;&#x7684;&#x578B;&#x5225;&#x8F49;&#x6210;&#x820A;&#x7684;&#x578B;&#x5225;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x5011; <code>newtype</code> &#x7684;&#x503C;&#x69CB;&#x9020;&#x5B50;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x5C07;&#x4ED6;&#x7684;&#x6B04;&#x4F4D;&#x53D6;&#x51FA;&#x3002;&#x65B0;&#x7684;&#x578B;&#x5225;&#x4E26;&#x4E0D;&#x6703;&#x88AB;&#x81EA;&#x52D5;&#x5B9A;&#x7FA9;&#x6210;&#x539F;&#x6709;&#x578B;&#x5225;&#x6240;&#x5C6C;&#x7684; typeclass &#x7684;&#x4E00;&#x500B; instance&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x81EA;&#x5DF1;&#x4F86; derive &#x4ED6;&#x5011;&#x3002;</p>
<p>&#x5BE6;&#x969B;&#x4E0A;&#x4F60;&#x53EF;&#x4EE5;&#x5C07; <code>newtype</code> &#x60F3;&#x6210;&#x662F;&#x53EA;&#x80FD;&#x5B9A;&#x7FA9;&#x4E00;&#x500B;&#x69CB;&#x9020;&#x5B50;&#x8DDF;&#x4E00;&#x500B;&#x6B04;&#x4F4D;&#x7684; <code>data</code> &#x5BA3;&#x544A;&#x3002;&#x5982;&#x679C;&#x4F60;&#x78B0;&#x5230;&#x9019;&#x7A2E;&#x60C5;&#x5F62;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x616E;&#x4F7F;&#x7528; <code>newtype</code>&#x3002;</p>
<p>&#x4F7F;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x662F;&#x70BA;&#x4E86;&#x5B9A;&#x7FA9;&#x81EA;&#x5DF1;&#x7684;&#x578B;&#x5225;&#x3002;&#x4ED6;&#x5011;&#x53EF;&#x4EE5;&#x5728; algebraic data type &#x4E2D;&#x653E;&#x4EFB;&#x610F;&#x6578;&#x91CF;&#x7684;&#x69CB;&#x9020;&#x5B50;&#x8DDF;&#x6B04;&#x4F4D;&#x3002;&#x53EF;&#x4EE5;&#x5B9A;&#x7FA9;&#x7684;&#x6771;&#x897F;&#x5F9E; list, <code>Maybe</code> &#x5230; tree&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x53EA;&#x662F;&#x5E0C;&#x671B;&#x4F60;&#x7684; type signature &#x770B;&#x8D77;&#x4F86;&#x6BD4;&#x8F03;&#x4E7E;&#x6DE8;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x53EA;&#x9700;&#x8981; type synonym&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8981;&#x5C07;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#x5305;&#x8D77;&#x4F86;&#x4E26;&#x5B9A;&#x7FA9;&#x6210;&#x4E00;&#x500B; type class &#x7684; instance&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5617;&#x8A66;&#x4F7F;&#x7528; newtype&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8981;&#x5B9A;&#x7FA9;&#x5B8C;&#x5168;&#x65B0;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x90A3;&#x4F60;&#x61C9;&#x8A72;&#x4F7F;&#x7528; <code>data</code> &#x95DC;&#x9375;&#x5B57;&#x3002;</p>
<h2 id="monoids">Monoids</h2>
<p>Haskell &#x4E2D; typeclass &#x662F;&#x7528;&#x4F86;&#x8868;&#x793A;&#x4E00;&#x500B;&#x578B;&#x5225;&#x4E4B;&#x9593;&#x5171;&#x6709;&#x7684;&#x884C;&#x70BA;&#xFF0C;&#x662F;&#x4E00;&#x7A2E; interface&#x3002;&#x6211;&#x5011;&#x4ECB;&#x7D39;&#x904E; <code>Eq</code>&#xFF0C;&#x4ED6;&#x5B9A;&#x7FA9;&#x578B;&#x5225;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x6BD4;&#x8F03;&#x76F8;&#x7B49;&#x6027;&#xFF0C;&#x4EE5;&#x53CA; <code>Ord</code>&#xFF0C;&#x4ED6;&#x8868;&#x793A;&#x53EF;&#x4EE5;&#x88AB;&#x6392;&#x5E8F;&#x7684;&#x578B;&#x5225;&#x3002;&#x9084;&#x4ECB;&#x7D39;&#x4E86;&#x66F4;&#x6709;&#x8DA3;&#x7684;&#x50CF;&#x662F; <code>Functor</code> &#x8DDF; <code>Applicative</code>&#x3002;</p>
<p>&#x7576;&#x6211;&#x5011;&#x5B9A;&#x7FA9;&#x4E00;&#x500B;&#x578B;&#x5225;&#x6642;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x60F3;&#x8AAA;&#x4ED6;&#x61C9;&#x8A72;&#x8981;&#x652F;&#x63F4;&#x7684;&#x884C;&#x70BA;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8868;&#x73FE;&#x7684;&#x884C;&#x70BA;&#x662F;&#x4EC0;&#x9EBD;&#xFF0C;&#x4E26;&#x4E14;&#x8981;&#x8B93;&#x4ED6;&#x5C6C;&#x65BC;&#x54EA;&#x4E9B; typeclass&#x3002;&#x5982;&#x679C;&#x5E0C;&#x671B;&#x4ED6;&#x53EF;&#x4EE5;&#x6BD4;&#x8F03;&#x76F8;&#x7B49;&#x8207;&#x5426;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x61C9;&#x8A72;&#x5B9A;&#x7FA9;&#x4ED6;&#x6210;&#x70BA; <code>Eq</code> &#x7684;&#x4E00;&#x500B; instance&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x770B;&#x770B;&#x578B;&#x5225;&#x662F;&#x5426;&#x662F;&#x4E00;&#x7A2E; functor&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5B9A;&#x7FA9;&#x4ED6;&#x662F; <code>Functor</code> &#x7684;&#x4E00;&#x500B; instance&#x3002;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;</p>
<p>&#x8003;&#x616E; <code>*</code> &#x662F;&#x4E00;&#x500B;&#x5C07;&#x5169;&#x500B;&#x6578;&#x503C;&#x76F8;&#x4E58;&#x7684;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x5C07;&#x4E00;&#x500B;&#x6578;&#x503C;&#x4E58;&#x4E0A; <code>1</code>&#xFF0C;&#x90A3;&#x5C31;&#x6703;&#x5F97;&#x5230;&#x81EA;&#x8EAB;&#x7684;&#x6578;&#x503C;&#x3002;&#x6211;&#x5011;&#x5BE6;&#x969B;&#x4E0A;&#x662F;&#x505A; <code>1 * x</code> &#x6216; <code>x * 1</code> &#x4E26;&#x6C92;&#x6709;&#x5DEE;&#x5225;&#x3002;&#x7D50;&#x679C;&#x6C38;&#x9060;&#x6703;&#x662F; <code>x</code>&#x3002;&#x540C;&#x6A23;&#x7684;&#xFF0C;<code>++</code> &#x662F;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;&#x4E26;&#x56DE;&#x50B3;&#x65B0;&#x7684;&#x503C;&#x7684;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x3002;&#x53EA;&#x662F;&#x4ED6;&#x4E0D;&#x662F;&#x76F8;&#x4E58;&#x800C;&#x662F;&#x5C07;&#x5169;&#x500B; list &#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x800C;&#x985E;&#x4F3C; <code>*</code>&#xFF0C;&#x4ED6;&#x4E5F;&#x6709;&#x4E00;&#x500B;&#x7279;&#x5B9A;&#x7684;&#x503C;&#xFF0C;&#x7576;&#x4ED6;&#x8DDF;&#x5176;&#x4ED6;&#x503C;&#x4F7F;&#x7528; <code>++</code> &#x6642;&#x6703;&#x5F97;&#x5230;&#x540C;&#x6A23;&#x7684;&#x503C;&#x3002;&#x90A3;&#x500B;&#x503C;&#x5C31;&#x662F;&#x7A7A;&#x7684; list <code>[]</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-number">4</span> * <span class="hljs-number">1</span>  
<span class="hljs-number">4</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-number">1</span> * <span class="hljs-number">9</span>  
<span class="hljs-number">9</span>  
<span class="hljs-title">ghci</span>&gt; [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] ++ []  
[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
<span class="hljs-title">ghci</span>&gt; [] ++ [<span class="hljs-number">0.5</span>, <span class="hljs-number">2.5</span>]  
[<span class="hljs-number">0.5</span>,<span class="hljs-number">2.5</span>]
</code></pre>
<p>&#x770B;&#x8D77;&#x4F86; <code>*</code> &#x4E4B;&#x65BC; <code>1</code> &#x8DDF; <code>++</code> &#x4E4B;&#x65BC; <code>[]</code> &#x6709;&#x985E;&#x4F3C;&#x7684;&#x6027;&#x8CEA;&#xFF1A;</p>
<pre><code class="lang-text"># &#x51FD;&#x6578;&#x540C;&#x6A23;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x53C3;&#x6578;
# &#x53C3;&#x6578;&#x8DDF;&#x56DE;&#x50B3;&#x503C;&#x662F;&#x540C;&#x6A23;&#x7684;&#x578B;&#x5225;
# &#x540C;&#x6A23;&#x5B58;&#x5728;&#x67D0;&#x4E9B;&#x503C;&#x7576;&#x5957;&#x7528;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x6642;&#x4E26;&#x4E0D;&#x6703;&#x6539;&#x8B8A;&#x5176;&#x4ED6;&#x503C;
</code></pre>
<p>&#x95DC;&#x65BC;&#x9019;&#x5169;&#x7A2E;&#x64CD;&#x4F5C;&#x9084;&#x6709;&#x53E6;&#x4E00;&#x500B;&#x6BD4;&#x8F03;&#x96E3;&#x5BDF;&#x89BA;&#x7684;&#x6027;&#x8CEA;&#x5C31;&#x662F;&#xFF0C;&#x7576;&#x6211;&#x5011;&#x5C0D;&#x9019;&#x500B;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x5C0D;&#x4E09;&#x500B;&#x4EE5;&#x4E0A;&#x7684;&#x503C;&#x64CD;&#x4F5C;&#x4E26;&#x5316;&#x7C21;&#xFF0C;&#x51FD;&#x6578;&#x5957;&#x7528;&#x7684;&#x9806;&#x5E8F;&#x4E26;&#x4E0D;&#x6703;&#x5F71;&#x97FF;&#x5230;&#x7D50;&#x679C;&#x3002;&#x4E0D;&#x8AD6;&#x662F; <code>(3 * 4) * 5</code> &#x6216;&#x662F; <code>3 * (4 * 5)</code>&#xFF0C;&#x5169;&#x7A2E;&#x65B9;&#x5F0F;&#x90FD;&#x6703;&#x5F97;&#x5230; <code>60</code>&#x3002;&#x800C; <code>++</code> &#x4E5F;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; (<span class="hljs-number">3</span> * <span class="hljs-number">2</span>) * (<span class="hljs-number">8</span> * <span class="hljs-number">5</span>)  
<span class="hljs-number">240</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-number">3</span> * (<span class="hljs-number">2</span> * (<span class="hljs-number">8</span> * <span class="hljs-number">5</span>))  
<span class="hljs-number">240</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-string">&quot;la&quot;</span> ++ (<span class="hljs-string">&quot;di&quot;</span> ++ <span class="hljs-string">&quot;da&quot;</span>)  
<span class="hljs-string">&quot;ladida&quot;</span>  
<span class="hljs-title">ghci</span>&gt; (<span class="hljs-string">&quot;la&quot;</span> ++ <span class="hljs-string">&quot;di&quot;</span>) ++ <span class="hljs-string">&quot;da&quot;</span>  
<span class="hljs-string">&quot;ladida&quot;</span>
</code></pre>
<p>&#x6211;&#x5011;&#x7A31;&#x547C;&#x9019;&#x6A23;&#x7684;&#x6027;&#x8CEA;&#x70BA;&#x7D50;&#x5408;&#x5F8B;(associativity)&#x3002;<code>*</code> &#x9075;&#x5B88;&#x7D50;&#x5408;&#x5F8B;&#xFF0C;<code>++</code> &#x4E5F;&#x662F;&#x3002;&#x4F46; <code>-</code> &#x5C31;&#x4E0D;&#x9075;&#x5B88;&#x3002;<code>(5 - 3) - 4</code> &#x8DDF; <code>5 - (3 - 4)</code> &#x5F97;&#x5230;&#x7684;&#x7D50;&#x679C;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x5230;&#x9019;&#x4E9B;&#x6027;&#x8CEA;&#x4E26;&#x5177;&#x9AD4;&#x5730;&#x5BEB;&#x4E0B;&#x4F86;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230; monoid&#x3002;&#x4E00;&#x500B; monoid &#x662F;&#x4F60;&#x6709;&#x4E00;&#x500B;&#x9075;&#x5B88;&#x7D50;&#x5408;&#x5F8B;&#x7684;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x9084;&#x6709;&#x4E00;&#x500B;&#x53EF;&#x4EE5;&#x76F8;&#x5C0D;&#x65BC;&#x90A3;&#x500B;&#x51FD;&#x6578;&#x4F5C;&#x70BA; identity &#x7684;&#x503C;&#x3002;&#x7576;&#x67D0;&#x500B;&#x503C;&#x76F8;&#x5C0D;&#x65BC;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x662F;&#x4E00;&#x500B; identity&#xFF0C;&#x4ED6;&#x8868;&#x793A;&#x7576;&#x6211;&#x5011;&#x5C07;&#x9019;&#x500B;&#x503C;&#x4E1F;&#x7D66;&#x51FD;&#x6578;&#x6642;&#xFF0C;&#x7D50;&#x679C;&#x6C38;&#x9060;&#x6703;&#x662F;&#x53E6;&#x5916;&#x4E00;&#x908A;&#x7684;&#x90A3;&#x500B;&#x503C;&#x672C;&#x8EAB;&#x3002;<code>1</code> &#x662F;&#x76F8;&#x5C0D;&#x65BC; <code>*</code> &#x7684; identity&#xFF0C;&#x800C; <code>[]</code> &#x662F;&#x76F8;&#x5C0D;&#x65BC; <code>++</code> &#x7684; identity&#x3002;&#x5728; Haskell &#x4E2D;&#x9084;&#x6709;&#x8A31;&#x591A;&#x5176;&#x4ED6;&#x7684; monoid&#xFF0C;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBD;&#x6211;&#x5011;&#x5B9A;&#x7FA9;&#x4E86; <code>Monoid</code> &#x9019;&#x500B; typeclass&#x3002;&#x4ED6;&#x63CF;&#x8FF0;&#x4E86;&#x8868;&#x73FE;&#x6210; monoid &#x7684;&#x90A3;&#x4E9B;&#x578B;&#x5225;&#x3002;&#x6211;&#x5011;&#x4F86;&#x770B;&#x770B;&#x9019;&#x500B; typeclass &#x662F;&#x600E;&#x9EBC;&#x88AB;&#x5B9A;&#x7FA9;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-type">Monoid</span> m <span class="hljs-keyword">where</span></span>  
    mempty :: m  
    mappend :: m -&gt; m -&gt; m  
    mconcat :: [m] -&gt; m  
    mconcat = foldr mappend mempty
</code></pre>
<p><img src="img/balloondog.png" alt=""></p>
<p><code>Monoid</code> typeclass &#x88AB;&#x5B9A;&#x7FA9;&#x5728; <code>import Data.Monoid</code> &#x4E2D;&#x3002;&#x6211;&#x5011;&#x4F86;&#x82B1;&#x4E9B;&#x6642;&#x9593;&#x597D;&#x597D;&#x77AD;&#x89E3;&#x4ED6;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x5011;&#x770B;&#x5230;&#x53EA;&#x6709;&#x5177;&#x9AD4;&#x578B;&#x5225;&#x624D;&#x80FD;&#x5B9A;&#x7FA9;&#x6210; <code>Monoid</code> &#x7684; instance&#x3002;&#x7531;&#x65BC;&#x5728; typeclass &#x5B9A;&#x7FA9;&#x4E2D;&#x7684; <code>m</code> &#x4E26;&#x4E0D;&#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x578B;&#x5225;&#x53C3;&#x6578;&#x3002;&#x9019;&#x8DDF; <code>Functor</code> &#x4EE5;&#x53CA; <code>Applicative</code> &#x4E0D;&#x540C;&#xFF0C;&#x4ED6;&#x5011;&#x8981;&#x6C42;&#x4ED6;&#x5011;&#x7684; instance &#x5FC5;&#x9808;&#x662F;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x55AE;&#x4E00;&#x578B;&#x5225;&#x53C3;&#x6578;&#x7684;&#x578B;&#x5225;&#x69CB;&#x9020;&#x5B50;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x662F; <code>mempty</code>&#xFF0C;&#x7531;&#x65BC;&#x4ED6;&#x4E0D;&#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x53C3;&#x6578;&#xFF0C;&#x6240;&#x4EE5;&#x4ED6;&#x4E26;&#x4E0D;&#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x500B; polymorphic &#x7684;&#x5E38;&#x6578;&#x3002;&#x6709;&#x9EDE;&#x50CF;&#x662F; <code>Bounded</code> &#x4E2D;&#x7684; <code>minBound</code> &#x4E00;&#x6A23;&#x3002;<code>mempty</code> &#x8868;&#x793A;&#x4E00;&#x500B;&#x7279;&#x5B9A; monoid &#x7684; identity&#x3002;</p>
<p>&#x518D;&#x4F86;&#x6211;&#x5011;&#x770B;&#x5230; <code>mappend</code>&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x5DF2;&#x7D93;&#x731C;&#x5230;&#xFF0C;&#x4ED6;&#x662F;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x5169;&#x500B;&#x76F8;&#x540C;&#x578B;&#x5225;&#x7684;&#x503C;&#x7684;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x540C;&#x6A23;&#x7684;&#x578B;&#x5225;&#x3002;&#x4E0D;&#x904E;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#x4E0D;&#x592A;&#x7B26;&#x5408;&#x4ED6;&#x771F;&#x6B63;&#x7684;&#x610F;&#x601D;&#xFF0C;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#x96B1;&#x542B;&#x4E86;&#x6211;&#x5011;&#x8981;&#x5C07;&#x5169;&#x500B;&#x6771;&#x897F;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x5118;&#x7BA1;&#x5728; list &#x7684;&#x60C5;&#x6CC1;&#x4E0B; <code>++</code> &#x7684;&#x78BA;&#x5C07;&#x5169;&#x500B; list &#x63A5;&#x8D77;&#x4F86;&#xFF0C;&#x4F46; <code>*</code> &#x5247;&#x5426;&#x3002;&#x4ED6;&#x53EA;&#x4E0D;&#x904E;&#x5C07;&#x5169;&#x500B;&#x6578;&#x503C;&#x505A;&#x76F8;&#x4E58;&#x3002;&#x7576;&#x6211;&#x5011;&#x518D;&#x770B;&#x5230;&#x5176;&#x4ED6; <code>Monoid</code> &#x7684; instance &#x6642;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x770B;&#x5230;&#x4ED6;&#x5011;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x6C92;&#x6709;&#x63A5;&#x8D77;&#x4F86;&#x7684;&#x505A;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x8981;&#x7528;&#x63A5;&#x8D77;&#x4F86;&#x7684;&#x6982;&#x5FF5;&#x4F86;&#x60F3;&#x50CF; <code>mappend</code>&#xFF0C;&#x53EA;&#x8981;&#x60F3;&#x50CF;&#x4ED6;&#x5011;&#x662F;&#x63A5;&#x53D7;&#x5169;&#x500B; monoid &#x7684;&#x503C;&#x4E26;&#x56DE;&#x50B3;&#x53E6;&#x5916;&#x4E00;&#x500B;&#x5C31;&#x597D;&#x4E86;&#x3002;</p>
<p>&#x5728; typeclass &#x5B9A;&#x7FA9;&#x4E2D;&#x7684;&#x6700;&#x5F8C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x662F; <code>mconcat</code>&#x3002;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x4E32; monoid &#x503C;&#xFF0C;&#x4E26;&#x5C07;&#x4ED6;&#x5011;&#x7528; <code>mappend</code> &#x7C21;&#x5316;&#x6210;&#x55AE;&#x4E00;&#x7684;&#x503C;&#x3002;&#x4ED6;&#x6709;&#x4E00;&#x500B;&#x9810;&#x8A2D;&#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x5C31;&#x662F;&#x5F9E; <code>mempty</code> &#x4F5C;&#x70BA;&#x8D77;&#x59CB;&#x503C;&#xFF0C;&#x7136;&#x5F8C;&#x7528; <code>mappend</code> &#x4F86; fold&#x3002;&#x7531;&#x65BC;&#x5C0D;&#x65BC;&#x5927;&#x90E8;&#x5206;&#x7684; instance &#x9810;&#x8A2D;&#x7684;&#x5BE6;&#x4F5C;&#x5C31;&#x6C92;&#x4EC0;&#x9EBC;&#x554F;&#x984C;&#xFF0C;&#x6211;&#x5011;&#x4E0D;&#x6703;&#x60F3;&#x8981;&#x5BE6;&#x4F5C;&#x81EA;&#x5DF1;&#x7684; <code>mconcat</code>&#x3002;&#x7576;&#x6211;&#x5011;&#x5B9A;&#x7FA9;&#x4E00;&#x500B;&#x578B;&#x5225;&#x5C6C;&#x65BC; <code>Monoid</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x591A;&#x534A;&#x5BE6;&#x4F5C; <code>mempty</code> &#x8DDF; <code>mappend</code> &#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;&#x800C; <code>mconcat</code> &#x5C31;&#x662F;&#x56E0;&#x70BA;&#x5C0D;&#x65BC;&#x4E00;&#x4E9B; instance&#xFF0C;&#x6709;&#x53EF;&#x80FD;&#x6709;&#x6BD4;&#x8F03;&#x6709;&#x6548;&#x7387;&#x7684;&#x65B9;&#x5F0F;&#x4F86;&#x5BE6;&#x4F5C; <code>mconcat</code>&#x3002;&#x4E0D;&#x904E;&#x5927;&#x591A;&#x6578;&#x60C5;&#x6CC1;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x3002;</p>
<p>&#x5728;&#x6211;&#x5011;&#x7E7C;&#x7E8C;&#x63A5;&#x4E0B;&#x53BB;&#x770B;&#x5E7E;&#x500B; <code>Monoid</code> &#x7684;&#x4F8B;&#x5B50;&#x524D;&#xFF0C;&#x6211;&#x5011;&#x4F86;&#x770B;&#x4E00;&#x4E0B; monoid law&#x3002;&#x6211;&#x5011;&#x63D0;&#x904E;&#x5FC5;&#x9808;&#x6709;&#x4E00;&#x500B;&#x503C;&#x4F5C;&#x70BA; identity &#x4EE5;&#x53CA;&#x4E00;&#x500B;&#x9075;&#x5B88;&#x7D50;&#x5408;&#x5F8B;&#x7684;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x7576;&#x4F5C;&#x524D;&#x63D0;&#x3002;&#x6211;&#x5011;&#x662F;&#x53EF;&#x4EE5;&#x5B9A;&#x7FA9;&#x4E00;&#x500B; <code>Monoid</code> &#x7684; instance &#x537B;&#x4E0D;&#x9075;&#x5B88;&#x9019;&#x4E9B;&#x5B9A;&#x5F8B;&#x7684;&#xFF0C;&#x4F46;&#x9019;&#x6A23;&#x5BEB;&#x51FA;&#x4F86;&#x7684; instance &#x5C31;&#x6C92;&#x6709;&#x7528;&#x4E86;&#xFF0C;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x5728;&#x4F7F;&#x7528; <code>Monoid</code> &#x7684;&#x6642;&#x5019;&#x90FD;&#x662F;&#x4F9D;&#x9760;&#x9019;&#x4E9B;&#x5B9A;&#x5F8B;&#x624D;&#x53EF;&#x4EE5;&#x7A31;&#x4F5C;&#x5BE6;&#x8CEA;&#x4E0A;&#x7684; monoid&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x78BA;&#x4FDD;&#x4ED6;&#x5011;&#x9075;&#x5B88;&#xFF1A;</p>
<pre><code class="lang-text"># ``mempty `mappend` x = x``
# ``x `mappend` mempty = x``
# ``(x `mappend` y) `mappend` z = x `mappend` (y `mappend` z)``
</code></pre>
<p>&#x524D;&#x5169;&#x500B;&#x63CF;&#x8FF0;&#x4E86; <code>mempty</code> &#x76F8;&#x5C0D;&#x65BC; <code>mappend</code> &#x5FC5;&#x9808;&#x8981;&#x8868;&#x73FE;&#x6210; identity&#x3002;&#x800C;&#x7B2C;&#x4E09;&#x500B;&#x5B9A;&#x5F8B;&#x8AAA;&#x4E86; <code>mappend</code> &#x5FC5;&#x9808;&#x8981;&#x9075;&#x5B88;&#x7D50;&#x5408;&#x5F8B;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8AAA;&#x6211;&#x5011;&#x505A; <code>mappend</code> &#x9806;&#x5E8F;&#x4E26;&#x4E0D;&#x91CD;&#x8981;&#x3002;Haskell &#x4E0D;&#x6703;&#x81EA;&#x5DF1;&#x6AA2;&#x67E5;&#x9019;&#x4E9B;&#x5B9A;&#x5F8B;&#x662F;&#x5426;&#x6709;&#x88AB;&#x9075;&#x5B88;&#x3002;&#x6240;&#x4EE5;&#x4F60;&#x5FC5;&#x9808;&#x81EA;&#x5DF1;&#x5C0F;&#x5FC3;&#x5730;&#x6AA2;&#x67E5;&#x4ED6;&#x5011;&#x3002;</p>
<h3 id="lists-are-monoids">Lists are monoids</h3>
<p>&#x6C92;&#x932F;&#xFF0C;list &#x662F;&#x4E00;&#x7A2E; monoid&#x3002;&#x6B63;&#x5982;&#x6211;&#x5011;&#x5148;&#x524D;&#x770B;&#x5230;&#x7684;&#xFF0C;<code>++</code> &#x8DDF;&#x7A7A;&#x7684; list <code>[]</code> &#x5171;&#x540C;&#x5F62;&#x6210;&#x4E86;&#x4E00;&#x500B; monoid&#x3002;&#x4ED6;&#x7684; instance &#x5F88;&#x7C21;&#x55AE;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Monoid</span> [a] <span class="hljs-keyword">where</span></span>  
    mempty = []  
    mappend = (++)
</code></pre>
<p>list &#x662F; <code>Monoid</code> typeclass &#x7684;&#x4E00;&#x500B; instance&#xFF0C;&#x9019;&#x8DDF;&#x4ED6;&#x5011;&#x88DD;&#x7684;&#x5143;&#x7D20;&#x7684;&#x578B;&#x5225;&#x7121;&#x95DC;&#x3002;&#x6CE8;&#x610F;&#x5230;&#x6211;&#x5011;&#x5BEB; <code>instance Monoid [a]</code> &#x800C;&#x975E; <code>instance Monoid []</code>&#xFF0C;&#x9019;&#x662F;&#x56E0;&#x70BA; <code>Monoid</code> &#x8981;&#x6C42; instance &#x5FC5;&#x9808;&#x662F;&#x5177;&#x9AD4;&#x578B;&#x5225;&#x3002;</p>
<p>&#x6211;&#x5011;&#x8A66;&#x8457;&#x8DD1;&#x8DD1;&#x770B;&#xFF0C;&#x5F97;&#x5230;&#x6211;&#x5011;&#x9810;&#x671F;&#x4E2D;&#x7684;&#x7D50;&#x679C;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] `mappend` [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]  
[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]  
<span class="hljs-title">ghci</span>&gt; (<span class="hljs-string">&quot;one&quot;</span> `mappend` <span class="hljs-string">&quot;two&quot;</span>) `mappend` <span class="hljs-string">&quot;tree&quot;</span>  
<span class="hljs-string">&quot;onetwotree&quot;</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-string">&quot;one&quot;</span> `mappend` (<span class="hljs-string">&quot;two&quot;</span> `mappend` <span class="hljs-string">&quot;tree&quot;</span>)  
<span class="hljs-string">&quot;onetwotree&quot;</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-string">&quot;one&quot;</span> `mappend` <span class="hljs-string">&quot;two&quot;</span> `mappend` <span class="hljs-string">&quot;tree&quot;</span>  
<span class="hljs-string">&quot;onetwotree&quot;</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-string">&quot;pang&quot;</span> `mappend` mempty  
<span class="hljs-string">&quot;pang&quot;</span>  
<span class="hljs-title">ghci</span>&gt; mconcat [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">9</span>]]  
[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>]  
<span class="hljs-title">ghci</span>&gt; mempty :: [a]  
[]
</code></pre>
<p><img src="img/smug.png" alt=""></p>
<p>&#x6CE8;&#x610F;&#x5230;&#x6700;&#x5F8C;&#x4E00;&#x884C;&#x6211;&#x5011;&#x660E;&#x767D;&#x5730;&#x6A19;&#x8A18;&#x51FA;&#x578B;&#x5225;&#x3002;&#x9019;&#x662F;&#x56E0;&#x70BA;&#x5982;&#x679C;&#x53EA;&#x4E9B; <code>mempty</code> &#x7684;&#x8A71;&#xFF0C;GHCi &#x4E0D;&#x6703;&#x77E5;&#x9053;&#x4ED6;&#x662F;&#x54EA;&#x4E00;&#x500B; instance &#x7684; <code>mempty</code>&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5FC5;&#x9808;&#x6E05;&#x695A;&#x8AAA;&#x51FA;&#x4ED6;&#x662F; list instance &#x7684; mempty&#x3002;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x822C;&#x5316;&#x7684;&#x578B;&#x5225; <code>[a]</code>&#xFF0C;&#x56E0;&#x70BA;&#x7A7A;&#x7684; list &#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;&#x5C6C;&#x65BC;&#x4EFB;&#x4F55;&#x578B;&#x5225;&#x3002;</p>
<p>&#x7531;&#x65BC; <code>mconcat</code> &#x6709;&#x4E00;&#x500B;&#x9810;&#x8A2D;&#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x6211;&#x5011;&#x5C07;&#x67D0;&#x500B;&#x578B;&#x5225;&#x5B9A;&#x7FA9;&#x6210; <code>Monoid</code> &#x7684;&#x578B;&#x5225;&#x6642;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52D5;&#x5730;&#x5F97;&#x5230;&#x9810;&#x8A2D;&#x7684;&#x5BE6;&#x4F5C;&#x3002;&#x4F46;&#x5C0D;&#x65BC; list &#x800C;&#x8A00;&#xFF0C;<code>mconcat</code> &#x5176;&#x5BE6;&#x5C31;&#x662F; <code>concat</code>&#x3002;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x88DD;&#x6709; list &#x7684; list&#xFF0C;&#x4E26;&#x628A;&#x4ED6;&#x7528; <code>++</code> &#x4F86;&#x6241;&#x5E73;&#x5316;&#x4ED6;&#x3002;</p>
<p>list &#x7684; instance &#x4E5F;&#x9075;&#x5B88; monoid law&#x3002;&#x7576;&#x6211;&#x5011;&#x6709;&#x597D;&#x5E7E;&#x500B; list &#x4E26;&#x4E14;&#x7528; <code>mappend</code> &#x4F86;&#x628A;&#x4ED6;&#x5011;&#x4E32;&#x8D77;&#x4F86;&#xFF0C;&#x5148;&#x5F8C;&#x9806;&#x5E8F;&#x4E26;&#x4E0D;&#x662F;&#x5F88;&#x91CD;&#x8981;&#xFF0C;&#x56E0;&#x70BA;&#x4ED6;&#x5011;&#x90FD;&#x662F;&#x63A5;&#x5728;&#x6700;&#x5F8C;&#x9762;&#x3002;&#x800C;&#x4E14;&#x7A7A;&#x7684; list &#x4E5F;&#x8868;&#x73FE;&#x5F97;&#x5982; identity &#x4E00;&#x6A23;&#x3002;&#x6CE8;&#x610F;&#x5230; monoid &#x4E26;&#x4E0D;&#x8981;&#x6C42; <code>a `mappend` b</code> &#x7B49;&#x65BC; <code>b `mappend` a</code>&#x3002;&#x5728; list &#x7684;&#x60C5;&#x6CC1;&#x4E0B;&#xFF0C;&#x4ED6;&#x5011;&#x660E;&#x986F;&#x4E0D;&#x76F8;&#x7B49;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-string">&quot;one&quot;</span> `mappend` <span class="hljs-string">&quot;two&quot;</span>  
<span class="hljs-string">&quot;onetwo&quot;</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-string">&quot;two&quot;</span> `mappend` <span class="hljs-string">&quot;one&quot;</span>  
<span class="hljs-string">&quot;twoone&quot;</span>
</code></pre>
<p>&#x9019;&#x6A23;&#x4E26;&#x6C92;&#x6709;&#x95DC;&#x7CFB;&#x3002;<code>3 * 5</code> &#x8DDF; <code>5 * 3</code> &#x6703;&#x76F8;&#x7B49;&#x53EA;&#x4E0D;&#x904E;&#x662F;&#x4E58;&#x6CD5;&#x7684;&#x6027;&#x8CEA;&#x800C;&#x5DF2;&#xFF0C;&#x4F46;&#x6C92;&#x6709;&#x4FDD;&#x8B49;&#x6240;&#x6709; monoid &#x90FD;&#x8981;&#x9075;&#x5B88;&#x3002;</p>
<h3 id="product-and-sum">Product and Sum</h3>
<p>&#x6211;&#x5011;&#x5DF2;&#x7D93;&#x63CF;&#x8FF0;&#x904E;&#x5C07;&#x6578;&#x503C;&#x8868;&#x73FE;&#x6210;&#x4E00;&#x7A2E; monoid &#x7684;&#x65B9;&#x5F0F;&#x3002;&#x53EA;&#x8981;&#x5C07; <code>*</code> &#x7576;&#x4F5C;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x800C; <code>1</code> &#x7576;&#x4F5C; identity &#x5C31;&#x597D;&#x4E86;&#x3002;&#x800C;&#x4E14;&#x9019;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x4E00;&#x7A2E;&#x65B9;&#x5F0F;&#xFF0C;&#x53E6;&#x4E00;&#x7A2E;&#x65B9;&#x5F0F;&#x662F;&#x5C07; <code>+</code> &#x4F5C;&#x70BA;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x800C; <code>0</code> &#x4F5C;&#x70BA; identity&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-number">0</span> + <span class="hljs-number">4</span>  
<span class="hljs-number">4</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-number">5</span> + <span class="hljs-number">0</span>  
<span class="hljs-number">5</span>  
<span class="hljs-title">ghci</span>&gt; (<span class="hljs-number">1</span> + <span class="hljs-number">3</span>) + <span class="hljs-number">5</span>  
<span class="hljs-number">9</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-number">1</span> + (<span class="hljs-number">3</span> + <span class="hljs-number">5</span>)  
<span class="hljs-number">9</span>
</code></pre>
<p>&#x4ED6;&#x4E5F;&#x9075;&#x5B88; monoid law&#xFF0C;&#x56E0;&#x70BA;&#x5C07; 0 &#x52A0;&#x4E0A;&#x5176;&#x4ED6;&#x6578;&#x503C;&#xFF0C;&#x90FD;&#x6703;&#x662F;&#x53E6;&#x5916;&#x4E00;&#x8005;&#x3002;&#x800C;&#x4E14;&#x52A0;&#x6CD5;&#x4E5F;&#x9075;&#x5B88;&#x7D50;&#x5408;&#x5F8B;&#x3002;&#x6240;&#x4EE5;&#x73FE;&#x5728;&#x6211;&#x5011;&#x6709;&#x5169;&#x7A2E;&#x65B9;&#x5F0F;&#x4F86;&#x5C07;&#x6578;&#x503C;&#x8868;&#x73FE;&#x6210; monoid&#xFF0C;&#x90A3;&#x8981;&#x9078;&#x54EA;&#x4E00;&#x500B;&#x5462;&#xFF1F;&#x5176;&#x5BE6;&#x6211;&#x5011;&#x4E0D;&#x5FC5;&#x8981;&#x5F37;&#x8FEB;&#x5B9A;&#x4E0B;&#x4F86;&#xFF0C;&#x9084;&#x8A18;&#x5F97;&#x7576;&#x540C;&#x4E00;&#x7A2E;&#x578B;&#x5225;&#x6709;&#x597D;&#x5E7E;&#x7A2E;&#x8868;&#x73FE;&#x6210;&#x67D0;&#x500B; typeclass &#x7684;&#x65B9;&#x5F0F;&#x6642;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x7528; <code>newtype</code> &#x4F86;&#x5305;&#x88F9;&#x73FE;&#x6709;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x7136;&#x5F8C;&#x518D;&#x5B9A;&#x7FA9;&#x65B0;&#x7684; instance&#x3002;&#x9019;&#x6A23;&#x5C31;&#x884C;&#x4E86;&#x3002;</p>
<p><code>Data.Monoid</code> &#x9019;&#x500B;&#x6A21;&#x7D44;&#x532F;&#x51FA;&#x4E86;&#x5169;&#x7A2E;&#x578B;&#x5225;&#xFF0C;<code>Product</code> &#x8DDF; <code>Sum</code>&#x3002;<code>Product</code> &#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">Product</span> a =  <span class="hljs-type">Product</span> { <span class="hljs-title">getProduct</span> :: <span class="hljs-title">a</span> }  </span>
    <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Eq</span>, <span class="hljs-type">Ord</span>, <span class="hljs-type">Read</span>, <span class="hljs-type">Show</span>, <span class="hljs-type">Bounded</span>)
</code></pre>
<p>&#x7C21;&#x55AE;&#x6613;&#x61C2;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x500B;&#x55AE;&#x4E00;&#x578B;&#x5225;&#x53C3;&#x6578;&#x7684; <code>newtype</code>&#xFF0C;&#x4E26; derive &#x4E00;&#x4E9B;&#x6027;&#x8CEA;&#x3002;&#x4ED6;&#x7684; <code>Monoid</code> &#x7684; instance &#x9577;&#x5F97;&#x50CF;&#x9019;&#x6A23;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Num</span> a =&gt; <span class="hljs-type">Monoid</span> (<span class="hljs-type">Product</span> <span class="hljs-title">a</span>) <span class="hljs-keyword">where</span></span>  
    mempty = <span class="hljs-type">Product</span> <span class="hljs-number">1</span>  
    <span class="hljs-type">Product</span> x `mappend` <span class="hljs-type">Product</span> y = <span class="hljs-type">Product</span> (x * y)
</code></pre>
<p><code>mempty</code> &#x53EA;&#x4E0D;&#x904E;&#x662F;&#x5C07; <code>1</code> &#x5305;&#x5728; <code>Product</code> &#x4E2D;&#x3002;<code>mappend</code> &#x5247;&#x5C0D; <code>Product</code> &#x7684;&#x69CB;&#x9020;&#x5B50;&#x505A;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#xFF0C;&#x5C07;&#x5169;&#x500B;&#x53D6;&#x51FA;&#x7684;&#x6578;&#x503C;&#x76F8;&#x4E58;&#x5F8C;&#x518D;&#x5C07;&#x7D50;&#x679C;&#x653E;&#x56DE;&#x53BB;&#x3002;&#x5C31;&#x5982;&#x4F60;&#x770B;&#x5230;&#x7684;&#xFF0C;typeclass &#x5B9A;&#x7FA9;&#x524D;&#x9762;&#x6709; <code>Num a</code> &#x7684;&#x689D;&#x4EF6;&#x9650;&#x5236;&#x3002;&#x6240;&#x4EE5;&#x4ED6;&#x4EE3;&#x8868; <code>Product a</code> &#x5C0D;&#x65BC;&#x6240;&#x6709;&#x5C6C;&#x65BC; <code>Num</code> &#x7684; <code>a</code> &#x662F;&#x4E00;&#x500B; <code>Monoid</code>&#x3002;&#x8981;&#x5C07; <code>Product a</code> &#x4F5C;&#x70BA;&#x4E00;&#x500B; monoid &#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x5011;&#x9700;&#x8981;&#x7528; newtype &#x4F86;&#x505A;&#x5305;&#x88F9;&#x8DDF;&#x89E3;&#x958B;&#x7684;&#x52D5;&#x4F5C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getProduct $ <span class="hljs-type">Product</span> <span class="hljs-number">3</span> `mappend` <span class="hljs-type">Product</span> <span class="hljs-number">9</span>  
<span class="hljs-number">27</span>  
<span class="hljs-title">ghci</span>&gt; getProduct $ <span class="hljs-type">Product</span> <span class="hljs-number">3</span> `mappend` mempty  
<span class="hljs-number">3</span>  
<span class="hljs-title">ghci</span>&gt; getProduct $ <span class="hljs-type">Product</span> <span class="hljs-number">3</span> `mappend` <span class="hljs-type">Product</span> <span class="hljs-number">4</span> `mappend` <span class="hljs-type">Product</span> <span class="hljs-number">2</span>  
<span class="hljs-number">24</span>  
<span class="hljs-title">ghci</span>&gt; getProduct . mconcat . map <span class="hljs-type">Product</span> $ [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>]  
<span class="hljs-number">24</span>
</code></pre>
<p>&#x9019;&#x7576;&#x4F5C; <code>Monoid</code> &#x7684;&#x4E00;&#x500B;&#x6F14;&#x7DF4;&#x9084;&#x4E0D;&#x932F;&#xFF0C;&#x4F46;&#x4E26;&#x4E0D;&#x6703;&#x6709;&#x4EBA;&#x89BA;&#x5F97;&#x9019;&#x6703;&#x6BD4; <code>3 * 9</code> &#x8DDF; <code>3 * 1</code> &#x9019;&#x7A2E;&#x65B9;&#x5F0F;&#x4F86;&#x505A;&#x4E58;&#x6CD5;&#x8981;&#x597D;&#x3002;&#x4F46;&#x6211;&#x5011;&#x7A0D;&#x5F8C;&#x6703;&#x8AAA;&#x660E;&#x5118;&#x7BA1;&#x50CF;&#x9019;&#x7A2E;&#x986F;&#x800C;&#x6613;&#x898B;&#x7684;&#x5B9A;&#x7FA9;&#x9084;&#x662F;&#x6709;&#x4ED6;&#x65B9;&#x4FBF;&#x7684;&#x5730;&#x65B9;&#x3002;</p>
<p><code>Sum</code> &#x8DDF; <code>Product</code> &#x5B9A;&#x7FA9;&#x7684;&#x65B9;&#x5F0F;&#x985E;&#x4F3C;&#xFF0C;&#x6211;&#x5011;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x985E;&#x4F3C;&#x7684;&#x65B9;&#x5F0F;&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getSum $ <span class="hljs-type">Sum</span> <span class="hljs-number">2</span> `mappend` <span class="hljs-type">Sum</span> <span class="hljs-number">9</span>  
<span class="hljs-number">11</span>  
<span class="hljs-title">ghci</span>&gt; getSum $ mempty `mappend` <span class="hljs-type">Sum</span> <span class="hljs-number">3</span>  
<span class="hljs-number">3</span>  
<span class="hljs-title">ghci</span>&gt; getSum . mconcat . map <span class="hljs-type">Sum</span> $ [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
<span class="hljs-number">6</span>
</code></pre>
<h3 id="any-and-all">Any and ALL</h3>
<p>&#x53E6;&#x4E00;&#x7A2E;&#x53EF;&#x4EE5;&#x6709;&#x5169;&#x7A2E;&#x8868;&#x793A;&#x6210; monoid &#x65B9;&#x5F0F;&#x7684;&#x578B;&#x5225;&#x662F; <code>Bool</code>&#x3002;&#x7B2C;&#x4E00;&#x7A2E;&#x65B9;&#x5F0F;&#x662F;&#x5C07; <code>||</code> &#x7576;&#x4F5C;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#xFF0C;&#x800C; <code>False</code> &#x4F5C;&#x70BA; identity&#x3002;&#x9019;&#x6A23;&#x7684;&#x610F;&#x601D;&#x662F;&#x53EA;&#x8981;&#x6709;&#x4EFB;&#x4F55;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F; <code>True</code> &#x4ED6;&#x5C31;&#x56DE;&#x50B3; <code>True</code>&#xFF0C;&#x5426;&#x5247;&#x56DE;&#x50B3; <code>False</code>&#x3002;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>False</code> &#x4F5C;&#x70BA; identity&#xFF0C;&#x4ED6;&#x6703;&#x5728;&#x8DDF; <code>False</code> &#x505A; OR &#x6642;&#x56DE;&#x50B3; <code>False</code>&#xFF0C;&#x8DDF; <code>True</code> &#x505A; OR &#x6642;&#x56DE;&#x50B3; <code>True</code>&#x3002;<code>Any</code> &#x9019;&#x500B; newtype &#x662F; <code>Monoid</code> &#x7684;&#x4E00;&#x500B; instance&#xFF0C;&#x4E26;&#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">Any</span> = <span class="hljs-type">Any</span> { <span class="hljs-title">getAny</span> :: <span class="hljs-type">Bool</span> }  </span>
    <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Eq</span>, <span class="hljs-type">Ord</span>, <span class="hljs-type">Read</span>, <span class="hljs-type">Show</span>, <span class="hljs-type">Bounded</span>)
</code></pre>
<p>&#x4ED6;&#x7684; instance &#x9577;&#x5F97;&#x50CF;&#x9019;&#x6A23;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Monoid</span> <span class="hljs-type">Any</span> <span class="hljs-keyword">where</span></span>  
    mempty = <span class="hljs-type">Any</span> <span class="hljs-type">False</span>  
    <span class="hljs-type">Any</span> x `mappend` <span class="hljs-type">Any</span> y = <span class="hljs-type">Any</span> (x || y)
</code></pre>
<p>&#x4ED6;&#x53EB;&#x505A; <code>Any</code> &#x7684;&#x7406;&#x7531;&#x662F; <code>x `mappend` y</code> &#x7576;&#x6709;&#x4EFB;&#x4F55;&#x4E00;&#x500B;&#x662F; <code>True</code> &#x6642;&#x5C31;&#x6703;&#x662F; <code>True</code>&#x3002;&#x5C31;&#x7B97;&#x662F;&#x66F4;&#x591A;&#x500B;&#x7528; <code>mappend</code> &#x4E32;&#x8D77;&#x4F86;&#x7684; <code>Any</code>&#xFF0C;&#x4ED6;&#x4E5F;&#x6703;&#x5728;&#x4EFB;&#x4F55;&#x4E00;&#x500B;&#x662F; <code>True</code> &#x56DE;&#x50B3; <code>True</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getAny $ <span class="hljs-type">Any</span> <span class="hljs-type">True</span> `mappend` <span class="hljs-type">Any</span> <span class="hljs-type">False</span>  
<span class="hljs-type">True</span>  
<span class="hljs-title">ghci</span>&gt; getAny $ mempty `mappend` <span class="hljs-type">Any</span> <span class="hljs-type">True</span>  
<span class="hljs-type">True</span>  
<span class="hljs-title">ghci</span>&gt; getAny . mconcat . map <span class="hljs-type">Any</span> $ [<span class="hljs-type">False</span>, <span class="hljs-type">False</span>, <span class="hljs-type">False</span>, <span class="hljs-type">True</span>]  
<span class="hljs-type">True</span>  
<span class="hljs-title">ghci</span>&gt; getAny $ mempty `mappend` mempty  
<span class="hljs-type">False</span>
</code></pre>
<p>&#x53E6;&#x4E00;&#x7A2E; <code>Bool</code> &#x8868;&#x73FE;&#x6210; <code>Monoid</code> &#x7684;&#x65B9;&#x5F0F;&#x662F;&#x7528; <code>&amp;&amp;</code> &#x4F5C;&#x70BA;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#xFF0C;&#x800C; <code>True</code> &#x4F5C;&#x70BA; identity&#x3002;&#x53EA;&#x6709;&#x7576;&#x6240;&#x6709;&#x90FD;&#x662F; <code>True</code> &#x7684;&#x6642;&#x5019;&#x624D;&#x6703;&#x56DE;&#x50B3; <code>True</code>&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4ED6;&#x7684; newtype &#x5B9A;&#x7FA9;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">All</span> = <span class="hljs-type">All</span> { <span class="hljs-title">getAll</span> :: <span class="hljs-type">Bool</span> }  </span>
        <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Eq</span>, <span class="hljs-type">Ord</span>, <span class="hljs-type">Read</span>, <span class="hljs-type">Show</span>, <span class="hljs-type">Bounded</span>)
</code></pre>
<p>&#x800C;&#x9019;&#x662F;&#x4ED6;&#x7684; instance&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Monoid</span> <span class="hljs-type">All</span> <span class="hljs-keyword">where</span></span>  
        mempty = <span class="hljs-type">All</span> <span class="hljs-type">True</span>  
        <span class="hljs-type">All</span> x `mappend` <span class="hljs-type">All</span> y = <span class="hljs-type">All</span> (x &amp;&amp; y)
</code></pre>
<p>&#x7576;&#x6211;&#x5011;&#x7528; <code>mappend</code> &#x4F86;&#x4E32;&#x8D77; <code>All</code> &#x578B;&#x5225;&#x7684;&#x503C;&#x6642;&#xFF0C;&#x7D50;&#x679C;&#x53EA;&#x6709;&#x7576;&#x6240;&#x6709; <code>mappend</code> &#x7684;&#x503C;&#x662F; <code>True</code> &#x6642;&#x624D;&#x6703;&#x662F; <code>True</code>&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getAll $ mempty `mappend` <span class="hljs-type">All</span> <span class="hljs-type">True</span>  
<span class="hljs-type">True</span>  
<span class="hljs-title">ghci</span>&gt; getAll $ mempty `mappend` <span class="hljs-type">All</span> <span class="hljs-type">False</span>  
<span class="hljs-type">False</span>  
<span class="hljs-title">ghci</span>&gt; getAll . mconcat . map <span class="hljs-type">All</span> $ [<span class="hljs-type">True</span>, <span class="hljs-type">True</span>, <span class="hljs-type">True</span>]  
<span class="hljs-type">True</span>  
<span class="hljs-title">ghci</span>&gt; getAll . mconcat . map <span class="hljs-type">All</span> $ [<span class="hljs-type">True</span>, <span class="hljs-type">True</span>, <span class="hljs-type">False</span>]  
<span class="hljs-type">False</span>
</code></pre>
<p>&#x5C31;&#x5982;&#x4E58;&#x6CD5;&#x8DDF;&#x52A0;&#x6CD5;&#x4E00;&#x6A23;&#xFF0C;&#x6211;&#x5011;&#x901A;&#x5E38;&#x5BE7;&#x9858;&#x7528;&#x4E8C;&#x5143;&#x51FD;&#x6578;&#x4F86;&#x64CD;&#x4F5C;&#x4ED6;&#x5011;&#x4E5F;&#x4E0D;&#x6703;&#x7528; newtype &#x4F86;&#x5C07;&#x4ED6;&#x5011;&#x5305;&#x8D77;&#x4F86;&#x3002;&#x4E0D;&#x6703;&#x5C07;&#x4ED6;&#x5011;&#x5305;&#x6210; <code>Any</code> &#x6216; <code>All</code> &#x7136;&#x5F8C;&#x7528; <code>mappend</code>&#xFF0C;<code>mempty</code> &#x6216; <code>mconcat</code> &#x4F86;&#x64CD;&#x4F5C;&#x3002;&#x901A;&#x5E38;&#x4F7F;&#x7528; <code>or</code> &#x8DDF; <code>and</code>&#xFF0C;&#x4ED6;&#x5011;&#x63A5;&#x53D7;&#x4E00;&#x4E32; <code>Bool</code>&#xFF0C;&#x4E26;&#x53EA;&#x6709;&#x7576;&#x4EFB;&#x610F;&#x4E00;&#x500B;&#x6216;&#x662F;&#x6240;&#x6709;&#x90FD;&#x662F; <code>True</code> &#x7684;&#x6642;&#x5019;&#x624D;&#x56DE;&#x50B3; <code>True</code>&#x3002;</p>
<h3 id="the-ordering-monoid">The Ordering monoid</h3>
<p>&#x9084;&#x8A18;&#x5F97; <code>Ordering</code> &#x578B;&#x5225;&#x55CE;?&#x4ED6;&#x662F;&#x6BD4;&#x8F03;&#x904B;&#x7B97;&#x4E4B;&#x5F8C;&#x5F97;&#x5230;&#x7684;&#x7D50;&#x679C;&#xFF0C;&#x5305;&#x542B;&#x4E09;&#x500B;&#x503C;&#xFF1A;<code>LT</code>&#xFF0C;<code>EQ</code> &#x8DDF; <code>GT</code>&#xFF0C;&#x5206;&#x5225;&#x4EE3;&#x8868;&#x5C0F;&#x65BC;&#xFF0C;&#x7B49;&#x65BC;&#x8DDF;&#x5927;&#x65BC;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-number">1</span> `compare` <span class="hljs-number">2</span>  
<span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-number">2</span> `compare` <span class="hljs-number">2</span>  
<span class="hljs-type">EQ</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-number">3</span> `compare` <span class="hljs-number">2</span>  
<span class="hljs-type">GT</span>
</code></pre>
<p>&#x91DD;&#x5C0D; list&#xFF0C;&#x6578;&#x503C;&#x8DDF;&#x5E03;&#x6797;&#x503C;&#x800C;&#x8A00;&#xFF0C;&#x8981;&#x627E;&#x51FA; monoid &#x7684;&#x884C;&#x70BA;&#x53EA;&#x8981;&#x53BB;&#x6AA2;&#x8996;&#x5DF2;&#x7D93;&#x5B9A;&#x7FA9;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x7136;&#x5F8C;&#x770B;&#x770B;&#x6709;&#x6C92;&#x6709;&#x5C55;&#x73FE;&#x51FA; monoid &#x7684;&#x7279;&#x6027;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x4F46;&#x5C0D;&#x65BC; <code>Ordering</code>&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x5FC5;&#x9808;&#x8981;&#x66F4;&#x4ED4;&#x7D30;&#x4E00;&#x9EDE;&#x624D;&#x80FD;&#x770B;&#x51FA;&#x4F86;&#x662F;&#x5426;&#x662F;&#x4E00;&#x500B; monoid&#xFF0C;&#x4F46;&#x5176;&#x5BE6;&#x4ED6;&#x7684; <code>Monoid</code> instance &#x9084;&#x883B;&#x76F4;&#x89BA;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Monoid</span> <span class="hljs-type">Ordering</span> <span class="hljs-keyword">where</span></span>  
    mempty = <span class="hljs-type">EQ</span>  
    <span class="hljs-type">LT</span> `mappend` _ = <span class="hljs-type">LT</span>  
    <span class="hljs-type">EQ</span> `mappend` y = y  
    <span class="hljs-type">GT</span> `mappend` _ = <span class="hljs-type">GT</span>
</code></pre>
<p><img src="img/bear.png" alt=""></p>
<p>&#x9019;&#x500B; instance &#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;&#x7576;&#x6211;&#x5011;&#x7528; <code>mappend</code> &#x5169;&#x500B; <code>Ordering</code> &#x578B;&#x5225;&#x7684;&#x503C;&#x6642;&#xFF0C;&#x5DE6;&#x908A;&#x7684;&#x6703;&#x88AB;&#x4FDD;&#x7559;&#x4E0B;&#x4F86;&#x3002;&#x9664;&#x975E;&#x5DE6;&#x908A;&#x7684;&#x503C;&#x662F; <code>EQ</code>&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x6703;&#x4FDD;&#x7559;&#x53F3;&#x908A;&#x7684;&#x7576;&#x4F5C;&#x7D50;&#x679C;&#x3002;&#x800C; identity &#x5C31;&#x662F; <code>EQ</code>&#x3002;&#x4E4D;&#x770B;&#x4E4B;&#x4E0B;&#x6709;&#x9EDE;&#x96A8;&#x4FBF;&#xFF0C;&#x4F46;&#x5BE6;&#x969B;&#x4E0A;&#x4ED6;&#x662F;&#x6211;&#x5011;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x82F1;&#x6587;&#x5B57;&#x6642;&#x6240;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x6211;&#x5011;&#x5148;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x5B57;&#x6BCD;&#x662F;&#x5426;&#x76F8;&#x7B49;&#xFF0C;&#x5982;&#x679C;&#x4ED6;&#x5011;&#x4E0D;&#x4E00;&#x6A23;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x77E5;&#x9053;&#x90A3;&#x4E00;&#x500B;&#x5B57;&#x5728;&#x5B57;&#x5178;&#x4E2D;&#x6703;&#x5728;&#x524D;&#x9762;&#x3002;&#x800C;&#x5982;&#x679C;&#x5169;&#x500B;&#x5B57;&#x6BCD;&#x76F8;&#x7B49;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x7E7C;&#x7E8C;&#x6BD4;&#x8F03;&#x4E0B;&#x4E00;&#x500B;&#x5B57;&#x6BCD;&#xFF0C;&#x4EE5;&#x6B64;&#x985E;&#x63A8;&#x3002;</p>
<p>&#x8209;&#x4F8B;&#x4F86;&#x8AAA;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x5011;&#x5B57;&#x5178;&#x9806;&#x5E8F;&#x5730;&#x6BD4;&#x8F03; <code>&quot;ox&quot;</code> &#x8DDF; <code>&quot;on&quot;</code> &#x7684;&#x8A71;&#x3002;&#x6211;&#x5011;&#x6703;&#x5148;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x5B57;&#x7684;&#x9996;&#x500B;&#x5B57;&#x6BCD;&#xFF0C;&#x770B;&#x770B;&#x4ED6;&#x5011;&#x662F;&#x5426;&#x76F8;&#x7B49;&#xFF0C;&#x7136;&#x5F8C;&#x7E7C;&#x7E8C;&#x6BD4;&#x8F03;&#x7B2C;&#x4E8C;&#x500B;&#x5B57;&#x6BCD;&#x3002;&#x6211;&#x5011;&#x770B;&#x5230; <code>&apos;x&apos;</code> &#x662F;&#x6BD4; <code>&apos;n&apos;</code> &#x8981;&#x4F86;&#x5F97;&#x5927;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5C31;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x5B57;&#x4E86;&#x3002;&#x800C;&#x8981;&#x77AD;&#x89E3;&#x70BA;&#x4F55; <code>EQ</code> &#x662F; identity&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x6CE8;&#x610F;&#x5230;&#x5982;&#x679C;&#x6211;&#x5011;&#x5728;&#x5169;&#x500B;&#x5B57;&#x4E2D;&#x9593;&#x7684;&#x540C;&#x6A23;&#x4F4D;&#x7F6E;&#x585E;&#x5165;&#x540C;&#x6A23;&#x7684;&#x5B57;&#x6BCD;&#xFF0C;&#x90A3;&#x4ED6;&#x5011;&#x4E4B;&#x9593;&#x7684;&#x5B57;&#x5178;&#x9806;&#x5E8F;&#x4E26;&#x4E0D;&#x6703;&#x6539;&#x8B8A;&#x3002;<code>&quot;oix&quot;</code> &#x4ECD;&#x7136;&#x6BD4; <code>&quot;oin&quot;</code> &#x8981;&#x5927;&#x3002;</p>
<p>&#x5F88;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4EF6;&#x4E8B;&#x662F;&#x5728; <code>Ordering</code> &#x7684; <code>Monoid</code> &#x5B9A;&#x7FA9;&#x88E1; <code>x `mappend` y</code> &#x4E26;&#x4E0D;&#x7B49;&#x65BC; <code>y `mappend` x</code>&#x3002;&#x56E0;&#x70BA;&#x9664;&#x975E;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F; <code>EQ</code>&#xFF0C;&#x4E0D;&#x7136;&#x7D50;&#x679C;&#x5C31;&#x6703;&#x662F;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x3002;&#x6240;&#x4EE5; <code>LT `mappend` GT</code> &#x7B49;&#x65BC; <code>LT</code>&#xFF0C;&#x7136;&#x800C; <code>GT `mappend` LT</code> &#x7B49;&#x65BC; <code>GT</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">LT</span> `mappend` <span class="hljs-type">GT</span>  
<span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">GT</span> `mappend` <span class="hljs-type">LT</span>  
<span class="hljs-type">GT</span>  
<span class="hljs-title">ghci</span>&gt; mempty `mappend` <span class="hljs-type">LT</span>  
<span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; mempty `mappend` <span class="hljs-type">GT</span>  
<span class="hljs-type">GT</span>
</code></pre>
<p>&#x6240;&#x4EE5;&#x9019;&#x500B; monoid &#x5728;&#x4EC0;&#x9EBD;&#x60C5;&#x6CC1;&#x4E0B;&#x6703;&#x6709;&#x7528;&#x5462;&#xFF1F;&#x5047;&#x8A2D;&#x4F60;&#x8981;&#x5BEB;&#x4E00;&#x500B;&#x6BD4;&#x8F03;&#x5169;&#x500B;&#x5B57;&#x4E32;&#x9577;&#x5EA6;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4E26;&#x56DE;&#x50B3; <code>Ordering</code>&#x3002;&#x800C;&#x4E14;&#x7576;&#x5B57;&#x4E32;&#x4E00;&#x6A23;&#x9577;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x4E0D;&#x76F4;&#x63A5;&#x56DE;&#x50B3; <code>EQ</code>&#xFF0C;&#x53CD;&#x800C;&#x7E7C;&#x7E8C;&#x7528;&#x5B57;&#x5178;&#x9806;&#x5E8F;&#x6BD4;&#x8F03;&#x4ED6;&#x5011;&#x3002;&#x4E00;&#x7A2E;&#x5BE6;&#x4F5C;&#x7684;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">lengthCompare</span> :: <span class="hljs-type">String</span> -&gt; <span class="hljs-type">String</span> -&gt; <span class="hljs-type">Ordering</span>  
<span class="hljs-title">lengthCompare</span> x y = <span class="hljs-keyword">let</span> a = length x `compare` length y   
                        b = x `compare` y  
                    <span class="hljs-keyword">in</span>  <span class="hljs-keyword">if</span> a == <span class="hljs-type">EQ</span> <span class="hljs-keyword">then</span> b <span class="hljs-keyword">else</span> a
</code></pre>
<p>&#x6211;&#x5011;&#x7A31;&#x547C;&#x6BD4;&#x8F03;&#x9577;&#x5EA6;&#x7684;&#x7D50;&#x679C;&#x70BA; <code>a</code>&#xFF0C;&#x800C;&#x6BD4;&#x8F03;&#x5B57;&#x5178;&#x9806;&#x5E8F;&#x7684;&#x7D50;&#x679C;&#x70BA; <code>b</code>&#xFF0C;&#x800C;&#x7576;&#x9577;&#x5EA6;&#x4E00;&#x6A23;&#x6642;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x56DE;&#x50B3;&#x5B57;&#x5178;&#x9806;&#x5E8F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5584;&#x7528;&#x6211;&#x5011; <code>Ordering</code> &#x662F;&#x4E00;&#x7A2E; monoid &#x9019;&#x9805;&#x77E5;&#x8B58;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x628A;&#x6211;&#x5011;&#x7684;&#x51FD;&#x6578;&#x5BEB;&#x5F97;&#x66F4;&#x7C21;&#x55AE;&#x4E9B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-keyword">import</span> Data.Monoid

<span class="hljs-title">lengthCompare</span> :: <span class="hljs-type">String</span> -&gt; <span class="hljs-type">String</span> -&gt; <span class="hljs-type">Ordering</span>  
<span class="hljs-title">lengthCompare</span> x y = (length x `compare` length y) `mappend`  
                    (x `compare` y)
</code></pre>
<p>&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x8A66;&#x8457;&#x8DD1;&#x8DD1;&#x770B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; lengthCompare <span class="hljs-string">&quot;zen&quot;</span> <span class="hljs-string">&quot;ants&quot;</span>  
<span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; lengthCompare <span class="hljs-string">&quot;zen&quot;</span> <span class="hljs-string">&quot;ant&quot;</span>  
<span class="hljs-type">GT</span>
</code></pre>
<p>&#x8981;&#x8A18;&#x4F4F;&#x7576;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>mappend</code>&#x3002;&#x4ED6;&#x5728;&#x5DE6;&#x908A;&#x4E0D;&#x7B49;&#x65BC; <code>EQ</code> &#x7684;&#x60C5;&#x6CC1;&#x4E0B;&#x90FD;&#x6703;&#x56DE;&#x50B3;&#x5DE6;&#x908A;&#x7684;&#x503C;&#x3002;&#x76F8;&#x53CD;&#x5730;&#x5247;&#x56DE;&#x50B3;&#x53F3;&#x908A;&#x7684;&#x503C;&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBD;&#x6211;&#x5011;&#x5C07;&#x6211;&#x5011;&#x8A8D;&#x70BA;&#x6BD4;&#x8F03;&#x91CD;&#x8981;&#x7684;&#x9806;&#x5E8F;&#x653E;&#x5728;&#x5DE6;&#x908A;&#x7684;&#x53C3;&#x6578;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x8981;&#x7E7C;&#x7E8C;&#x5EF6;&#x5C55;&#x9019;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x8981;&#x8B93;&#x4ED6;&#x5011;&#x6BD4;&#x8F03;&#x6BCD;&#x97F3;&#x7684;&#x9806;&#x5E8F;&#xFF0C;&#x4E26;&#x628A;&#x9019;&#x9806;&#x5E8F;&#x5217;&#x70BA;&#x7B2C;&#x4E8C;&#x91CD;&#x8981;&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x9019;&#x6A23;&#x4FEE;&#x6539;&#x4ED6;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-keyword">import</span> Data.Monoid  

<span class="hljs-title">lengthCompare</span> :: <span class="hljs-type">String</span> -&gt; <span class="hljs-type">String</span> -&gt; <span class="hljs-type">Ordering</span>  
<span class="hljs-title">lengthCompare</span> x y = (length x `compare` length y) `mappend`  
                    (vowels x `compare` vowels y) `mappend`  
                    (x `compare` y)  
    <span class="hljs-keyword">where</span> vowels = length . filter (`elem` <span class="hljs-string">&quot;aeiou&quot;</span>)
</code></pre>
<p>&#x6211;&#x5011;&#x5BEB;&#x4E86;&#x4E00;&#x500B;&#x8F14;&#x52A9;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x5B57;&#x4E32;&#x4E26;&#x56DE;&#x50B3;&#x4ED6;&#x6709;&#x591A;&#x5C11;&#x6BCD;&#x97F3;&#x3002;&#x4ED6;&#x662F;&#x5148;&#x7528; filter &#x4F86;&#x628A;&#x5B57;&#x6BCD;&#x6FFE;&#x5230;&#x5269;&#x4E0B; <code>&quot;aeiou&quot;</code>&#xFF0C;&#x7136;&#x5F8C;&#x518D;&#x7528; <code>length</code> &#x8A08;&#x7B97;&#x9577;&#x5EA6;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; lengthCompare <span class="hljs-string">&quot;zen&quot;</span> <span class="hljs-string">&quot;anna&quot;</span>  
<span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; lengthCompare <span class="hljs-string">&quot;zen&quot;</span> <span class="hljs-string">&quot;ana&quot;</span>  
<span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; lengthCompare <span class="hljs-string">&quot;zen&quot;</span> <span class="hljs-string">&quot;ann&quot;</span>  
<span class="hljs-type">GT</span>
</code></pre>
<p>&#x5728;&#x7B2C;&#x4E00;&#x500B;&#x4F8B;&#x5B50;&#x4E2D;&#x6211;&#x5011;&#x770B;&#x5230;&#x9577;&#x5EA6;&#x4E0D;&#x540C;&#x6240;&#x4EE5;&#x56DE;&#x50B3; <code>LT</code>&#xFF0C;&#x660E;&#x986F;&#x5730; <code>&quot;zen&quot;</code> &#x8981;&#x77ED;&#x65BC; <code>&quot;anna&quot;</code>&#x3002;&#x5728;&#x7B2C;&#x4E8C;&#x500B;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x9577;&#x5EA6;&#x662F;&#x4E00;&#x6A23;&#x7684;&#xFF0C;&#x4F46;&#x7B2C;&#x4E8C;&#x500B;&#x5B57;&#x4E32;&#x6709;&#x6BD4;&#x8F03;&#x591A;&#x7684;&#x6BCD;&#x97F3;&#xFF0C;&#x6240;&#x4EE5;&#x7D50;&#x679C;&#x4ECD;&#x7136;&#x662F; <code>LT</code>&#x3002;&#x5728;&#x7B2C;&#x4E09;&#x500B;&#x7BC4;&#x4F8B;&#x4E2D;&#xFF0C;&#x5169;&#x500B;&#x9577;&#x5EA6;&#x90FD;&#x76F8;&#x7B49;&#xFF0C;&#x4ED6;&#x5011;&#x4E5F;&#x6709;&#x76F8;&#x540C;&#x500B;&#x6578;&#x7684;&#x6BCD;&#x97F3;&#xFF0C;&#x7D93;&#x7531;&#x5B57;&#x5178;&#x9806;&#x5E8F;&#x6BD4;&#x8F03;&#x5F8C;&#x5F97;&#x5230; <code>&quot;zen&quot;</code> &#x6BD4;&#x8F03;&#x5927;&#x3002;</p>
<p><code>Ordering</code> &#x7684; monoid &#x5141;&#x8A31;&#x6211;&#x5011;&#x7528;&#x4E0D;&#x540C;&#x65B9;&#x5F0F;&#x6BD4;&#x8F03;&#x4E8B;&#x7269;&#xFF0C;&#x4E26;&#x5C07;&#x9019;&#x4E9B;&#x9806;&#x5E8F;&#x4E5F;&#x5B9A;&#x7FA9;&#x4E86;&#x4F9D;&#x91CD;&#x8981;&#x5EA6;&#x4E0D;&#x540C;&#x7684;&#x4E00;&#x500B;&#x9806;&#x5E8F;&#x3002;</p>
<h3 id="maybe-the-monoid">Maybe the monoid</h3>
<p>&#x6211;&#x5011;&#x4F86;&#x770B;&#x4E00;&#x4E0B; <code>Maybe a</code> &#x662F;&#x600E;&#x6A23;&#x6709;&#x591A;&#x7A2E;&#x65B9;&#x5F0F;&#x4F86;&#x8868;&#x73FE;&#x6210; <code>Monoid</code> &#x7684;&#xFF0C;&#x4E26;&#x4E14;&#x8AAA;&#x660E;&#x54EA;&#x4E9B;&#x662F;&#x6BD4;&#x8F03;&#x6709;&#x7528;&#x7684;&#x3002;&#x4E00;&#x7A2E;&#x5C07; <code>Maybe a</code> &#x7576;&#x4F5C; monoid &#x7684;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x4ED6;&#x7684; <code>a</code> &#x4E5F;&#x662F;&#x4E00;&#x500B; monoid&#xFF0C;&#x800C;&#x6211;&#x5011;&#x5C07; <code>mappend</code> &#x5BE6;&#x4F5C;&#x6210;&#x4F7F;&#x7528;&#x5305;&#x5728; <code>Just</code> &#x88E1;&#x9762;&#x7684;&#x503C;&#x5C0D;&#x61C9;&#x7684; <code>mappend</code>&#x3002;&#x4E26;&#x4E14;&#x7528; <code>Nothing</code> &#x7576;&#x4F5C; identity&#x3002;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6211; <code>mappend</code> &#x5169;&#x500B;&#x53C3;&#x6578;&#x4E2D;&#x6709;&#x4E00;&#x500B;&#x662F; <code>Nothing</code>&#x3002;&#x90A3;&#x7D50;&#x679C;&#x5C31;&#x6703;&#x662F;&#x53E6;&#x4E00;&#x908A;&#x7684;&#x503C;&#x3002;&#x4ED6;&#x7684; instance &#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Monoid</span> a =&gt; <span class="hljs-type">Monoid</span> (<span class="hljs-type">Maybe</span> <span class="hljs-title">a</span>) <span class="hljs-keyword">where</span></span>  
    mempty = <span class="hljs-type">Nothing</span>  
    <span class="hljs-type">Nothing</span> `mappend` m = m  
    m `mappend` <span class="hljs-type">Nothing</span> = m  
    <span class="hljs-type">Just</span> m1 `mappend` <span class="hljs-type">Just</span> m2 = <span class="hljs-type">Just</span> (m1 `mappend` m2)
</code></pre>
<p>&#x7559;&#x610F;&#x5230; class constraint&#x3002;&#x4ED6;&#x8AAA;&#x660E; <code>Maybe a</code> &#x53EA;&#x6709;&#x5728; <code>a</code> &#x662F; <code>Monoid</code> &#x7684;&#x60C5;&#x6CC1;&#x4E0B;&#x624D;&#x6703;&#x662F;&#x4E00;&#x500B; <code>Monoid</code>&#x3002;&#x5982;&#x679C;&#x6211;&#x5011; <code>mappend</code> &#x67D0;&#x500B;&#x6771;&#x897F;&#x8DDF; <code>Nothing</code>&#x3002;&#x90A3;&#x7D50;&#x679C;&#x5C31;&#x6703;&#x662F;&#x67D0;&#x500B;&#x6771;&#x897F;&#x3002;&#x5982;&#x679C;&#x6211;&#x5011; <code>mappend</code> &#x5169;&#x500B; <code>Just</code>&#xFF0C;&#x90A3; <code>Just</code> &#x5305;&#x4F4F;&#x7684;&#x7D50;&#x679C;&#x5C31;&#x6703; <code>mappended</code> &#x5728;&#x4E00;&#x8D77;&#x4E26;&#x653E;&#x56DE; <code>Just</code>&#x3002;&#x6211;&#x5011;&#x80FD;&#x9019;&#x9EBC;&#x505A;&#x662F;&#x56E0;&#x70BA; class constraint &#x4FDD;&#x8B49;&#x4E86;&#x5728; <code>Just</code> &#x4E2D;&#x7684;&#x503C;&#x662F; <code>Monoid</code>&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">Nothing</span> `mappend` <span class="hljs-type">Just</span> <span class="hljs-string">&quot;andy&quot;</span>  
<span class="hljs-type">Just</span> <span class="hljs-string">&quot;andy&quot;</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">Just</span> <span class="hljs-type">LT</span> `mappend` <span class="hljs-type">Nothing</span>  
<span class="hljs-type">Just</span> <span class="hljs-type">LT</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">Just</span> (<span class="hljs-type">Sum</span> <span class="hljs-number">3</span>) `mappend` <span class="hljs-type">Just</span> (<span class="hljs-type">Sum</span> <span class="hljs-number">4</span>)  
<span class="hljs-type">Just</span> (<span class="hljs-type">Sum</span> {getSum = <span class="hljs-number">7</span>})
</code></pre>
<p>&#x9019;&#x7576;&#x4F60;&#x5728;&#x8655;&#x7406;&#x6709;&#x53EF;&#x80FD;&#x5931;&#x6557;&#x7684; monoid &#x7684;&#x6642;&#x5019;&#x6BD4;&#x8F03;&#x6709;&#x7528;&#x3002;&#x6709;&#x4E86;&#x9019;&#x500B; instance&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x4E0D;&#x5FC5;&#x4E00;&#x4E00;&#x53BB;&#x6AA2;&#x67E5;&#x4ED6;&#x5011;&#x662F;&#x5426;&#x5931;&#x6557;&#xFF0C;&#x662F;&#x5426;&#x662F; <code>Nothing</code> &#x6216;&#x662F; <code>Just</code>&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5C07;&#x4ED6;&#x5011;&#x7576;&#x4F5C;&#x666E;&#x901A;&#x7684; monoid&#x3002;</p>
<p>&#x4F46;&#x5982;&#x679C;&#x5728; <code>Maybe</code> &#x4E2D;&#x7684;&#x578B;&#x5225;&#x4E0D;&#x662F; <code>Monoid</code> &#x5462;&#xFF1F;&#x6CE8;&#x610F;&#x5230;&#x5728;&#x5148;&#x524D;&#x7684; instance &#x5B9A;&#x7FA9;&#x4E2D;&#xFF0C;&#x552F;&#x4E00;&#x6709;&#x4F9D;&#x8CF4;&#x65BC; monoid &#x9650;&#x5236;&#x7684;&#x60C5;&#x6CC1;&#x5C31;&#x662F;&#x5728; <code>mappend</code> &#x5169;&#x500B; <code>Just</code> &#x7684;&#x6642;&#x5019;&#x3002;&#x4F46;&#x5982;&#x679C;&#x6211;&#x5011;&#x4E0D;&#x77E5;&#x9053;&#x5305;&#x5728; <code>Just</code> &#x88E1;&#x9762;&#x7684;&#x503C;&#x7A76;&#x7ADF;&#x662F;&#x4E0D;&#x662F; monoid&#xFF0C;&#x6211;&#x5011;&#x6839;&#x672C;&#x7121;&#x6CD5;&#x7528; <code>mappend</code> &#x64CD;&#x4F5C;&#x4ED6;&#x5011;&#xFF0C;&#x6240;&#x4EE5;&#x8A72;&#x600E;&#x9EBC;&#x8FA6;&#x5462;&#xFF1F;&#x4E00;&#x7A2E;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x76F4;&#x63A5;&#x4E1F;&#x6389;&#x7B2C;&#x4E8C;&#x500B;&#x503C;&#x800C;&#x7559;&#x4E0B;&#x7B2C;&#x4E00;&#x500B;&#x503C;&#x3002;&#x9019;&#x5C31;&#x662F; <code>First a</code> &#x5B58;&#x5728;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x800C;&#x9019;&#x662F;&#x4ED6;&#x7684;&#x5B9A;&#x7FA9;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">First</span> a = <span class="hljs-type">First</span> { <span class="hljs-title">getFirst</span> :: <span class="hljs-type">Maybe</span> <span class="hljs-title">a</span> }  </span>
    <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Eq</span>, <span class="hljs-type">Ord</span>, <span class="hljs-type">Read</span>, <span class="hljs-type">Show</span>)
</code></pre>
<p>&#x6211;&#x5011;&#x63A5;&#x53D7;&#x4E00;&#x500B; <code>Maybe a</code> &#x4E26;&#x628A;&#x4ED6;&#x5305;&#x6210; newtype&#xFF0C;<code>Monoid</code> &#x7684;&#x5B9A;&#x7FA9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">Monoid</span> (<span class="hljs-type">First</span> <span class="hljs-title">a</span>) <span class="hljs-keyword">where</span></span>  
    mempty = <span class="hljs-type">First</span> <span class="hljs-type">Nothing</span>  
    <span class="hljs-type">First</span> (<span class="hljs-type">Just</span> x) `mappend` _ = <span class="hljs-type">First</span> (<span class="hljs-type">Just</span> x)  
    <span class="hljs-type">First</span> <span class="hljs-type">Nothing</span> `mappend` x = x
</code></pre>
<p>&#x6B63;&#x5982;&#x6211;&#x5011;&#x8AAA;&#x904E;&#x5F97;&#xFF0C;<code>mempty</code> &#x5C31;&#x662F;&#x5305;&#x5728; <code>First</code> &#x4E2D;&#x7684; <code>Nothing</code>&#x3002;&#x5982;&#x679C; <code>mappend</code> &#x7684;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F; <code>Just</code>&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x76F4;&#x63A5;&#x5FFD;&#x7565;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x3002;&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F; <code>Nothing</code>&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x5C31;&#x5C07;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x7576;&#x4F5C;&#x7D50;&#x679C;&#x3002;&#x4E26;&#x4E0D;&#x7BA1;&#x4ED6;&#x7A76;&#x7ADF;&#x662F; <code>Just</code> &#x6216;&#x662F; <code>Nothing</code>&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getFirst $ <span class="hljs-type">First</span> (<span class="hljs-type">Just</span> &apos;a&apos;) `mappend` <span class="hljs-type">First</span> (<span class="hljs-type">Just</span> &apos;b&apos;)  
<span class="hljs-type">Just</span> &apos;a&apos;  
<span class="hljs-title">ghci</span>&gt; getFirst $ <span class="hljs-type">First</span> <span class="hljs-type">Nothing</span> `mappend` <span class="hljs-type">First</span> (<span class="hljs-type">Just</span> &apos;b&apos;)  
<span class="hljs-type">Just</span> &apos;b&apos;  
<span class="hljs-title">ghci</span>&gt; getFirst $ <span class="hljs-type">First</span> (<span class="hljs-type">Just</span> &apos;a&apos;) `mappend` <span class="hljs-type">First</span> <span class="hljs-type">Nothing</span>  
<span class="hljs-type">Just</span> &apos;a&apos;
</code></pre>
<p><code>First</code> &#x5728;&#x6211;&#x5011;&#x6709;&#x4E00;&#x5927;&#x4E32; <code>Maybe</code> &#x800C;&#x4E14;&#x60F3;&#x77E5;&#x9053;&#x4ED6;&#x5011;&#x4E4B;&#x4E2D;&#x5C31;&#x7ADF;&#x6709;&#x6C92;&#x6709; <code>Just</code> &#x7684;&#x6642;&#x5019;&#x5F88;&#x6709;&#x7528;&#x3002;&#x53EF;&#x4EE5;&#x5229;&#x7528; <code>mconcat</code>&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getFirst . mconcat . map <span class="hljs-type">First</span> $ [<span class="hljs-type">Nothing</span>, <span class="hljs-type">Just</span> <span class="hljs-number">9</span>, <span class="hljs-type">Just</span> <span class="hljs-number">10</span>]  
<span class="hljs-type">Just</span> <span class="hljs-number">9</span>
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x5011;&#x5E0C;&#x671B;&#x5B9A;&#x7FA9;&#x4E00;&#x500B; <code>Maybe a</code> &#x7684; monoid&#xFF0C;&#x8B93;&#x4ED6;&#x7576; <code>mappend</code> &#x7684;&#x5169;&#x500B;&#x53C3;&#x6578;&#x90FD;&#x662F; <code>Just</code> &#x7684;&#x6642;&#x5019;&#x5C07;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x7576;&#x4F5C;&#x7D50;&#x679C;&#x3002;<code>Data.Monoid</code> &#x4E2D;&#x6709;&#x4E00;&#x500B;&#x73FE;&#x6210;&#x7684; <code>Last a</code>&#xFF0C;&#x4ED6;&#x5F88;&#x50CF;&#x662F; <code>First a</code>&#xFF0C;&#x53EA;&#x5DEE;&#x5728; <code>mappend</code> &#x8DDF; <code>mconcat</code> &#x6703;&#x4FDD;&#x7559;&#x6700;&#x5F8C;&#x4E00;&#x500B;&#x975E; <code>Nothing</code> &#x7684;&#x503C;&#x3002;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getLast . mconcat . map <span class="hljs-type">Last</span> $ [<span class="hljs-type">Nothing</span>, <span class="hljs-type">Just</span> <span class="hljs-number">9</span>, <span class="hljs-type">Just</span> <span class="hljs-number">10</span>]  
<span class="hljs-type">Just</span> <span class="hljs-number">10</span>  
<span class="hljs-title">ghci</span>&gt; getLast $ <span class="hljs-type">Last</span> (<span class="hljs-type">Just</span> <span class="hljs-string">&quot;one&quot;</span>) `mappend` <span class="hljs-type">Last</span> (<span class="hljs-type">Just</span> <span class="hljs-string">&quot;two&quot;</span>)  
<span class="hljs-type">Just</span> <span class="hljs-string">&quot;two&quot;</span>
</code></pre>
<h3 id="using-monoids-to-fold-data-structures">Using monoids to fold data structures</h3>
<p>&#x53E6;&#x4E00;&#x7A2E;&#x6709;&#x8DA3;&#x7684; monoid &#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x8B93;&#x4ED6;&#x4F86;&#x5E6B;&#x52A9;&#x6211;&#x5011; fold &#x4E00;&#x4E9B;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x3002;&#x5230;&#x76EE;&#x524D;&#x70BA;&#x6B62;&#x6211;&#x5011;&#x53EA;&#x6709; fold list&#x3002;&#x4F46; list &#x4E26;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x4E00;&#x7A2E;&#x53EF;&#x4EE5; fold &#x7684;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x3002;&#x6211;&#x5011;&#x5E7E;&#x4E4E;&#x53EF;&#x4EE5; fold &#x4EFB;&#x4F55;&#x4E00;&#x7A2E;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x3002;&#x50CF;&#x662F; tree &#x4E5F;&#x662F;&#x4E00;&#x7A2E;&#x5E38;&#x898B;&#x7684;&#x53EF;&#x4EE5; fold &#x7684;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x3002;</p>
<p>&#x7531;&#x65BC;&#x6709;&#x592A;&#x591A;&#x7A2E;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x53EF;&#x4EE5; fold &#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5B9A;&#x7FA9;&#x4E86; <code>Foldable</code> &#x9019;&#x500B; typeclass&#x3002;&#x5C31;&#x50CF; <code>Functor</code> &#x662F;&#x5B9A;&#x7FA9;&#x53EF;&#x4EE5; map over &#x7684;&#x7D50;&#x69CB;&#x3002;<code>Foldable</code> &#x662F;&#x5B9A;&#x7FA9;&#x53EF;&#x4EE5; fold &#x7684;&#x7D50;&#x69CB;&#x3002;&#x5728; <code>Data.Foldable</code> &#x4E2D;&#x6709;&#x5B9A;&#x7FA9;&#x4E86;&#x4E00;&#x4E9B;&#x6709;&#x7528;&#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4F46;&#x4ED6;&#x5011;&#x540D;&#x7A31;&#x8DDF; <code>Prelude</code> &#x4E2D;&#x7684;&#x540D;&#x7A31;&#x885D;&#x7A81;&#x3002;&#x6240;&#x4EE5;&#x6700;&#x597D;&#x662F;&#x7528; qualified &#x7684;&#x65B9;&#x5F0F; import &#x4ED6;&#x5011;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-keyword">import</span> <span class="hljs-keyword">qualified</span> Foldable <span class="hljs-keyword">as</span> F
</code></pre>
<p>&#x70BA;&#x4E86;&#x5C11;&#x6253;&#x4E00;&#x4E9B;&#x5B57;&#xFF0C;&#x6211;&#x5011;&#x5C07;&#x4ED6;&#x5011; import qualified &#x6210; <code>F</code>&#x3002;&#x6240;&#x4EE5;&#x9019;&#x500B; typeclass &#x4E2D;&#x5B9A;&#x7FA9;&#x4E86;&#x54EA;&#x4E9B;&#x51FD;&#x6578;&#x5462;&#xFF1F;&#x6709; <code>foldr</code>&#xFF0C;<code>foldl</code>&#xFF0C;<code>foldr1</code> &#x8DDF; <code>foldl1</code>&#x3002;&#x4F60;&#x6703;&#x8AAA;&#x6211;&#x5011;&#x5DF2;&#x7D93;&#x77E5;&#x9053;&#x9019;&#x4E9B;&#x51FD;&#x6578;&#x4E86;&#xFF0C;&#x4ED6;&#x5011;&#x6709;&#x4EC0;&#x9EBD;&#x4E0D;&#x4E00;&#x6A23;&#x7684;&#x5730;&#x65B9;&#x55CE;&#xFF1F;&#x6211;&#x5011;&#x4F86;&#x6BD4;&#x8F03;&#x4E00;&#x4E0B; <code>Foldable</code> &#x4E2D;&#x7684; <code>foldr</code> &#x8DDF; <code>Prelude</code> &#x4E2D;&#x7684; <code>foldr</code> &#x7684;&#x578B;&#x5225;&#x7570;&#x540C;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; :t foldr  
<span class="hljs-title">foldr</span> :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b  
<span class="hljs-title">ghci</span>&gt; :t <span class="hljs-type">F</span>.foldr  
<span class="hljs-type">F</span>.foldr :: (<span class="hljs-type">F</span>.<span class="hljs-type">Foldable</span> t) =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</code></pre>
<p>&#x5118;&#x7BA1; <code>foldr</code> &#x63A5;&#x53D7;&#x4E00;&#x500B; list &#x4E26;&#x5C07;&#x4ED6; fold &#x8D77;&#x4F86;&#xFF0C;<code>Data.Foldable</code> &#x4E2D;&#x7684; <code>foldr</code> &#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x53EF;&#x4EE5; fold &#x7684;&#x578B;&#x5225;&#x3002;&#x4E26;&#x4E0D;&#x53EA;&#x662F; list&#x3002; &#x800C;&#x5169;&#x500B; <code>foldr</code> &#x5C0D;&#x65BC; list &#x7684;&#x7D50;&#x679C;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; foldr (*) <span class="hljs-number">1</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
<span class="hljs-number">6</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">F</span>.foldr (*) <span class="hljs-number">1</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]  
<span class="hljs-number">6</span>
</code></pre>
<p>&#x90A3;&#x6709;&#x54EA;&#x4E9B;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x652F;&#x63F4; fold &#x5462;&#xFF1F;&#x9996;&#x5148;&#x6211;&#x5011;&#x6709; <code>Maybe</code>&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">F</span>.foldl (+) <span class="hljs-number">2</span> (<span class="hljs-type">Just</span> <span class="hljs-number">9</span>)  
<span class="hljs-number">11</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">F</span>.foldr (||) <span class="hljs-type">False</span> (<span class="hljs-type">Just</span> <span class="hljs-type">True</span>)  
<span class="hljs-type">True</span>
</code></pre>
<p>&#x4F46; fold &#x4E00;&#x500B; <code>Maybe</code> &#x4E26;&#x6C92;&#x4EC0;&#x9EBD;&#x65B0;&#x610F;&#x3002;&#x7562;&#x7ADF;&#x7576;&#x4ED6;&#x662F; <code>Just</code> &#x7684;&#x6642;&#x5019;&#x8868;&#x73FE;&#x5F97;&#x50CF;&#x662F;&#x53EA;&#x6709;&#x55AE;&#x4E00;&#x5143;&#x7D20;&#x7684; list&#xFF0C;&#x800C;&#x7576;&#x4ED6;&#x662F; <code>Nothing</code> &#x7684;&#x6642;&#x5019;&#x5C31;&#x50CF;&#x662F;&#x7A7A;&#x7684; list &#x4E00;&#x6A23;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x4F86;&#x770B;&#x4E00;&#x4E9B;&#x6BD4;&#x8F03;&#x8907;&#x96DC;&#x7684;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x3002;</p>
<p>&#x9084;&#x8A18;&#x5F97; Making Our Own Types and Typeclass &#x7AE0;&#x7BC0;&#x4E2D;&#x7684;&#x6A39;&#x72C0;&#x7684;&#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x55CE;&#xFF1F;&#x6211;&#x5011;&#x662F;&#x9019;&#x6A23;&#x5B9A;&#x7FA9;&#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Tree</span> a = <span class="hljs-type">Empty</span> | <span class="hljs-type">Node</span> a (<span class="hljs-type">Tree</span> <span class="hljs-title">a</span>) (<span class="hljs-type">Tree</span> <span class="hljs-title">a</span>) <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Show</span>, <span class="hljs-type">Read</span>, <span class="hljs-type">Eq</span>)</span>
</code></pre>
<p>&#x6211;&#x5011;&#x8AAA;&#x4E00;&#x68F5;&#x6A39;&#x8981;&#x4E0D;&#x5C31;&#x662F;&#x4E00;&#x68F5;&#x7A7A;&#x7684;&#x6A39;&#x8981;&#x4E0D;&#x7136;&#x5C31;&#x662F;&#x4E00;&#x500B;&#x5305;&#x542B;&#x503C;&#x7684;&#x7BC0;&#x9EDE;&#xFF0C;&#x4E26;&#x4E14;&#x9084;&#x6307;&#x5411;&#x53E6;&#x5916;&#x5169;&#x68F5;&#x6A39;&#x3002;&#x5B9A;&#x7FA9;&#x4ED6;&#x4E4B;&#x5F8C;&#xFF0C;&#x6211;&#x5011;&#x5C07;&#x4ED6;&#x5B9A;&#x7FA9;&#x6210; <code>Functor</code> &#x7684; instance&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5; <code>fmap</code> &#x4ED6;&#x3002;&#x73FE;&#x5728;&#x6211;&#x5011;&#x8981;&#x5C07;&#x4ED6;&#x5B9A;&#x7FA9;&#x6210; <code>Foldable</code> &#x7684; instance&#xFF0C;&#x9019;&#x6A23;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5; fold &#x4ED6;&#x3002;&#x8981;&#x5B9A;&#x7FA9;&#x6210; <code>Foldable</code> &#x7684;&#x4E00;&#x7A2E;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x5BE6;&#x4F5C; <code>foldr</code>&#x3002;&#x4F46;&#x53E6;&#x4E00;&#x7A2E;&#x6BD4;&#x8F03;&#x7C21;&#x55AE;&#x7684;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x5BE6;&#x4F5C; <code>foldMap</code>&#xFF0C;&#x4ED6;&#x4E5F;&#x5C6C;&#x65BC; <code>Foldable</code> typeclass&#x3002;<code>foldMap</code> &#x7684;&#x578B;&#x5225;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">foldMap</span> :: (<span class="hljs-type">Monoid</span> m, <span class="hljs-type">Foldable</span> t) =&gt; (a -&gt; m) -&gt; t a -&gt; m
</code></pre>
<p>&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x9019;&#x500B;&#x51FD;&#x6578;&#x63A5;&#x53D7; foldable &#x8CC7;&#x6599;&#x7D50;&#x69CB;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x5143;&#x7D20;&#x7684;&#x578B;&#x5225;&#xFF0C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; monoid&#x3002;&#x4ED6;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x662F;&#x4E00;&#x500B; foldable &#x7684;&#x7D50;&#x69CB;&#xFF0C;&#x4E26;&#x5305;&#x542B;&#x578B;&#x5225; <code>a</code> &#x7684;&#x5143;&#x7D20;&#x3002;&#x4ED6;&#x5C07;&#x7B2C;&#x4E00;&#x500B;&#x51FD;&#x6578;&#x4F86; map over &#x9019;&#x500B; foldable &#x7684;&#x7D50;&#x69CB;&#xFF0C;&#x56E0;&#x6B64;&#x5F97;&#x5230;&#x4E00;&#x500B;&#x5305;&#x542B; monoid &#x7684; foldable &#x7D50;&#x69CB;&#x3002;&#x7136;&#x5F8C;&#x7528; <code>mappend</code> &#x4F86;&#x7C21;&#x5316;&#x9019;&#x4E9B; monoid&#xFF0C;&#x6700;&#x5F8C;&#x5F97;&#x5230;&#x55AE;&#x4E00;&#x7684;&#x4E00;&#x500B; monoid&#x3002;&#x9019;&#x500B;&#x51FD;&#x6578;&#x807D;&#x8D77;&#x4F86;&#x4E0D;&#x592A;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x4F46;&#x6211;&#x5011;&#x4E0B;&#x9762;&#x6703;&#x770B;&#x5230;&#x4ED6;&#x5176;&#x5BE6;&#x5F88;&#x5BB9;&#x6613;&#x5BE6;&#x4F5C;&#x3002;&#x800C;&#x4E14;&#x597D;&#x6D88;&#x606F;&#x662F;&#x53EA;&#x8981;&#x5BE6;&#x4F5C;&#x4E86;&#x9019;&#x500B;&#x51FD;&#x6578;&#x5C31;&#x53EF;&#x4EE5;&#x8B93;&#x6211;&#x5011;&#x7684;&#x51FD;&#x6578;&#x6210;&#x70BA; <code>Foldable</code>&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x53EA;&#x8981;&#x5BE6;&#x4F5C;&#x67D0;&#x500B;&#x578B;&#x5225;&#x7684; <code>foldMap</code>&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x90A3;&#x500B;&#x578B;&#x5225;&#x7684; <code>foldr</code> &#x8DDF; <code>foldl</code>&#x3002;</p>
<p>&#x9019;&#x5C31;&#x662F;&#x6211;&#x5011;&#x5982;&#x4F55;&#x5B9A;&#x7FA9; <code>Tree</code> &#x6210;&#x70BA; <code>Foldable</code> &#x7684;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">instance</span> <span class="hljs-type">F</span>.<span class="hljs-type">Foldable</span> <span class="hljs-type">Tree</span> <span class="hljs-keyword">where</span></span>  
    foldMap f <span class="hljs-type">Empty</span> = mempty  
    foldMap f (<span class="hljs-type">Node</span> x l r) = <span class="hljs-type">F</span>.foldMap f l `mappend`  
                                f x           `mappend`  
                                <span class="hljs-type">F</span>.foldMap f r
</code></pre>
<p><img src="img/accordion.png" alt=""></p>
<p>&#x6211;&#x5011;&#x662F;&#x9019;&#x6A23;&#x601D;&#x8003;&#x7684;&#xFF1A;&#x5982;&#x679C;&#x6211;&#x5011;&#x5BEB;&#x4E00;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4ED6;&#x63A5;&#x53D7;&#x6A39;&#x4E2D;&#x7684;&#x4E00;&#x500B;&#x5143;&#x7D20;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; monoid&#xFF0C;&#x90A3;&#x6211;&#x5011;&#x8981;&#x600E;&#x9EBC;&#x7C21;&#x5316;&#x6574;&#x68F5;&#x6A39;&#x5230;&#x53EA;&#x6709;&#x55AE;&#x4E00;&#x4E00;&#x500B; monoid&#xFF1F;&#x7576;&#x6211;&#x5011;&#x5728;&#x5C0D;&#x6A39;&#x505A; <code>fmap</code> &#x7684;&#x6642;&#x5019;&#xFF0C;&#x6211;&#x5011;&#x5C07;&#x90A3;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x7BC0;&#x9EDE;&#x4E0A;&#xFF0C;&#x4E26;&#x905E;&#x8FF4;&#x5730;&#x5957;&#x7528;&#x81F3;&#x5DE6;&#x5B50;&#x6A39;&#x4EE5;&#x53CA;&#x53F3;&#x5B50;&#x6A39;&#x3002;&#x9019;&#x908A;&#x6211;&#x5011;&#x4E0D;&#x53EA;&#x662F; map &#x4E00;&#x500B;&#x51FD;&#x6578;&#x800C;&#x5DF2;&#xFF0C;&#x6211;&#x5011;&#x9084;&#x8981;&#x6C42;&#x8981;&#x628A;&#x7D50;&#x679C;&#x7528; <code>mappend</code> &#x7C21;&#x5316;&#x6210;&#x53EA;&#x6709;&#x55AE;&#x4E00;&#x4E00;&#x500B; monoid &#x503C;&#x3002;&#x9996;&#x5148;&#x6211;&#x5011;&#x8003;&#x616E;&#x6A39;&#x70BA;&#x7A7A;&#x7684;&#x60C5;&#x5F62;&#xFF0C;&#x4E00;&#x68F5;&#x6C92;&#x6709;&#x503C;&#x4E5F;&#x6C92;&#x6709;&#x5B50;&#x6A39;&#x7684;&#x60C5;&#x5F62;&#x3002;&#x7531;&#x65BC;&#x6C92;&#x6709;&#x503C;&#x6211;&#x5011;&#x4E5F;&#x6C92;&#x8FA6;&#x6CD5;&#x5C07;&#x4ED6;&#x5957;&#x7528;&#x4E0A;&#x9762;&#x8F49;&#x63DB;&#x6210; monoid &#x7684;&#x51FD;&#x6578;&#xFF0C;&#x6240;&#x4EE5;&#x7576;&#x6A39;&#x70BA;&#x7A7A;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x7D50;&#x679C;&#x61C9;&#x8A72;&#x8981;&#x662F; <code>mempty</code>&#x3002;</p>
<p>&#x5728;&#x975E;&#x7A7A;&#x7BC0;&#x9EDE;&#x7684;&#x60C5;&#x5F62;&#x4E0B;&#x6BD4;&#x8F03;&#x6709;&#x8DA3;&#xFF0C;&#x4ED6;&#x5305;&#x542B;&#x4E00;&#x500B;&#x503C;&#x8DDF;&#x5169;&#x68F5;&#x5B50;&#x6A39;&#x3002;&#x5728;&#x9019;&#x7A2E;&#x60C5;&#x6CC1;&#x4E0B;&#xFF0C;&#x6211;&#x5011;&#x905E;&#x8FF4;&#x5730;&#x505A; <code>foldMap</code>&#xFF0C;&#x7528; <code>f</code> &#x4F86;&#x5957;&#x7528;&#x5230;&#x5DE6;&#x5B50;&#x6A39;&#x8DDF;&#x53F3;&#x5B50;&#x6A39;&#x4E0A;&#x3002;&#x8981;&#x8A18;&#x4F4F;&#x6211;&#x5011;&#x7684; <code>foldMap</code> &#x53EA;&#x6703;&#x5F97;&#x5230;&#x55AE;&#x4E00;&#x7684; monoid &#x503C;&#x3002;&#x6211;&#x5011;&#x4E5F;&#x6703;&#x5957;&#x7528; <code>f</code> &#x5230;&#x7BC0;&#x9EDE;&#x4E2D;&#x7684;&#x503C;&#x3002;&#x9019;&#x6A23;&#x6211;&#x5011;&#x5C31;&#x5F97;&#x5230;&#x4E09;&#x500B; monoid &#x503C;&#xFF0C;&#x6709;&#x5169;&#x500B;&#x4F86;&#x81EA;&#x7C21;&#x5316;&#x5B50;&#x6A39;&#x7684;&#x7D50;&#x679C;&#xFF0C;&#x9084;&#x6709;&#x4E00;&#x500B;&#x662F;&#x5957;&#x7528; <code>f</code> &#x5230;&#x7BC0;&#x9EDE;&#x4E2D;&#x7684;&#x503C;&#x7684;&#x7D50;&#x679C;&#x3002;&#x800C;&#x6211;&#x5011;&#x9700;&#x8981;&#x5C07;&#x9019;&#x4E09;&#x500B;&#x503C;&#x6574;&#x5408;&#x6210;&#x55AE;&#x4E00;&#x500B;&#x503C;&#x3002;&#x8981;&#x9054;&#x6210;&#x9019;&#x500B;&#x76EE;&#x7684;&#x6211;&#x5011;&#x4F7F;&#x7528; <code>mappend</code>&#xFF0C;&#x800C;&#x4E14;&#x81EA;&#x7136;&#x5730;&#x6703;&#x60F3;&#x5230;&#x7167;&#x5DE6;&#x5B50;&#x6A39;&#xFF0C;&#x7BC0;&#x9EDE;&#x503C;&#x4EE5;&#x53CA;&#x53F3;&#x5B50;&#x6A39;&#x7684;&#x9806;&#x5E8F;&#x4F86;&#x7C21;&#x5316;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x5230;&#x6211;&#x5011;&#x4E26;&#x4E0D;&#x4E00;&#x5B9A;&#x8981;&#x63D0;&#x4F9B;&#x4E00;&#x500B;&#x5C07;&#x666E;&#x901A;&#x503C;&#x8F49;&#x6210; monoid &#x7684;&#x51FD;&#x6578;&#x3002;&#x6211;&#x5011;&#x53EA;&#x662F;&#x628A;&#x4ED6;&#x7576;&#x4F5C;&#x662F; <code>foldMap</code> &#x7684;&#x53C3;&#x6578;&#xFF0C;&#x6211;&#x5011;&#x8981;&#x6C7A;&#x5B9A;&#x7684;&#x53EA;&#x662F;&#x5982;&#x4F55;&#x5957;&#x7528;&#x90A3;&#x500B;&#x51FD;&#x6578;&#xFF0C;&#x4F86;&#x628A;&#x5F97;&#x5230;&#x7684; monoid &#x5011;&#x7C21;&#x5316;&#x6210;&#x55AE;&#x4E00;&#x7D50;&#x679C;&#x3002;</p>
<p>&#x73FE;&#x5728;&#x6211;&#x5011;&#x6709;&#x6A39;&#x7684; <code>Foldable</code> instance&#xFF0C;&#x800C; <code>foldr</code> &#x8DDF; <code>foldl</code> &#x4E5F;&#x6709;&#x9810;&#x8A2D;&#x7684;&#x5BE6;&#x4F5C;&#x4E86;&#x3002;&#x8003;&#x616E;&#x4E0B;&#x9762;&#x9019;&#x68F5;&#x6A39;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">testTree</span> = <span class="hljs-type">Node</span> <span class="hljs-number">5</span>  
            (<span class="hljs-type">Node</span> <span class="hljs-number">3</span>  
             (<span class="hljs-type">Node</span> <span class="hljs-number">1</span> <span class="hljs-type">Empty</span> <span class="hljs-type">Empty</span>)  
             (<span class="hljs-type">Node</span> <span class="hljs-number">6</span> <span class="hljs-type">Empty</span> <span class="hljs-type">Empty</span>)  
            )  
            (<span class="hljs-type">Node</span> <span class="hljs-number">9</span>  
             (<span class="hljs-type">Node</span> <span class="hljs-number">8</span> <span class="hljs-type">Empty</span> <span class="hljs-type">Empty</span>)  
             (<span class="hljs-type">Node</span> <span class="hljs-number">10</span> <span class="hljs-type">Empty</span> <span class="hljs-type">Empty</span>)  
            )
</code></pre>
<p>&#x4ED6;&#x7684; root &#x662F; <code>5</code>&#xFF0C;&#x800C;&#x4ED6;&#x5DE6;&#x908A;&#x4E0B;&#x4F86;&#x5206;&#x5225;&#x662F; <code>3</code>&#xFF0C;&#x518D;&#x4F86;&#x662F; <code>1</code> &#x8DDF; <code>6</code>&#x3002;&#x800C;&#x53F3;&#x908A;&#x4E0B;&#x4F86;&#x662F; <code>9</code>&#xFF0C;&#x518D;&#x4F86;&#x662F; <code>8</code> &#x8DDF; <code>10</code>&#x3002;&#x6709;&#x4E86; <code>Foldable</code> &#x7684;&#x5B9A;&#x7FA9;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x80FD;&#x50CF;&#x5C0D; list &#x505A; fold &#x4E00;&#x6A23;&#x5C0D;&#x6A39;&#x505A; fold&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">F</span>.foldl (+) <span class="hljs-number">0</span> testTree  
<span class="hljs-number">42</span>  
<span class="hljs-title">ghci</span>&gt; <span class="hljs-type">F</span>.foldl (*) <span class="hljs-number">1</span> testTree  
<span class="hljs-number">64800</span>
</code></pre>
<p><code>foldMap</code> &#x4E0D;&#x53EA;&#x662F;&#x5B9A;&#x7FA9; <code>Foldable</code> &#x65B0;&#x7684; instance &#x6709;&#x7528;&#x3002;&#x4ED6;&#x4E5F;&#x5C0D;&#x7C21;&#x5316;&#x6211;&#x5011;&#x7684;&#x7D50;&#x69CB;&#x81F3;&#x55AE;&#x4E00; monoid &#x503C;&#x6709;&#x7528;&#x3002;&#x8209;&#x4F8B;&#x4F86;&#x8AAA;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x77E5;&#x9053;&#x6211;&#x5011;&#x7684;&#x6A39;&#x4E2D;&#x6709;&#x6C92;&#x6709; <code>3</code>&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x9019;&#x6A23;&#x505A;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getAny $ <span class="hljs-type">F</span>.foldMap (\x -&gt; <span class="hljs-type">Any</span> $ x == <span class="hljs-number">3</span>) testTree  
<span class="hljs-type">True</span>
</code></pre>
<p>&#x9019;&#x908A; <code>\x -&gt; Any $ x == 3</code> &#x662F;&#x4E00;&#x500B;&#x63A5;&#x53D7;&#x4E00;&#x500B;&#x6578;&#x503C;&#x4E26;&#x56DE;&#x50B3;&#x4E00;&#x500B; monoid &#x7684;&#x51FD;&#x6578;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4E00;&#x500B;&#x5305;&#x5728; <code>Any</code> &#x4E2D;&#x7684; <code>Bool</code>&#x3002;<code>foldMap</code> &#x5C07;&#x9019;&#x500B;&#x51FD;&#x6578;&#x5957;&#x7528;&#x81F3;&#x6A39;&#x7684;&#x6BCF;&#x4E00;&#x500B;&#x7BC0;&#x9EDE;&#xFF0C;&#x4E26;&#x628A;&#x7D50;&#x679C;&#x7528; <code>mappend</code> &#x7C21;&#x5316;&#x6210;&#x55AE;&#x4E00; monoid&#x3002;&#x5982;&#x679C;&#x6211;&#x5011;&#x9019;&#x6A23;&#x505A;&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; getAny $ <span class="hljs-type">F</span>.foldMap (\x -&gt; <span class="hljs-type">Any</span> $ x &gt; <span class="hljs-number">15</span>) testTree  
<span class="hljs-type">False</span>
</code></pre>
<p>&#x7D93;&#x904E;&#x5957;&#x7528; lambda &#x4E4B;&#x5F8C;&#x6211;&#x5011;&#x6240;&#x6709;&#x7684;&#x7BC0;&#x9EDE;&#x90FD;&#x6703;&#x662F; <code>Any False</code>&#x3002;&#x4F46; <code>mappend</code> &#x5FC5;&#x9808;&#x8981;&#x81F3;&#x5C11;&#x5403;&#x5230;&#x4E00;&#x500B; <code>True</code> &#x624D;&#x80FD;&#x8B93;&#x6700;&#x5F8C;&#x7684;&#x7D50;&#x679C;&#x8B8A;&#x6210; <code>True</code>&#x3002;&#x9019;&#x4E5F;&#x662F;&#x70BA;&#x4EC0;&#x9EBD;&#x7D50;&#x679C;&#x6703;&#x662F; <code>False</code>&#xFF0C;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x6A39;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x503C;&#x90FD;&#x5C0F;&#x65BC;&#x7B49;&#x65BC; <code>15</code>&#x3002;</p>
<p>&#x6211;&#x5011;&#x4E5F;&#x80FD;&#x5C07; <code>foldMap</code> &#x914D;&#x5408; <code>\x -&gt; [x]</code> &#x4F7F;&#x7528;&#x4F86;&#x5C07;&#x6211;&#x5011;&#x7684;&#x6A39;&#x8F49;&#x6210; list&#x3002;&#x7D93;&#x904E;&#x5957;&#x7528;&#x90A3;&#x500B;&#x51FD;&#x6578;&#x5F8C;&#xFF0C;&#x6240;&#x6709;&#x7BC0;&#x9EDE;&#x90FD;&#x8B8A;&#x6210;&#x5305;&#x542B;&#x55AE;&#x4E00;&#x5143;&#x7D20;&#x7684; list&#x3002;&#x6700;&#x5F8C;&#x7528; <code>mappend</code> &#x5C07;&#x9019;&#x4E9B;&#x55AE;&#x4E00;&#x5143;&#x7D20;&#x7684; list &#x8F49;&#x6210;&#x4E00;&#x500B;&#x88DD;&#x6709;&#x5168;&#x90E8;&#x5143;&#x7D20;&#x7684; list&#xFF1A;</p>
<pre><code class="lang-haskell"><span class="hljs-title">ghci</span>&gt; <span class="hljs-type">F</span>.foldMap (\x -&gt; [x]) testTree  
[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>]
</code></pre>
<p>&#x9019;&#x500B;&#x5C0F;&#x6280;&#x5DE7;&#x4E26;&#x4E0D;&#x9650;&#x65BC;&#x6A39;&#x800C;&#x5DF2;&#xFF0C;&#x4ED6;&#x53EF;&#x4EE5;&#x88AB;&#x5957;&#x7528;&#x5728;&#x4EFB;&#x4F55; <code>Foldable</code> &#x4E0A;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="10-functionally-solving-problems.html" class="navigation navigation-prev " aria-label="Previous page: Functionally Solving Problems">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="12-a-fistful-of-monads.html" class="navigation navigation-next " aria-label="Next page: A Fistful of Monad">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Functors, Applicative Functors 與 Monoids","level":"1.12","depth":1,"next":{"title":"A Fistful of Monad","level":"1.13","depth":1,"path":"12-a-fistful-of-monads.md","ref":"12-a-fistful-of-monads.md","articles":[]},"previous":{"title":"Functionally Solving Problems","level":"1.11","depth":1,"path":"10-functionally-solving-problems.md","ref":"10-functionally-solving-problems.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"zh-tw","gitbook":"*"},"file":{"path":"11-functors-applicative-functors-and-monoids.md","mtime":"2019-11-07T09:17:12.692Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-11-07T09:30:46.419Z"},"basePath":".","book":{"language":"zh-tw"}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

